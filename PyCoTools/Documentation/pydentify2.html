<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>pydentify2 API documentation</title>
    <meta name="description" content="This file is part of PyCoTools.

PyCoTools is free software: you can redistribute it and/or modify
i..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#pydentify2.Plot">Plot</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pydentify2.Plot.__init__">__init__</a></li>
    <li class="mono"><a href="#pydentify2.Plot.calc_chi2_CI">calc_chi2_CI</a></li>
    <li class="mono"><a href="#pydentify2.Plot.chi2_lookup_table">chi2_lookup_table</a></li>
    <li class="mono"><a href="#pydentify2.Plot.degrees_of_freedom">degrees_of_freedom</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_PL_dir">get_PL_dir</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_RSS">get_RSS</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_chi2_alpha">get_chi2_alpha</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_experiment_files_in_use">get_experiment_files_in_use</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_index_dirs">get_index_dirs</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_index_dirs_as_dict">get_index_dirs_as_dict</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_original_value">get_original_value</a></li>
    <li class="mono"><a href="#pydentify2.Plot.get_results">get_results</a></li>
    <li class="mono"><a href="#pydentify2.Plot.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#pydentify2.Plot.num_data_points">num_data_points</a></li>
    <li class="mono"><a href="#pydentify2.Plot.num_estimated_params">num_estimated_params</a></li>
    <li class="mono"><a href="#pydentify2.Plot.parse_results">parse_results</a></li>
    <li class="mono"><a href="#pydentify2.Plot.plot1">plot1</a></li>
    <li class="mono"><a href="#pydentify2.Plot.plot_all">plot_all</a></li>
    <li class="mono"><a href="#pydentify2.Plot.plot_chi2_CI">plot_chi2_CI</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#pydentify2.ProfileLikelihood">ProfileLikelihood</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.__init__">__init__</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.copy_copasi_files_and_insert_parameters">copy_copasi_files_and_insert_parameters</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.copy_data_files">copy_data_files</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.multi_run">multi_run</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.read_PE_data">read_PE_data</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.run">run</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.run_SGE">run_SGE</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.run_slow">run_slow</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.save">save</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.setup_PE_task">setup_PE_task</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.setup_report">setup_report</a></li>
    <li class="mono"><a href="#pydentify2.ProfileLikelihood.setup_scan">setup_scan</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">pydentify2</span> module</h1>
  <p>This file is part of PyCoTools.</p>
<p>PyCoTools is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>PyCoTools is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License
along with PyCoTools.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<p>$Author: Ciaran Welsh
$Date: 12-09-2016 
Time:  14:50</p>
<p>This file uses the pycopi module to set up and run a profile likleihool
method of identifiability analysis (Raue2009) by automating the COAPSI method
(shaber2012). Use the ProfileLikelihood class to setup and run an identifiability
analysis and the Plot class to calculate confidence intervals and visualize the 
results.</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd"> This file is part of PyCoTools.</span>

<span class="sd"> PyCoTools is free software: you can redistribute it and/or modify</span>
<span class="sd"> it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd"> the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd"> (at your option) any later version.</span>

<span class="sd"> PyCoTools is distributed in the hope that it will be useful,</span>
<span class="sd"> but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd"> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd"> GNU Lesser General Public License for more details.</span>

<span class="sd"> You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd"> along with PyCoTools.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>


<span class="sd"> $Author: Ciaran Welsh</span>
<span class="sd"> $Date: 12-09-2016 </span>
<span class="sd"> Time:  14:50</span>
<span class="sd"> </span>
<span class="sd"> </span>
<span class="sd">  This file uses the pycopi module to set up and run a profile likleihool</span>
<span class="sd"> method of identifiability analysis (Raue2009) by automating the COAPSI method</span>
<span class="sd"> (shaber2012). Use the ProfileLikelihood class to setup and run an identifiability</span>
<span class="sd"> analysis and the Plot class to calculate confidence intervals and visualize the </span>
<span class="sd"> results. </span>
<span class="sd">     </span>

<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">pycopi</span><span class="o">,</span><span class="nn">Errors</span><span class="o">,</span> <span class="nn">PEAnalysis</span><span class="o">,</span><span class="nn">Misc</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">copyfile</span>
<span class="kn">import</span> <span class="nn">psutil</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>




<span class="k">class</span> <span class="nc">ProfileLikelihood</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class uses the profile likelihood method of identifiability analysis</span>
<span class="sd">    to assess whether parameters can be uniquely determined with the defined </span>
<span class="sd">    optimization problem. </span>
<span class="sd">    </span>
<span class="sd">    copasi_file:</span>
<span class="sd">        The copasi file you wish to conduct a profile likelihood on</span>
<span class="sd">        </span>
<span class="sd">    **kwargs:</span>
<span class="sd">        ParameterPath:</span>
<span class="sd">            The absolute path to either a parameter estimation results file </span>
<span class="sd">            (&#39;.txt&#39;,&#39;.xlsx&#39;,&#39;.xls&#39; or &#39;.csv&#39;) or a folder of parameter </span>
<span class="sd">            estimation results files. Default=None</span>
<span class="sd">            </span>
<span class="sd">        Index:</span>
<span class="sd">            The index of the parameter estimation run you want to calculate </span>
<span class="sd">            a profile likelihood around. Parameter estimations are ranked in</span>
<span class="sd">            order of best fit, with 0 being the best fit value from your set of</span>
<span class="sd">            estimations. Can be either an integer or list of integers to give </span>
<span class="sd">            the option of conducting multiple profile likelihoods using the same </span>
<span class="sd">            line of code. Use Index=-1 if you want to calculate profile likelihood </span>
<span class="sd">            around parameters already in copasi. If Index is not equal</span>
<span class="sd">            to -1 you must specificy a valid argument to the ParameterPath </span>
<span class="sd">            keyword argument. Default is -1. </span>
<span class="sd">    </span>
<span class="sd">        OutputML:</span>
<span class="sd">            When Save set to &#39;duplicate&#39; this is the file name</span>
<span class="sd">            of the output cps file. Default=&#39;overwrite&#39;</span>

<span class="sd">        Save:</span>
<span class="sd">            One of, &#39;false&#39;,&#39;overwrite&#39; or &#39;duplicate&#39;</span>
<span class="sd">            </span>
<span class="sd">        UpperBoundMultiplier:</span>
<span class="sd">            Number of times above the current value of the parameter of interest</span>
<span class="sd">            to extend profile likleihood to. Default=1000</span>
<span class="sd">        </span>
<span class="sd">        LowerBoundMultiplier:</span>
<span class="sd">            Number of times below the current value of the parameter of interest</span>
<span class="sd">            to extend profile likleihood to. Default=1000  </span>
<span class="sd">            </span>
<span class="sd">        NumberOfSteps:</span>
<span class="sd">            How many times to sample between lower and upper boundaries. Default=10</span>
<span class="sd">            </span>
<span class="sd">        Log:</span>
<span class="sd">            Sample in Log space. Default=&#39;false&#39;</span>
<span class="sd">            </span>
<span class="sd">        IterationLimit:</span>
<span class="sd">            Hook and Jeeves algorithm iteration limit parameter. Default=50</span>
<span class="sd">            </span>
<span class="sd">        Tolerance:</span>
<span class="sd">            Hook and Jeeves algorithm tolerance parameter. Default=1e-5</span>
<span class="sd">            </span>
<span class="sd">        Rho:</span>
<span class="sd">            Hook and Jeeves algorithm Rho parameter. Default=0.2</span>
<span class="sd">            </span>
<span class="sd">        Run:</span>
<span class="sd">            Either [&#39;false&#39;,&#39;slow&#39;,&#39;multiprocess&#39;,&#39;SGE&#39;]. &#39;multiprocess&#39; </span>
<span class="sd">            will use the number of processes specified in the NumProcesses </span>
<span class="sd">            keyword argument to work. This features doesn&#39;t work well yet and</span>
<span class="sd">            user is reccommended to use slow mode which runs each </span>
<span class="sd">            copasi file in serial. &#39;SGE&#39; mode can be used specifically</span>
<span class="sd">            on a SunGridEngine managed cluster. Deault=&#39;false&#39;</span>
<span class="sd">            </span>
<span class="sd">        NumProcesses:</span>
<span class="sd">            Deprecated: do not use</span>
<span class="sd">            How many processors to use at the same time. NumProcesses=0 will</span>
<span class="sd">            prevent running the estimations. Default 1</span>

<span class="sd">        SleepTime: </span>
<span class="sd">            Deprecated: Do not use. </span>
<span class="sd">            How many seconds to wait before running each copasi file. If running</span>
<span class="sd">            too many parameter estimations at the same time will slow your computer</span>
<span class="sd">            considerably. In this situation use a longer SleepTime.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>

        <span class="n">default_outputML</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Duplicate.cps&#39;</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
                 <span class="s1">&#39;OutputML&#39;</span><span class="p">:</span><span class="n">default_outputML</span><span class="p">,</span>
                 <span class="s1">&#39;Save&#39;</span><span class="p">:</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;ParameterPath&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;QuantityType&#39;</span><span class="p">:</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                 <span class="s1">&#39;Log&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;IterationLimit&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                 <span class="s1">&#39;Tolerance&#39;</span><span class="p">:</span><span class="mf">1e-5</span><span class="p">,</span>
                 <span class="s1">&#39;Rho&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="s1">&#39;Run&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#when runset to &#39;true&#39; determines, how many NumProcesses to use at the same time</span>
                 <span class="s1">&#39;SleepTime&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="c1">#How long to wait between running each copasi file</span>
                 <span class="s1">&#39;Verbose&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;MaxTime&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
                 

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for ProfileLikelihood&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>    
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">,</span><span class="s1">&#39;If you specify an index, you need to specify an argument to ParameterPath&#39;</span>
        
        <span class="c1">#if no index or ParameterPath specified, use current parameteres in cps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;current&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="c1">#if parameter path is file or folder set the self.mode variablee accordingly</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span>
        
        <span class="c1">#if ParameterPath specified without an index, set index to 0 (i.e. best parameter set)</span>
<span class="c1">#        if self.kwargs.get(&#39;ParameterPath&#39;)!=None and self.kwargs.get(&#39;Index&#39;) !=-1 and self.kwargs.get(&#39;Index&#39;)!=None:</span>
<span class="c1">#            self.kwargs[&#39;Index&#39;]=98</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_PE_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">),(</span><span class="nb">float</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;MaxTime argument should be float or int&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span> <span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),(</span><span class="nb">list</span><span class="p">,</span><span class="nb">int</span><span class="p">)),</span><span class="s1">&#39;index must be an integer or a list of integers&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">int</span><span class="p">),</span><span class="s1">&#39;Index is int type&#39;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">i</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;PE data contains {} parameter estimations. You have indicated that you want to use run {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;No data&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;PE data contains {} parameter estimations. You have indicated that you want to use run {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">==</span><span class="p">{}:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your copasi file doesnt have a parameter estimation defined&#39;</span><span class="p">)</span>
        <span class="c1">#convert some numeric input variables to string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Rho&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Rho&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span><span class="s1">&#39;multiprocess&#39;</span><span class="p">,</span><span class="s1">&#39;SGE&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">Run</span><span class="se">\&#39;</span><span class="s1"> keyword must be one of </span><span class="se">\&#39;</span><span class="s1">slow</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1">multiprocess</span><span class="se">\&#39;</span><span class="s1">, or </span><span class="se">\&#39;</span><span class="s1">SGE</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SleepTime&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        
        
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;particle_number&#39;</span><span class="p">]</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;You have selected {} processes but your computer only has {} available&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
        
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
<span class="c1">#        if self.kwargs.get(&#39;Log&#39;)==&#39;false&#39;:</span>
<span class="c1">#            self.kwargs[&#39;Log&#39;]=str(0)</span>
<span class="c1">#        else:</span>
<span class="c1">#            self.kwargs[&#39;Log&#39;]=str(1)</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy_copasi_files_and_insert_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy_data_files</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_report</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_scan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_PE_task</span><span class="p">()</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;duplicate&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputML&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;overwrite&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span>

                
    <span class="k">def</span> <span class="nf">read_PE_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if self.mode=&#39;current&#39; do nothing</span>
<span class="sd">        if self.mode = file read from file</span>
<span class="sd">        if self.mode = folder read from folder</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;current&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="nf">copy_copasi_files_and_insert_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Its easier to do these two functions together</span>
<span class="sd">        1) create relevant folders and copy copasi file into these based on the Index parameter</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">cps_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">estimated_parameters</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
<span class="c1">#            os.chdir(&#39;..&#39;)</span>
<span class="c1">#            os.chdir(&#39;..&#39;)</span>
            <span class="k">return</span> <span class="n">cps_dct</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span>
            <span class="n">IP</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span>
                                          <span class="n">Index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span>
                                          <span class="n">QuantityType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">),</span>
                                          <span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
            <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cps_dct</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="n">IP</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span>
                                          <span class="n">Index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                          <span class="n">QuantityType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">),</span><span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>

                <span class="n">IA_dir2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>

                    <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                    <span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cps_dct</span>

    <span class="k">def</span> <span class="nf">copy_data_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Move parameter estimation data from the directory with the parent cps</span>
<span class="sd">        file in to each relevant ProfileLikelihood sub folder. </span>
<span class="sd">        </span>
<span class="sd">        Note that you must have your data files int the same directory as the </span>
<span class="sd">        cps file you want to perform profile likeliood on. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
        <span class="n">q</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;File Name&quot;]&#39;</span>
        <span class="n">data_file_dct</span><span class="o">=</span><span class="p">{}</span>
<span class="c1">#        print self.copasi_file</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
            <span class="n">data_path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
            <span class="n">data_file_dct</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">data_path</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">IA_dir1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                <span class="n">new_data_file1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir1</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file1</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">IA_dir2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
                <span class="n">new_data_file2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file2</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="n">IA_dir3</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
                    <span class="n">new_data_file3</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir3</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                    <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_file_dct</span>

    <span class="k">def</span> <span class="nf">setup_PE_task</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        remove parameter of interest from parameter estimation task</span>
<span class="sd">        and change method parameters </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">method_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Hooke &amp;amp; Jeeves&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;HookeJeeves&#39;</span><span class="p">}</span>
        <span class="n">IterationLimit</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;unsignedInteger&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Iteration Limit&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">)}</span>
        <span class="n">Tolerance</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tolerance&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">)}</span>
        <span class="n">Rho</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Rho&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Rho&#39;</span><span class="p">)}</span>

        <span class="n">method_element</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;Method&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">method_params</span><span class="p">)</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">IterationLimit</span><span class="p">)</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">Tolerance</span><span class="p">)</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">Rho</span><span class="p">)</span>
            
            
        <span class="n">query</span><span class="o">=</span><span class="s2">&quot;//*[@name=&#39;FitItem&#39;]&quot;</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">C</span><span class="o">=</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="n">childML</span><span class="o">=</span><span class="n">C</span><span class="o">.</span><span class="n">copasiML</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">childML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ObjectCN&#39;</span><span class="p">:</span>
                            <span class="c1">#metabolites first</span>
                            <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Metabolites\[{}\]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span><span class="p">[]:</span>
                                <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> 
                            
                            <span class="c1">#globals</span>
                            <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Values\[{}\]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span><span class="p">[]:</span>
                                <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> 
                                
                            <span class="c1">#locals</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                                <span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                                <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Reactions\[{}\].*Parameter={},&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">match</span><span class="o">!=</span><span class="p">[]:</span>
                                    <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                    <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">tasks</span><span class="o">=</span><span class="n">childML</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;{http://www.copasi.org/static/schema}ListOfTasks&#39;</span><span class="p">)</span>
                <span class="n">method</span><span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">method</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">method_element</span><span class="p">)</span>
                
                <span class="c1">#turn off the randomize start values button (also turns off the corresponding for optimization task!)</span>
                <span class="n">q</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;Randomize Start Values&quot;]&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">childML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
                    <span class="n">k</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
                <span class="n">C</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">childML</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
        
    <span class="k">def</span> <span class="nf">setup_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">pycopi</span><span class="o">.</span><span class="n">Reports</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">ReportType</span><span class="o">=</span><span class="s1">&#39;profilelikelihood&#39;</span><span class="p">,</span>
                               <span class="n">ReportName</span><span class="o">=</span><span class="n">st</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span><span class="n">Variable</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
        
    <span class="k">def</span> <span class="nf">setup_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">GMQ_child</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span> 
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> 
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;particle_number&#39;</span><span class="p">:</span>
                    <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>  
                <span class="n">lb</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">variable_value</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">))</span>
                <span class="n">ub</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">variable_value</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">))</span>
                
                <span class="n">pycopi</span><span class="o">.</span><span class="n">Scan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span>
                                     <span class="n">Variable</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
                                     <span class="n">ReportName</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span>
                                     <span class="n">ReportType</span><span class="o">=</span><span class="s1">&#39;profilelikelihood&#39;</span><span class="p">,</span>
                                     <span class="n">SubTask</span><span class="o">=</span><span class="s1">&#39;parameter_estimation&#39;</span><span class="p">,</span>
                                     <span class="n">ScanType</span><span class="o">=</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span>
                                     <span class="n">OutputInSubtask</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                                     <span class="n">AdjustInitialConditions</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                                     <span class="n">NumberOfSteps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">),</span>
                                     <span class="n">Maximum</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span>
                                     <span class="n">Minimum</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span>
                                     <span class="n">Log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">),</span>
                                     <span class="n">Scheduled</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                                     <span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                                     <span class="n">ClearScans</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
        
    <span class="k">def</span> <span class="nf">run_slow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Run using one process, separately, one after another</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<span class="c1">#                args=[&#39;CopasiSE&#39;,self.cps_dct[i][j]]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Verbose&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s1">&#39;running {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">Task</span><span class="o">=</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span><span class="n">MaxTime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">output</span>
        <span class="k">return</span> <span class="n">res</span>

<span class="c1">#    def run_fast(self):</span>
<span class="c1">#        &#39;&#39;&#39;</span>
<span class="c1">#        self.cps_dct is a nested dictionary dct[index1][index2]=filename</span>
<span class="c1">#        CopasiSE is a program for simulating mathematical models using the terminal/cmd</span>
<span class="c1">#        </span>
<span class="c1">#        &#39;&#39;&#39;</span>
<span class="c1">#        for i in self.cps_dct.keys():</span>
<span class="c1">#            for j in self.cps_dct[i]:</span>
<span class="c1">#                subprocess.Popen(&#39;CopasiSE {}&#39;.format(self.cps_dct[i][j]))</span>
<span class="c1">#        return self.cps_dct</span>
        
    <span class="k">def</span> <span class="nf">multi_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s1">&#39;CopasiSE &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pool</span><span class="o">=</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">process_iter</span><span class="p">()]</span>
                    <span class="n">count</span><span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="s1">&#39;CopasiSE.exe&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">count</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">):</span>
                        <span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SleepTime&#39;</span><span class="p">))</span>
                    <span class="n">pool</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
            <span class="k">return</span> <span class="bp">True</span>
                
    <span class="k">def</span> <span class="nf">run_SGE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">#$ -V -cwd</span><span class="se">\n</span><span class="s1">module addapps/COPASI/4.16.104-Linux-64bit</span><span class="se">\n</span><span class="s1">CopasiSE &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;qsub {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">)</span>         
        <span class="k">return</span> <span class="bp">True</span>
                
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;multiprocess&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multi_run</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;slow&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_slow</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;SGE&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_SGE</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>


<span class="c1">#==============================================================================</span>
            
<span class="k">class</span> <span class="nc">Plot</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;    </span>
<span class="sd">    After ProfileLikelihood class has been run, the Plot class will plot the</span>
<span class="sd">    profile likelihoods for you. </span>
<span class="sd">    </span>
<span class="sd">    copasi_file:</span>
<span class="sd">        The copasi file you ran a profile likelihood on</span>
<span class="sd">        </span>
<span class="sd">    **kwargs:</span>
<span class="sd">    </span>
<span class="sd">        ParameterPath:</span>
<span class="sd">            When Index is anything other than -1 you need to specify the absolute</span>
<span class="sd">            path to your parameters. </span>
<span class="sd">            </span>
<span class="sd">        Index:</span>
<span class="sd">            Which Index to plot. Either an integer or list of integers. Default=-1, </span>
<span class="sd">            means profile likelihoods were calculated around the parameters present </span>
<span class="sd">            in the model. When Index=-1 you must speficy an argument to the </span>
<span class="sd">            RSS argument. An integer Index other than -1 specifies that a profile</span>
<span class="sd">            likleihood was calculated around the integer best set of parameters and </span>
<span class="sd">            to plot them. A list of integers specifies the plotting of an </span>
<span class="sd">            arbtrary number of profile likelihoods. When Index is an Int or list of Int</span>
<span class="sd">            the RSS argument is taken directly from the PE data specified by ParameterPath</span>
<span class="sd">            </span>
<span class="sd">        NumProcesses:</span>
<span class="sd">            How many processes to use for plotting, which can be fairly intensive </span>
<span class="sd">            computationally. Default=1</span>
<span class="sd">            </span>
<span class="sd">        Alpha:</span>
<span class="sd">            The alpha cut off for the chi squared based confidence interval. </span>
<span class="sd">            Default=0.95</span>
<span class="sd">            </span>
<span class="sd">        N:</span>
<span class="sd">            Number of data points in use. The data files that were used for </span>
<span class="sd">            parameter estimation in the original copasi file (the argument to copasi_file)</span>
<span class="sd">            were extracted, parsed and data points were counted. This value is the default</span>
<span class="sd">            but can be over-ridden if value given to this argument.</span>
<span class="sd">            </span>
<span class="sd">        DOF:</span>
<span class="sd">            Degrees of freedom. The number of parameters that you want to calculate</span>
<span class="sd">            profile likelihoods for minus 1 is calcualted automatically. This is </span>
<span class="sd">            default but can be overridden by specifying an argument to this keyword</span>
<span class="sd">            </span>
<span class="sd">        RSS:</span>
<span class="sd">            Residual Sum of Squared. The objective function used as a measure of distance</span>
<span class="sd">            of the experimental to simulated data. The RSS is minimized by copasi&#39;s </span>
<span class="sd">            parameter estimation algorithms. The smaller the better. This value is </span>
<span class="sd">            automatically taken from parameter estimation data if the Index kwarg </span>
<span class="sd">            is anything other than minus 1. when Index=-1, the RSS value must be </span>
<span class="sd">            given to this argument for the calculation of the chi squared based </span>
<span class="sd">            confidence interval</span>

<span class="sd">        FontSize:</span>
<span class="sd">            Control graph label font size</span>

<span class="sd">        AxisSize:</span>
<span class="sd">            Control graph axis font size</span>

<span class="sd">        ExtraTitle:</span>
<span class="sd">            When savefig=&#39;true&#39;, given the saved</span>
<span class="sd">            file an extra label in the file path</span>

<span class="sd">        LineWidth:</span>
<span class="sd">            Control graph LineWidth</span>
<span class="sd">            </span>
<span class="sd">        DotSize:</span>
<span class="sd">            How big to plot the dots on the graph</span>

<span class="sd">        Bins:</span>
<span class="sd">            Control number of bins in any histograms. Used???</span>

<span class="sd">        MultiPlot:</span>
<span class="sd">            Plot results of sequential profile likelihoods for the same </span>
<span class="sd">            parameter but with different Index on the same graph. Results</span>
<span class="sd">            accumulate with Index value, so desired graphs are in the</span>
<span class="sd">            folder with the largest index. </span>
<span class="sd">            </span>
<span class="sd">        SaveFig:</span>
<span class="sd">            Save graphs to file labelled after the index</span>

<span class="sd">        InterpolationKind:</span>
<span class="sd">            Which method to use for interpolation. Can be any of [&#39;linear&#39;, </span>
<span class="sd">            &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;] but be careful</span>
<span class="sd">            with these. Default=slinear</span>

<span class="sd">        TitleWrapSize:</span>
<span class="sd">            When graph titles are long, how many characters to have per </span>
<span class="sd">            line before word wrap. Default=30. </span>
<span class="sd">            </span>
<span class="sd">        Show:</span>
<span class="sd">            When not using iPython, use Show=&#39;true&#39; to display graphs</span>
<span class="sd">            </span>
<span class="sd">        InterpolationResolution;</span>
<span class="sd">            Number of points to split line into for interpolation. Defualt=1000</span>
<span class="sd">            </span>
<span class="sd">        Ylimit: </span>
<span class="sd">            default==None, restrict amount of data shown on y axis. </span>
<span class="sd">            Useful for honing in on small confidence intervals</span>

<span class="sd">        Xlimit: </span>
<span class="sd">            default==None, restrict amount of data shown on x axis. </span>
<span class="sd">            Useful for honing in on small confidence intervals</span>
<span class="sd">        </span>
<span class="sd">        DPI:</span>
<span class="sd">            How big saved figure should be. Default=125</span>
<span class="sd">        </span>
<span class="sd">        XTickRotation:</span>
<span class="sd">            How many degrees to rotate the X tick labels</span>
<span class="sd">            of the output. Useful if you have very small or large</span>
<span class="sd">            numbers that overlay when plotting. </span>
<span class="sd">            </span>
<span class="sd">        Mode: </span>
<span class="sd">            either &#39;all&#39;, &#39;one&#39; or &#39;none to either plot all results </span>
<span class="sd">            or just a certain parameter. Defulat=&#39;all&#39;</span>
<span class="sd">            </span>
<span class="sd">        PlotIndex:</span>
<span class="sd">            if Mode set to &#39;one&#39;, this specifies the index of the </span>
<span class="sd">            profile likelihood run you want to plot (i.e -1,0,[0,3,5])</span>
<span class="sd">            </span>
<span class="sd">        PlotParameter:</span>
<span class="sd">            If Mode set to &#39;one&#39; which parameter to plot. Must</span>
<span class="sd">            be an item in your results. </span>
<span class="sd">            </span>
<span class="sd">        Separator:</span>
<span class="sd">            Separator used in csv file for experimental data. </span>
<span class="sd">            Default=&#39;\t&#39;</span>
<span class="sd">            </span>
<span class="sd">        Log10:</span>
<span class="sd">            &#39;true&#39; or &#39;false&#39;. Default=&#39;true&#39;. Plot on log10-log10 scale</span>
<span class="sd">            </span>
<span class="sd">        UsePickle:</span>
<span class="sd">            Data read by PEAnalysis.ParsePEData are automatically pickled</span>
<span class="sd">            for speed. &#39;true&#39; or &#39;false&#39; to use pickle. Default=&#39;false&#39;</span>
<span class="sd">        </span>
<span class="sd">        OverwritePickle:</span>
<span class="sd">            If data has changed set &#39;OverwritePickle&#39; to &#39;true&#39; to rewrite </span>
<span class="sd">            pickle before &#39;UsePickle&#39; can be useful again. Default=&#39;false&#39;</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>

        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
                 <span class="s1">&#39;ParameterPath&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>                 
                 <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> 
                 <span class="s1">&#39;Alpha&#39;</span><span class="p">:</span><span class="mf">0.95</span><span class="p">,</span>
                 <span class="s1">&#39;DOF&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;RSS&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;QuantityType&#39;</span><span class="p">:</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
                 
                 <span class="c1">#graph features</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;LineWidth&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;MultiPlot&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;InterpolationKind&#39;</span><span class="p">:</span><span class="s1">&#39;slinear&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
                 <span class="s1">&#39;Ylimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Xlimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;XTickRotation&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;Mode&#39;</span><span class="p">:</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;PlotIndex&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;PlotParameter&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;DotSize&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;Separator&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 
                 <span class="s1">&#39;UsePickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;OverwritePickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="p">}</span>
                 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for Plot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>       
    
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Log10 argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UsePickle&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;UsePickle argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OverwritePickle&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;OverwritePickle argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>

            
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;You have selected {} processes but your computer only has {} available&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
        
        <span class="c1">#if Index is -1 i.e. current parameters, user needs to give RSS</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;when calculating PL around current parameter sets must specify the current RSS as keyword argument to Plot&#39;</span><span class="p">)</span>
        
        <span class="c1">#otherwise the RSS is ascertained automatically from the ParameterPath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">,</span><span class="s1">&#39;If Index!=-1 then you need to suply argument to ParameterPath&#39;</span>
        

        <span class="c1">#line interpolation options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;zero&#39;</span><span class="p">,</span> <span class="s1">&#39;slinear&#39;</span><span class="p">,</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic&#39;</span><span class="p">],</span><span class="s2">&quot;interpolation kind must be one of [&#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;]&quot;</span>

        <span class="c1">#limit parameters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Ylimit is a list of coordinates for y axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Ylimit list must be 2&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Xlimit is a list of coordinates for X axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Xlimit list must be 2&#39;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;XTickRotation parameter should be a Python integer&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;ExtraTitle should be of type str&#39;</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;FontSize argument should be of type int&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;AxisSize argument should be of type int&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;LineWidth argument should be of type int&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationKind argument should be of type str&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution argument should be of type int&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize argument should be of type int&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution argument should be of type int&#39;</span><span class="p">)</span>

            
            


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
            
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;partical_numbers&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_PL_dir</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_dirs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_results</span><span class="p">()</span> 
        
        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The below arguments rely on the above code. Do not change</span>
<span class="sd">        the ordering!</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#default DOF is num estimated parameters minus 1 but can be manually overrider by specifying DOF keyword</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;DOF&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">degrees_of_freedom</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Please specify argument to DOF keyword&#39;</span><span class="p">)</span>
        
        <span class="c1">#defult N is number of data points in your data set. </span>
        <span class="c1">#This can be overridden by manually specifying N</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_data_points</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span>        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;none&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not a valid mode. Mode should be either all or one&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)))</span>
<span class="c1">#</span>

  

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">!=</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not a valid Parameter. Your parameters are: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">()))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not an index in your Indices: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
            
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not an index in your Indices: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;one&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">))</span>
            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_chi2_CI</span><span class="p">()</span>
        <span class="n">CI</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">CI</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;Confidence level for Index {} is {} or {} on a Log10 scale&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            
    <span class="k">def</span> <span class="nf">get_PL_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Find the ProfleLikelihood directory within the same directory as copasi_file</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="n">path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="s1">&#39;The current directory: {} </span><span class="se">\t</span><span class="s1"> does not contain a directory called ProfileLikelihood, have you used the ProfileLikelihood class with the Run option enabled?&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>
        
    <span class="k">def</span> <span class="nf">get_index_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Under the ProfileLikelihood folder are a list of folders named after</span>
<span class="sd">        the integer rank of best fit (.e. -1,0,1,2 ...)</span>
<span class="sd">        returns list of these directories</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dirs</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">)</span>
        <span class="n">dirs2</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs2</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dirs2</span>
        
    <span class="k">def</span> <span class="nf">get_index_dirs_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        returns dict[index]=directory to index</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">dirs</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">)</span>
        <span class="n">dirs2</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs2</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">split</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">)]</span><span class="o">=</span><span class="n">i</span>
        <span class="k">return</span> <span class="n">d</span>
        
    <span class="k">def</span> <span class="nf">get_experiment_files_in_use</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Need to exclude data files fromlist of parameters to plot</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">query</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;File Name&quot;]&#39;</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">l</span>
        
        
    <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.txt&#39;</span><span class="p">):</span>
<span class="c1">#                if os.path.splitext(j)[0]  in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_fit_items().keys()]:</span>
                    <span class="n">f</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])][</span><span class="n">f</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>
        
    <span class="k">def</span> <span class="nf">parse_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">df_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">experiment_keys</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_files_in_use</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">:</span>
            <span class="n">df_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiment_keys</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Separator&#39;</span><span class="p">])</span>
                    <span class="n">best_value_str</span><span class="o">=</span><span class="s1">&#39;TaskList[Parameter Estimation].(Problem)Parameter Estimation.Best Value&#39;</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">best_value_str</span><span class="p">:</span><span class="s1">&#39;RSS&#39;</span><span class="p">})</span>
                    <span class="n">df_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">data</span>
        <span class="k">return</span> <span class="n">df_dict</span>
<span class="c1">#        </span>
    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">num_estimated_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="c1">#        try:</span>
        <span class="n">first_key</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">count</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">first_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">count</span>
<span class="c1">#        except AttributeError:</span>
<span class="c1">#            raise Errors.InputError(&#39;Index set to -1 and therefore a ParameterPath is not present to count data points. Specify an argument to N kwarg&#39;)</span>
        
        
    <span class="k">def</span> <span class="nf">degrees_of_freedom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The number of parameters being estimated minus 1</span>
<span class="sd">        &#39;&#39;&#39;</span>
<span class="c1">#        try:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_estimated_params</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span>
<span class="c1">#        except AttributeError:</span>
<span class="c1">#            raise Errors.InputError(&#39;Index set to -1 and therefore a ParameterPath is not present to count number of parameter. Specify an argument to DOF kwarg&#39;)</span>
        
    <span class="k">def</span> <span class="nf">num_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        returns number of data points in your data files</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">experimental_data</span><span class="o">=</span> <span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Separator&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_files_in_use</span><span class="p">()]</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">experimental_data</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">s</span><span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Number of data points cannot be 0. This is wrong&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">get_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">RSS</span><span class="o">=</span><span class="p">{}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span>
            <span class="n">RSS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RSS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">PED</span><span class="o">=</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">),</span>
                                        <span class="n">UsePickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UsePickle&#39;</span><span class="p">],</span>
                                        <span class="n">OverwritePickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;OverwritePickle&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">RSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]</span><span class="o">=</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="n">RSS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">RSS</span>
        
    <span class="k">def</span> <span class="nf">chi2_lookup_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Looks at the cdf of a chi2 distribution at incriments of </span>
<span class="sd">        0.1 between 0 and 100. </span>
<span class="sd">        </span>
<span class="sd">        Returns the x axis value at which the alpha interval has been crossed, </span>
<span class="sd">        i.e. gets the cut off point for chi2 dist with DOF and alpha . </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">nums</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">table</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">))</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">alpha</span><span class="p">:</span>
                <span class="n">chi2_df_alpha</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">chi2_df_alpha</span>  
        
    <span class="k">def</span> <span class="nf">get_chi2_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        return the chi2 threshold for cut off point alpha and DOF degrees of freedom</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
            <span class="n">dct</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2_lookup_table</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Alpha&#39;</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">plot_chi2_CI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Visualize where the alpha cut off is on the chi2 distribution</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span> <span class="mi">100</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chi2 pdf&#39;</span><span class="p">)</span>
        
        <span class="n">y_alpha</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x_alpha</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chi2_alpha</span><span class="p">()]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y_alpha</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_alpha</span><span class="p">,</span><span class="n">y_alpha</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chi2 distribution with {} DOF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">calc_chi2_CI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        get chi2 CI at alpha</span>
<span class="sd">        alpha=decimal between 0 and 1 with 2 decimal places </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">CI_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_RSS</span><span class="p">():</span>
            <span class="n">r</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_RSS</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chi2_alpha</span><span class="p">()</span>
            <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_data_points</span><span class="p">()</span>
            <span class="n">CI_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">a</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">CI_dct</span>
        
        
    <span class="k">def</span> <span class="nf">get_original_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        go and find out what the value of the parameter was in the PE data </span>
<span class="sd">        at index</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">():</span>
            <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">():</span>
            <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
                <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>





        
<span class="c1">#            else:</span>
<span class="c1">#                best_parameter_value=self.GMQ.get_IC_cns()[parameter][&#39;value&#39;]</span>
            
<span class="c1">#        if st in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_IC_cns().keys()] or self.GMQ.get_IC_cns().keys():</span>
<span class="c1">#            if self.kwargs.get(&#39;QuantityType&#39;)==&#39;concentration&#39;:</span>
<span class="c1">#                best_parameter_value=self.GMQ.get_IC_cns()[parameter][&#39;concentration&#39;]</span>
<span class="c1">#            else:</span>
<span class="c1">#                best_parameter_value=self.GMQ.get_IC_cns()[parameter][&#39;value&#39;]</span>
<span class="c1">#        if st in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_local_kinetic_parameters_cns()] or self.GMQ.get_local_kinetic_parameters_cns().keys():</span>
<span class="c1">#            best_parameter_value=self.GMQ.get_local_kinetic_parameters_cns()[parameter][&#39;value&#39;]</span>
<span class="c1">#</span>
<span class="c1">#        if st in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_global_quantities()] or self.GMQ.get_global_quantities().keys():</span>
<span class="c1">#            best_parameter_value= self.GMQ.get_global_quantities()[parameter]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">best_parameter_value</span>
        <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">None</span>
            <span class="k">return</span> <span class="n">best_parameter_value</span>
            

            
            
            
<span class="c1">#</span>
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot one parameter. </span>
<span class="sd">        </span>
<span class="sd">        things to check:</span>
<span class="sd">            that we are plotting the correct data</span>
<span class="sd">            that the CI line is calculated correctly</span>
<span class="sd">            that the red dot is in the correct place</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
<span class="c1">#        if parameter not in self.GMQ.get_all_model_variables().keys():</span>
<span class="c1">#            raise Errors.InputError(&#39;{} is not in your model. These are parameters in your model: {}&#39;.format(parameter,self.GMQ.get_all_model_variables().keys()))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">parameter</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="c1">#plot parameter vs RSS once as green circles the other as lines</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="o">==</span><span class="s1">&#39;invalid literal for float(): 1.#INF&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
            
        <span class="c1">#now get your interpolation on...</span>
        <span class="n">f</span><span class="o">=</span><span class="n">interp1d</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">))</span>
        <span class="n">interp_parameter_value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span>
                                              <span class="nb">max</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span> 
                                              <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">interp_RSS_value</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">interp_parameter_value</span><span class="p">)</span>        
        <span class="n">handle</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interp_parameter_value</span><span class="p">,</span><span class="n">interp_RSS_value</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
        
        <span class="c1">#plot the confidence interval </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">CI</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">CI</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
        
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,[</span><span class="n">CI</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
<span class="c1">#        print self.GMQ.get_all_model_variables()</span>
<span class="c1">#        print parameter</span>
        <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
<span class="c1">#        print st</span>
        <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_original_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span>   
        <span class="k">if</span> <span class="n">best_parameter_value</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>         
            <span class="c1">#best parameter value contains the model value for pparameter</span>
            <span class="c1">#we now need to look this value up on the interpolation and read off the corresponding RSS value</span>
            <span class="c1">#first find the parameter value in the interolation that is closest to the best param val</span>
            <span class="n">pandas</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">interp_df</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">interp_parameter_value</span><span class="p">,</span><span class="n">interp_RSS_value</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">parameter</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">best_parameter_value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">best_parameter_value</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">abs_diff_df</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">interp_df</span><span class="o">-</span><span class="n">best_parameter_value</span><span class="p">)</span>
            <span class="n">minimum_index</span><span class="o">=</span> <span class="n">abs_diff_df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">best_parameter_value</span><span class="o">=</span> <span class="n">interp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">minimum_index</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">best_RSS_value</span><span class="o">=</span><span class="n">interp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">minimum_index</span><span class="p">][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_parameter_value</span><span class="p">,</span><span class="n">best_RSS_value</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
        
        <span class="c1">#plot labels</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>  
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>         
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
       <span class="c1">#pretty stuff</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#xtick rotation</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">))</span>
        
        <span class="c1">#options for changing the plot axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">save_plot</span><span class="p">():</span>
            <span class="n">filename</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span> <span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="n">filename</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>     
            <span class="k">return</span> <span class="n">filename</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            
        <span class="c1">#save figure options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_dirs_as_dict</span><span class="p">()[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">graph_dirs</span><span class="o">=</span><span class="n">save_plot</span><span class="p">()</span>
            <span class="c1">#change back to parent directory</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">graph_dirs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
            
    <span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
<span class="c1">#            print self.data</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="n">i</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Index out of bounds, i.e. Index&gt;number PE runs&#39;</span><span class="p">)</span>
<span class="c1">#                </span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="n">i</span><span class="p">)</span>
<span class="c1">#            except KeyError:</span>
<span class="c1">#                raise Errors.InputError(&#39;Index out of bounds, i.e. Index&gt;number PE runs&#39;)</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>




        
<span class="c1">#==============================================================================</span>

        
<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">f</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\PyCoTools\Tests\VilarModel2006pycopitestModel.cps&#39;</span>
    
    <span class="n">r</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\PyCoTools\Tests\vilarTimeCourse.txt&#39;</span>
    <span class="n">r2</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\PyCoTools\Tests\vilarTimeCourse2.txt&#39;</span>
        
    <span class="n">p</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\PyCoTools\Tests\output.txt&#39;</span>
    
    <span class="n">t</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\PyCoTools\Tests\cheese.txt&#39;</span>
    
<span class="c1">#    PE=pycopi.ParameterEstimation(f,t,Method=&#39;ParticleSwarm&#39;,ReportName=&#39;output.txt&#39;,Plot=&#39;true&#39;,Save=&#39;overwrite&#39;)</span>
<span class="c1">#    PE.write_item_template()</span>
<span class="c1">#    PE.set_up()</span>
    
<span class="c1">#    S=pycopi.Scan(f,ReportType=&#39;time_course&#39;,ScanType=&#39;scan&#39;)</span>
    
    
<span class="c1">#    PE.run()</span>
<span class="c1">#    data=pandas.read_csv(p,sep=&#39;\t&#39;)</span>
<span class="c1">#    data=pandas.DataFrame(data.iloc[-1]).transpose()</span>
<span class="c1">#    os.remove(p)</span>
<span class="c1">#    data.to_csv(p,sep=&#39;\t&#39;)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#    ProfileLikelihood(f,ParameterPath=p,Run=&#39;slow&#39;,Index=0)</span>

<span class="c1">#    print data</span>
<span class="c1">#    IP=pycopi.InsertParameters(f,DF=data)</span>



<span class="c1">#    P=Plot(f,ParameterPath=p,Index=0,savefig=&#39;true&#39;)</span>


<span class="c1">#    f=r&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\BioModelsPydentify\Models\Abell2011_CalciumSignaling_WithAdaptation\Abell2011_CalciumSignaling_WithAdaptation.cps&#39;</span>
<span class="c1">#    d=r&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\BioModelsPydentify\Models\Abell2011_CalciumSignaling_WithAdaptation\PE_results_pruned_titles.txt&#39;</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
    
<span class="c1">#    Plot(f,ParameterPath=d,Index=0)</span>








<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1">#    f=r&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\BioModelsPydentify\Models\Abell2011_CalciumSignaling_WithAdaptation\Abell2011_CalciumSignaling_WithAdaptation.cps&#39;</span>
<span class="c1">#    d=r&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\BioModelsPydentify\Models\Abell2011_CalciumSignaling_WithAdaptation\PE_results_pruned_titles.txt&#39;</span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    </span>
<span class="c1">#    p=Plot(f,ParameterPath=d,Index=0)</span>
<span class="c1">##    print p.data</span>
<span class="c1">#</span>
<span class="c1">#</span>


<span class="c1">#self.get_PL_dir()</span>
<span class="c1">##        self.indices=self.get_index_dirs()</span>
<span class="c1">##        self.result_paths=self.get_results()</span>
<span class="c1">##        self.data=self.parse_results()</span>


<span class="sd">&#39;&#39;&#39;</span>



<span class="sd">Another way to visualize the profile likleihood:</span>

<span class="sd">Each point in a profile likelihood  is either lower or higher than the chi2 confidence interval. </span>
<span class="sd">This gives me a new way to represent identifiability status. </span>



<span class="sd">Over Over Under Under Undre over over (would represent identifiable paraemter)</span>
<span class="sd">Under under under over oeer (practical)</span>
<span class="sd">ove over over under under under under (pracical) </span>

<span class="sd">All under but parameter valeus not constant (practicla)</span>

<span class="sd">All under but parameter valeus constant - structural </span>


<span class="sd">What about 3D profile likleihoods! all possible combinations of pairs of parameters </span>



<span class="sd">Another thing:</span>
<span class="sd">    when you do a profil likelihood you are reoptimizing. all paraemters. not just theta. </span>
<span class="sd">    So you could look at how the values of the other parameters change with respect to the reoptimization </span>
<span class="sd">    like they do in the new raue paper</span>


<span class="sd">&#39;&#39;&#39;</span>
 
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="pydentify2.Plot" class="name">class <span class="ident">Plot</span></p>
      
  
    <div class="desc"><p>After ProfileLikelihood class has been run, the Plot class will plot the
profile likelihoods for you. </p>
<p>copasi_file:
    The copasi file you ran a profile likelihood on</p>
<p>**kwargs:</p>
<div class="codehilite"><pre><span></span><span class="n">ParameterPath</span><span class="o">:</span>
    <span class="n">When</span> <span class="n">Index</span> <span class="k">is</span> <span class="n">anything</span> <span class="n">other</span> <span class="n">than</span> <span class="o">-</span><span class="mi">1</span> <span class="n">you</span> <span class="n">need</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">absolute</span>
    <span class="n">path</span> <span class="n">to</span> <span class="n">your</span> <span class="n">parameters</span><span class="o">.</span>

<span class="n">Index</span><span class="o">:</span>
    <span class="n">Which</span> <span class="n">Index</span> <span class="n">to</span> <span class="n">plot</span><span class="o">.</span> <span class="n">Either</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">or</span> <span class="n">list</span> <span class="n">of</span> <span class="n">integers</span><span class="o">.</span> <span class="n">Default</span><span class="o">=-</span><span class="mi">1</span><span class="o">,</span> 
    <span class="n">means</span> <span class="n">profile</span> <span class="n">likelihoods</span> <span class="n">were</span> <span class="n">calculated</span> <span class="n">around</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">present</span> 
    <span class="k">in</span> <span class="n">the</span> <span class="n">model</span><span class="o">.</span> <span class="n">When</span> <span class="n">Index</span><span class="o">=-</span><span class="mi">1</span> <span class="n">you</span> <span class="n">must</span> <span class="n">speficy</span> <span class="n">an</span> <span class="n">argument</span> <span class="n">to</span> <span class="n">the</span> 
    <span class="n">RSS</span> <span class="n">argument</span><span class="o">.</span> <span class="n">An</span> <span class="n">integer</span> <span class="n">Index</span> <span class="n">other</span> <span class="n">than</span> <span class="o">-</span><span class="mi">1</span> <span class="n">specifies</span> <span class="n">that</span> <span class="n">a</span> <span class="n">profile</span>
    <span class="n">likleihood</span> <span class="n">was</span> <span class="n">calculated</span> <span class="n">around</span> <span class="n">the</span> <span class="n">integer</span> <span class="n">best</span> <span class="kd">set</span> <span class="n">of</span> <span class="n">parameters</span> <span class="n">and</span> 
    <span class="n">to</span> <span class="n">plot</span> <span class="n">them</span><span class="o">.</span> <span class="n">A</span> <span class="n">list</span> <span class="n">of</span> <span class="n">integers</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">plotting</span> <span class="n">of</span> <span class="n">an</span> 
    <span class="n">arbtrary</span> <span class="n">number</span> <span class="n">of</span> <span class="n">profile</span> <span class="n">likelihoods</span><span class="o">.</span> <span class="n">When</span> <span class="n">Index</span> <span class="k">is</span> <span class="n">an</span> <span class="n">Int</span> <span class="n">or</span> <span class="n">list</span> <span class="n">of</span> <span class="n">Int</span>
    <span class="n">the</span> <span class="n">RSS</span> <span class="n">argument</span> <span class="k">is</span> <span class="n">taken</span> <span class="n">directly</span> <span class="n">from</span> <span class="n">the</span> <span class="n">PE</span> <span class="n">data</span> <span class="n">specified</span> <span class="n">by</span> <span class="n">ParameterPath</span>

<span class="n">NumProcesses</span><span class="o">:</span>
    <span class="n">How</span> <span class="n">many</span> <span class="n">processes</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">plotting</span><span class="o">,</span> <span class="n">which</span> <span class="n">can</span> <span class="n">be</span> <span class="n">fairly</span> <span class="n">intensive</span> 
    <span class="n">computationally</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mi">1</span>

<span class="n">Alpha</span><span class="o">:</span>
    <span class="n">The</span> <span class="n">alpha</span> <span class="n">cut</span> <span class="n">off</span> <span class="k">for</span> <span class="n">the</span> <span class="n">chi</span> <span class="n">squared</span> <span class="n">based</span> <span class="n">confidence</span> <span class="n">interval</span><span class="o">.</span> 
    <span class="n">Default</span><span class="o">=</span><span class="mf">0.95</span>

<span class="n">N</span><span class="o">:</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">data</span> <span class="n">points</span> <span class="k">in</span> <span class="n">use</span><span class="o">.</span> <span class="n">The</span> <span class="n">data</span> <span class="n">files</span> <span class="n">that</span> <span class="n">were</span> <span class="n">used</span> <span class="k">for</span> 
    <span class="n">parameter</span> <span class="n">estimation</span> <span class="k">in</span> <span class="n">the</span> <span class="n">original</span> <span class="n">copasi</span> <span class="n">file</span> <span class="o">(</span><span class="n">the</span> <span class="n">argument</span> <span class="n">to</span> <span class="n">copasi_file</span><span class="o">)</span>
    <span class="n">were</span> <span class="n">extracted</span><span class="o">,</span> <span class="n">parsed</span> <span class="n">and</span> <span class="n">data</span> <span class="n">points</span> <span class="n">were</span> <span class="n">counted</span><span class="o">.</span> <span class="n">This</span> <span class="n">value</span> <span class="k">is</span> <span class="n">the</span> <span class="k">default</span>
    <span class="n">but</span> <span class="n">can</span> <span class="n">be</span> <span class="n">over</span><span class="o">-</span><span class="n">ridden</span> <span class="k">if</span> <span class="n">value</span> <span class="n">given</span> <span class="n">to</span> <span class="k">this</span> <span class="n">argument</span><span class="o">.</span>

<span class="n">DOF</span><span class="o">:</span>
    <span class="n">Degrees</span> <span class="n">of</span> <span class="n">freedom</span><span class="o">.</span> <span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">parameters</span> <span class="n">that</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">calculate</span>
    <span class="n">profile</span> <span class="n">likelihoods</span> <span class="k">for</span> <span class="n">minus</span> <span class="mi">1</span> <span class="k">is</span> <span class="n">calcualted</span> <span class="n">automatically</span><span class="o">.</span> <span class="n">This</span> <span class="k">is</span> 
    <span class="k">default</span> <span class="n">but</span> <span class="n">can</span> <span class="n">be</span> <span class="n">overridden</span> <span class="n">by</span> <span class="n">specifying</span> <span class="n">an</span> <span class="n">argument</span> <span class="n">to</span> <span class="k">this</span> <span class="n">keyword</span>

<span class="n">RSS</span><span class="o">:</span>
    <span class="n">Residual</span> <span class="n">Sum</span> <span class="n">of</span> <span class="n">Squared</span><span class="o">.</span> <span class="n">The</span> <span class="n">objective</span> <span class="kd">function</span> <span class="n">used</span> <span class="k">as</span> <span class="n">a</span> <span class="n">measure</span> <span class="n">of</span> <span class="n">distance</span>
    <span class="n">of</span> <span class="n">the</span> <span class="n">experimental</span> <span class="n">to</span> <span class="n">simulated</span> <span class="n">data</span><span class="o">.</span> <span class="n">The</span> <span class="n">RSS</span> <span class="k">is</span> <span class="n">minimized</span> <span class="n">by</span> <span class="n">copasi</span><span class="s1">&#39;s </span>
<span class="s1">    parameter estimation algorithms. The smaller the better. This value is </span>
<span class="s1">    automatically taken from parameter estimation data if the Index kwarg </span>
<span class="s1">    is anything other than minus 1. when Index=-1, the RSS value must be </span>
<span class="s1">    given to this argument for the calculation of the chi squared based </span>
<span class="s1">    confidence interval</span>

<span class="s1">FontSize:</span>
<span class="s1">    Control graph label font size</span>

<span class="s1">AxisSize:</span>
<span class="s1">    Control graph axis font size</span>

<span class="s1">ExtraTitle:</span>
<span class="s1">    When savefig=&#39;</span><span class="kc">true</span><span class="s1">&#39;, given the saved</span>
<span class="s1">    file an extra label in the file path</span>

<span class="s1">LineWidth:</span>
<span class="s1">    Control graph LineWidth</span>

<span class="s1">DotSize:</span>
<span class="s1">    How big to plot the dots on the graph</span>

<span class="s1">Bins:</span>
<span class="s1">    Control number of bins in any histograms. Used???</span>

<span class="s1">MultiPlot:</span>
<span class="s1">    Plot results of sequential profile likelihoods for the same </span>
<span class="s1">    parameter but with different Index on the same graph. Results</span>
<span class="s1">    accumulate with Index value, so desired graphs are in the</span>
<span class="s1">    folder with the largest index.</span>

<span class="s1">SaveFig:</span>
<span class="s1">    Save graphs to file labelled after the index</span>

<span class="s1">InterpolationKind:</span>
<span class="s1">    Which method to use for interpolation. Can be any of [&#39;</span><span class="n">linear</span><span class="s1">&#39;, </span>
<span class="s1">    &#39;</span><span class="n">nearest</span><span class="s1">&#39;, &#39;</span><span class="n">zero</span><span class="s1">&#39;, &#39;</span><span class="n">slinear</span><span class="s1">&#39;, &#39;</span><span class="n">quadratic</span><span class="s1">&#39;, &#39;</span><span class="n">cubic</span><span class="s1">&#39;] but be careful</span>
<span class="s1">    with these. Default=slinear</span>

<span class="s1">TitleWrapSize:</span>
<span class="s1">    When graph titles are long, how many characters to have per </span>
<span class="s1">    line before word wrap. Default=30.</span>

<span class="s1">Show:</span>
<span class="s1">    When not using iPython, use Show=&#39;</span><span class="kc">true</span><span class="s1">&#39; to display graphs</span>

<span class="s1">InterpolationResolution;</span>
<span class="s1">    Number of points to split line into for interpolation. Defualt=1000</span>

<span class="s1">Ylimit: </span>
<span class="s1">    default==None, restrict amount of data shown on y axis. </span>
<span class="s1">    Useful for honing in on small confidence intervals</span>

<span class="s1">Xlimit: </span>
<span class="s1">    default==None, restrict amount of data shown on x axis. </span>
<span class="s1">    Useful for honing in on small confidence intervals</span>

<span class="s1">DPI:</span>
<span class="s1">    How big saved figure should be. Default=125</span>

<span class="s1">XTickRotation:</span>
<span class="s1">    How many degrees to rotate the X tick labels</span>
<span class="s1">    of the output. Useful if you have very small or large</span>
<span class="s1">    numbers that overlay when plotting.</span>

<span class="s1">Mode: </span>
<span class="s1">    either &#39;</span><span class="n">all</span><span class="s1">&#39;, &#39;</span><span class="n">one</span><span class="s1">&#39; or &#39;</span><span class="n">none</span> <span class="n">to</span> <span class="n">either</span> <span class="n">plot</span> <span class="n">all</span> <span class="n">results</span> 
    <span class="n">or</span> <span class="n">just</span> <span class="n">a</span> <span class="n">certain</span> <span class="n">parameter</span><span class="o">.</span> <span class="n">Defulat</span><span class="o">=</span><span class="s1">&#39;all&#39;</span>

<span class="n">PlotIndex</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">Mode</span> <span class="kd">set</span> <span class="n">to</span> <span class="s1">&#39;one&#39;</span><span class="o">,</span> <span class="k">this</span> <span class="n">specifies</span> <span class="n">the</span> <span class="n">index</span> <span class="n">of</span> <span class="n">the</span> 
    <span class="n">profile</span> <span class="n">likelihood</span> <span class="n">run</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">plot</span> <span class="o">(</span><span class="n">i</span><span class="o">.</span><span class="na">e</span> <span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="mi">0</span><span class="o">,[</span><span class="mi">0</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">5</span><span class="o">])</span>

<span class="n">PlotParameter</span><span class="o">:</span>
    <span class="n">If</span> <span class="n">Mode</span> <span class="kd">set</span> <span class="n">to</span> <span class="s1">&#39;one&#39;</span> <span class="n">which</span> <span class="n">parameter</span> <span class="n">to</span> <span class="n">plot</span><span class="o">.</span> <span class="n">Must</span>
    <span class="n">be</span> <span class="n">an</span> <span class="n">item</span> <span class="k">in</span> <span class="n">your</span> <span class="n">results</span><span class="o">.</span>

<span class="n">Separator</span><span class="o">:</span>
    <span class="n">Separator</span> <span class="n">used</span> <span class="k">in</span> <span class="n">csv</span> <span class="n">file</span> <span class="k">for</span> <span class="n">experimental</span> <span class="n">data</span><span class="o">.</span> 
    <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;   &#39;</span>

<span class="n">Log10</span><span class="o">:</span>
    <span class="s1">&#39;true&#39;</span> <span class="n">or</span> <span class="s1">&#39;false&#39;</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="o">.</span> <span class="n">Plot</span> <span class="n">on</span> <span class="n">log10</span><span class="o">-</span><span class="n">log10</span> <span class="n">scale</span>

<span class="n">UsePickle</span><span class="o">:</span>
    <span class="n">Data</span> <span class="n">read</span> <span class="n">by</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="na">ParsePEData</span> <span class="n">are</span> <span class="n">automatically</span> <span class="n">pickled</span>
    <span class="k">for</span> <span class="n">speed</span><span class="o">.</span> <span class="s1">&#39;true&#39;</span> <span class="n">or</span> <span class="s1">&#39;false&#39;</span> <span class="n">to</span> <span class="n">use</span> <span class="n">pickle</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;false&#39;</span>

<span class="n">OverwritePickle</span><span class="o">:</span>
    <span class="n">If</span> <span class="n">data</span> <span class="n">has</span> <span class="n">changed</span> <span class="kd">set</span> <span class="s1">&#39;OverwritePickle&#39;</span> <span class="n">to</span> <span class="s1">&#39;true&#39;</span> <span class="n">to</span> <span class="n">rewrite</span> 
    <span class="n">pickle</span> <span class="n">before</span> <span class="s1">&#39;UsePickle&#39;</span> <span class="n">can</span> <span class="n">be</span> <span class="n">useful</span> <span class="n">again</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;false&#39;</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Plot</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;    </span>
<span class="sd">    After ProfileLikelihood class has been run, the Plot class will plot the</span>
<span class="sd">    profile likelihoods for you. </span>
<span class="sd">    </span>
<span class="sd">    copasi_file:</span>
<span class="sd">        The copasi file you ran a profile likelihood on</span>
<span class="sd">        </span>
<span class="sd">    **kwargs:</span>
<span class="sd">    </span>
<span class="sd">        ParameterPath:</span>
<span class="sd">            When Index is anything other than -1 you need to specify the absolute</span>
<span class="sd">            path to your parameters. </span>
<span class="sd">            </span>
<span class="sd">        Index:</span>
<span class="sd">            Which Index to plot. Either an integer or list of integers. Default=-1, </span>
<span class="sd">            means profile likelihoods were calculated around the parameters present </span>
<span class="sd">            in the model. When Index=-1 you must speficy an argument to the </span>
<span class="sd">            RSS argument. An integer Index other than -1 specifies that a profile</span>
<span class="sd">            likleihood was calculated around the integer best set of parameters and </span>
<span class="sd">            to plot them. A list of integers specifies the plotting of an </span>
<span class="sd">            arbtrary number of profile likelihoods. When Index is an Int or list of Int</span>
<span class="sd">            the RSS argument is taken directly from the PE data specified by ParameterPath</span>
<span class="sd">            </span>
<span class="sd">        NumProcesses:</span>
<span class="sd">            How many processes to use for plotting, which can be fairly intensive </span>
<span class="sd">            computationally. Default=1</span>
<span class="sd">            </span>
<span class="sd">        Alpha:</span>
<span class="sd">            The alpha cut off for the chi squared based confidence interval. </span>
<span class="sd">            Default=0.95</span>
<span class="sd">            </span>
<span class="sd">        N:</span>
<span class="sd">            Number of data points in use. The data files that were used for </span>
<span class="sd">            parameter estimation in the original copasi file (the argument to copasi_file)</span>
<span class="sd">            were extracted, parsed and data points were counted. This value is the default</span>
<span class="sd">            but can be over-ridden if value given to this argument.</span>
<span class="sd">            </span>
<span class="sd">        DOF:</span>
<span class="sd">            Degrees of freedom. The number of parameters that you want to calculate</span>
<span class="sd">            profile likelihoods for minus 1 is calcualted automatically. This is </span>
<span class="sd">            default but can be overridden by specifying an argument to this keyword</span>
<span class="sd">            </span>
<span class="sd">        RSS:</span>
<span class="sd">            Residual Sum of Squared. The objective function used as a measure of distance</span>
<span class="sd">            of the experimental to simulated data. The RSS is minimized by copasi&#39;s </span>
<span class="sd">            parameter estimation algorithms. The smaller the better. This value is </span>
<span class="sd">            automatically taken from parameter estimation data if the Index kwarg </span>
<span class="sd">            is anything other than minus 1. when Index=-1, the RSS value must be </span>
<span class="sd">            given to this argument for the calculation of the chi squared based </span>
<span class="sd">            confidence interval</span>

<span class="sd">        FontSize:</span>
<span class="sd">            Control graph label font size</span>

<span class="sd">        AxisSize:</span>
<span class="sd">            Control graph axis font size</span>

<span class="sd">        ExtraTitle:</span>
<span class="sd">            When savefig=&#39;true&#39;, given the saved</span>
<span class="sd">            file an extra label in the file path</span>

<span class="sd">        LineWidth:</span>
<span class="sd">            Control graph LineWidth</span>
<span class="sd">            </span>
<span class="sd">        DotSize:</span>
<span class="sd">            How big to plot the dots on the graph</span>

<span class="sd">        Bins:</span>
<span class="sd">            Control number of bins in any histograms. Used???</span>

<span class="sd">        MultiPlot:</span>
<span class="sd">            Plot results of sequential profile likelihoods for the same </span>
<span class="sd">            parameter but with different Index on the same graph. Results</span>
<span class="sd">            accumulate with Index value, so desired graphs are in the</span>
<span class="sd">            folder with the largest index. </span>
<span class="sd">            </span>
<span class="sd">        SaveFig:</span>
<span class="sd">            Save graphs to file labelled after the index</span>

<span class="sd">        InterpolationKind:</span>
<span class="sd">            Which method to use for interpolation. Can be any of [&#39;linear&#39;, </span>
<span class="sd">            &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;] but be careful</span>
<span class="sd">            with these. Default=slinear</span>

<span class="sd">        TitleWrapSize:</span>
<span class="sd">            When graph titles are long, how many characters to have per </span>
<span class="sd">            line before word wrap. Default=30. </span>
<span class="sd">            </span>
<span class="sd">        Show:</span>
<span class="sd">            When not using iPython, use Show=&#39;true&#39; to display graphs</span>
<span class="sd">            </span>
<span class="sd">        InterpolationResolution;</span>
<span class="sd">            Number of points to split line into for interpolation. Defualt=1000</span>
<span class="sd">            </span>
<span class="sd">        Ylimit: </span>
<span class="sd">            default==None, restrict amount of data shown on y axis. </span>
<span class="sd">            Useful for honing in on small confidence intervals</span>

<span class="sd">        Xlimit: </span>
<span class="sd">            default==None, restrict amount of data shown on x axis. </span>
<span class="sd">            Useful for honing in on small confidence intervals</span>
<span class="sd">        </span>
<span class="sd">        DPI:</span>
<span class="sd">            How big saved figure should be. Default=125</span>
<span class="sd">        </span>
<span class="sd">        XTickRotation:</span>
<span class="sd">            How many degrees to rotate the X tick labels</span>
<span class="sd">            of the output. Useful if you have very small or large</span>
<span class="sd">            numbers that overlay when plotting. </span>
<span class="sd">            </span>
<span class="sd">        Mode: </span>
<span class="sd">            either &#39;all&#39;, &#39;one&#39; or &#39;none to either plot all results </span>
<span class="sd">            or just a certain parameter. Defulat=&#39;all&#39;</span>
<span class="sd">            </span>
<span class="sd">        PlotIndex:</span>
<span class="sd">            if Mode set to &#39;one&#39;, this specifies the index of the </span>
<span class="sd">            profile likelihood run you want to plot (i.e -1,0,[0,3,5])</span>
<span class="sd">            </span>
<span class="sd">        PlotParameter:</span>
<span class="sd">            If Mode set to &#39;one&#39; which parameter to plot. Must</span>
<span class="sd">            be an item in your results. </span>
<span class="sd">            </span>
<span class="sd">        Separator:</span>
<span class="sd">            Separator used in csv file for experimental data. </span>
<span class="sd">            Default=&#39;\t&#39;</span>
<span class="sd">            </span>
<span class="sd">        Log10:</span>
<span class="sd">            &#39;true&#39; or &#39;false&#39;. Default=&#39;true&#39;. Plot on log10-log10 scale</span>
<span class="sd">            </span>
<span class="sd">        UsePickle:</span>
<span class="sd">            Data read by PEAnalysis.ParsePEData are automatically pickled</span>
<span class="sd">            for speed. &#39;true&#39; or &#39;false&#39; to use pickle. Default=&#39;false&#39;</span>
<span class="sd">        </span>
<span class="sd">        OverwritePickle:</span>
<span class="sd">            If data has changed set &#39;OverwritePickle&#39; to &#39;true&#39; to rewrite </span>
<span class="sd">            pickle before &#39;UsePickle&#39; can be useful again. Default=&#39;false&#39;</span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>

        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
                 <span class="s1">&#39;ParameterPath&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>                 
                 <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> 
                 <span class="s1">&#39;Alpha&#39;</span><span class="p">:</span><span class="mf">0.95</span><span class="p">,</span>
                 <span class="s1">&#39;DOF&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;RSS&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;QuantityType&#39;</span><span class="p">:</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
                 
                 <span class="c1">#graph features</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;LineWidth&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;MultiPlot&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;InterpolationKind&#39;</span><span class="p">:</span><span class="s1">&#39;slinear&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
                 <span class="s1">&#39;Ylimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Xlimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;XTickRotation&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;Mode&#39;</span><span class="p">:</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;PlotIndex&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;PlotParameter&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;DotSize&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;Separator&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 
                 <span class="s1">&#39;UsePickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;OverwritePickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="p">}</span>
                 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for Plot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>       
    
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Log10 argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UsePickle&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;UsePickle argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OverwritePickle&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;OverwritePickle argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>

            
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;You have selected {} processes but your computer only has {} available&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
        
        <span class="c1">#if Index is -1 i.e. current parameters, user needs to give RSS</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;when calculating PL around current parameter sets must specify the current RSS as keyword argument to Plot&#39;</span><span class="p">)</span>
        
        <span class="c1">#otherwise the RSS is ascertained automatically from the ParameterPath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">,</span><span class="s1">&#39;If Index!=-1 then you need to suply argument to ParameterPath&#39;</span>
        

        <span class="c1">#line interpolation options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;zero&#39;</span><span class="p">,</span> <span class="s1">&#39;slinear&#39;</span><span class="p">,</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic&#39;</span><span class="p">],</span><span class="s2">&quot;interpolation kind must be one of [&#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;]&quot;</span>

        <span class="c1">#limit parameters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Ylimit is a list of coordinates for y axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Ylimit list must be 2&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Xlimit is a list of coordinates for X axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Xlimit list must be 2&#39;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;XTickRotation parameter should be a Python integer&#39;</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;ExtraTitle should be of type str&#39;</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;FontSize argument should be of type int&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;AxisSize argument should be of type int&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;LineWidth argument should be of type int&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationKind argument should be of type str&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution argument should be of type int&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize argument should be of type int&#39;</span><span class="p">)</span>


        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution argument should be of type int&#39;</span><span class="p">)</span>

            
            


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
            
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;partical_numbers&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_PL_dir</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_dirs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_results</span><span class="p">()</span> 
        
        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The below arguments rely on the above code. Do not change</span>
<span class="sd">        the ordering!</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#default DOF is num estimated parameters minus 1 but can be manually overrider by specifying DOF keyword</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;DOF&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">degrees_of_freedom</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Please specify argument to DOF keyword&#39;</span><span class="p">)</span>
        
        <span class="c1">#defult N is number of data points in your data set. </span>
        <span class="c1">#This can be overridden by manually specifying N</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_data_points</span><span class="p">()</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span>        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;none&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not a valid mode. Mode should be either all or one&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)))</span>
<span class="c1">#</span>

  

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">!=</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not a valid Parameter. Your parameters are: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">()))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not an index in your Indices: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
            
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not an index in your Indices: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;one&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">))</span>
            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_chi2_CI</span><span class="p">()</span>
        <span class="n">CI</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">CI</span><span class="p">:</span>
            <span class="k">print</span> <span class="s1">&#39;Confidence level for Index {} is {} or {} on a Log10 scale&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            
    <span class="k">def</span> <span class="nf">get_PL_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Find the ProfleLikelihood directory within the same directory as copasi_file</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="n">path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="s1">&#39;The current directory: {} </span><span class="se">\t</span><span class="s1"> does not contain a directory called ProfileLikelihood, have you used the ProfileLikelihood class with the Run option enabled?&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>
        
    <span class="k">def</span> <span class="nf">get_index_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Under the ProfileLikelihood folder are a list of folders named after</span>
<span class="sd">        the integer rank of best fit (.e. -1,0,1,2 ...)</span>
<span class="sd">        returns list of these directories</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dirs</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">)</span>
        <span class="n">dirs2</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs2</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dirs2</span>
        
    <span class="k">def</span> <span class="nf">get_index_dirs_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        returns dict[index]=directory to index</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">dirs</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">)</span>
        <span class="n">dirs2</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs2</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">split</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">)]</span><span class="o">=</span><span class="n">i</span>
        <span class="k">return</span> <span class="n">d</span>
        
    <span class="k">def</span> <span class="nf">get_experiment_files_in_use</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Need to exclude data files fromlist of parameters to plot</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">query</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;File Name&quot;]&#39;</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">l</span>
        
        
    <span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.txt&#39;</span><span class="p">):</span>
<span class="c1">#                if os.path.splitext(j)[0]  in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_fit_items().keys()]:</span>
                    <span class="n">f</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])][</span><span class="n">f</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">d</span>
        
    <span class="k">def</span> <span class="nf">parse_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">df_dict</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">experiment_keys</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_files_in_use</span><span class="p">()]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">:</span>
            <span class="n">df_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiment_keys</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Separator&#39;</span><span class="p">])</span>
                    <span class="n">best_value_str</span><span class="o">=</span><span class="s1">&#39;TaskList[Parameter Estimation].(Problem)Parameter Estimation.Best Value&#39;</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">best_value_str</span><span class="p">:</span><span class="s1">&#39;RSS&#39;</span><span class="p">})</span>
                    <span class="n">df_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">data</span>
        <span class="k">return</span> <span class="n">df_dict</span>
<span class="c1">#        </span>
    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">num_estimated_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="c1">#        try:</span>
        <span class="n">first_key</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">count</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">first_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">count</span>
<span class="c1">#        except AttributeError:</span>
<span class="c1">#            raise Errors.InputError(&#39;Index set to -1 and therefore a ParameterPath is not present to count data points. Specify an argument to N kwarg&#39;)</span>
        
        
    <span class="k">def</span> <span class="nf">degrees_of_freedom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The number of parameters being estimated minus 1</span>
<span class="sd">        &#39;&#39;&#39;</span>
<span class="c1">#        try:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_estimated_params</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span>
<span class="c1">#        except AttributeError:</span>
<span class="c1">#            raise Errors.InputError(&#39;Index set to -1 and therefore a ParameterPath is not present to count number of parameter. Specify an argument to DOF kwarg&#39;)</span>
        
    <span class="k">def</span> <span class="nf">num_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        returns number of data points in your data files</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">experimental_data</span><span class="o">=</span> <span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Separator&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_files_in_use</span><span class="p">()]</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">experimental_data</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">s</span><span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Number of data points cannot be 0. This is wrong&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span> <span class="nf">get_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">RSS</span><span class="o">=</span><span class="p">{}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span>
            <span class="n">RSS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">RSS</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">PED</span><span class="o">=</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">),</span>
                                        <span class="n">UsePickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UsePickle&#39;</span><span class="p">],</span>
                                        <span class="n">OverwritePickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;OverwritePickle&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">RSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]</span><span class="o">=</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="n">RSS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">RSS</span>
        
    <span class="k">def</span> <span class="nf">chi2_lookup_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Looks at the cdf of a chi2 distribution at incriments of </span>
<span class="sd">        0.1 between 0 and 100. </span>
<span class="sd">        </span>
<span class="sd">        Returns the x axis value at which the alpha interval has been crossed, </span>
<span class="sd">        i.e. gets the cut off point for chi2 dist with DOF and alpha . </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">nums</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">table</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">))</span> <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">alpha</span><span class="p">:</span>
                <span class="n">chi2_df_alpha</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">chi2_df_alpha</span>  
        
    <span class="k">def</span> <span class="nf">get_chi2_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        return the chi2 threshold for cut off point alpha and DOF degrees of freedom</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">alphas</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
            <span class="n">dct</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2_lookup_table</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Alpha&#39;</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">plot_chi2_CI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Visualize where the alpha cut off is on the chi2 distribution</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span> <span class="mi">100</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chi2 pdf&#39;</span><span class="p">)</span>
        
        <span class="n">y_alpha</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x_alpha</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chi2_alpha</span><span class="p">()]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y_alpha</span><span class="p">)</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_alpha</span><span class="p">,</span><span class="n">y_alpha</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chi2 distribution with {} DOF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">calc_chi2_CI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        get chi2 CI at alpha</span>
<span class="sd">        alpha=decimal between 0 and 1 with 2 decimal places </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">CI_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_RSS</span><span class="p">():</span>
            <span class="n">r</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_RSS</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chi2_alpha</span><span class="p">()</span>
            <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_data_points</span><span class="p">()</span>
            <span class="n">CI_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">a</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">CI_dct</span>
        
        
    <span class="k">def</span> <span class="nf">get_original_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        go and find out what the value of the parameter was in the PE data </span>
<span class="sd">        at index</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">():</span>
            <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">():</span>
            <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
                <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>





        
<span class="c1">#            else:</span>
<span class="c1">#                best_parameter_value=self.GMQ.get_IC_cns()[parameter][&#39;value&#39;]</span>
            
<span class="c1">#        if st in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_IC_cns().keys()] or self.GMQ.get_IC_cns().keys():</span>
<span class="c1">#            if self.kwargs.get(&#39;QuantityType&#39;)==&#39;concentration&#39;:</span>
<span class="c1">#                best_parameter_value=self.GMQ.get_IC_cns()[parameter][&#39;concentration&#39;]</span>
<span class="c1">#            else:</span>
<span class="c1">#                best_parameter_value=self.GMQ.get_IC_cns()[parameter][&#39;value&#39;]</span>
<span class="c1">#        if st in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_local_kinetic_parameters_cns()] or self.GMQ.get_local_kinetic_parameters_cns().keys():</span>
<span class="c1">#            best_parameter_value=self.GMQ.get_local_kinetic_parameters_cns()[parameter][&#39;value&#39;]</span>
<span class="c1">#</span>
<span class="c1">#        if st in [Misc.RemoveNonAscii(i).filter for i in self.GMQ.get_global_quantities()] or self.GMQ.get_global_quantities().keys():</span>
<span class="c1">#            best_parameter_value= self.GMQ.get_global_quantities()[parameter]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">best_parameter_value</span>
        <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
            <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">None</span>
            <span class="k">return</span> <span class="n">best_parameter_value</span>
            

            
            
            
<span class="c1">#</span>
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot one parameter. </span>
<span class="sd">        </span>
<span class="sd">        things to check:</span>
<span class="sd">            that we are plotting the correct data</span>
<span class="sd">            that the CI line is calculated correctly</span>
<span class="sd">            that the red dot is in the correct place</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
<span class="c1">#        if parameter not in self.GMQ.get_all_model_variables().keys():</span>
<span class="c1">#            raise Errors.InputError(&#39;{} is not in your model. These are parameters in your model: {}&#39;.format(parameter,self.GMQ.get_all_model_variables().keys()))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">parameter</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="c1">#plot parameter vs RSS once as green circles the other as lines</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="o">==</span><span class="s1">&#39;invalid literal for float(): 1.#INF&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
            
        <span class="c1">#now get your interpolation on...</span>
        <span class="n">f</span><span class="o">=</span><span class="n">interp1d</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">))</span>
        <span class="n">interp_parameter_value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span>
                                              <span class="nb">max</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span> 
                                              <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">interp_RSS_value</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">interp_parameter_value</span><span class="p">)</span>        
        <span class="n">handle</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interp_parameter_value</span><span class="p">,</span><span class="n">interp_RSS_value</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
        
        <span class="c1">#plot the confidence interval </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">CI</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()[</span><span class="n">index</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">CI</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
        
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,[</span><span class="n">CI</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
<span class="c1">#        print self.GMQ.get_all_model_variables()</span>
<span class="c1">#        print parameter</span>
        <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
<span class="c1">#        print st</span>
        <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_original_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span>   
        <span class="k">if</span> <span class="n">best_parameter_value</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>         
            <span class="c1">#best parameter value contains the model value for pparameter</span>
            <span class="c1">#we now need to look this value up on the interpolation and read off the corresponding RSS value</span>
            <span class="c1">#first find the parameter value in the interolation that is closest to the best param val</span>
            <span class="n">pandas</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">interp_df</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">interp_parameter_value</span><span class="p">,</span><span class="n">interp_RSS_value</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">parameter</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
            <span class="n">best_parameter_value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">best_parameter_value</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">abs_diff_df</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">interp_df</span><span class="o">-</span><span class="n">best_parameter_value</span><span class="p">)</span>
            <span class="n">minimum_index</span><span class="o">=</span> <span class="n">abs_diff_df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">best_parameter_value</span><span class="o">=</span> <span class="n">interp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">minimum_index</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
            <span class="n">best_RSS_value</span><span class="o">=</span><span class="n">interp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">minimum_index</span><span class="p">][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_parameter_value</span><span class="p">,</span><span class="n">best_RSS_value</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
        
        <span class="c1">#plot labels</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>  
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>         
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
       <span class="c1">#pretty stuff</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#xtick rotation</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">))</span>
        
        <span class="c1">#options for changing the plot axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">save_plot</span><span class="p">():</span>
            <span class="n">filename</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span> <span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="n">filename</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">filename</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>     
            <span class="k">return</span> <span class="n">filename</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
            
        <span class="c1">#save figure options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_dirs_as_dict</span><span class="p">()[</span><span class="n">index</span><span class="p">])</span>
            <span class="n">graph_dirs</span><span class="o">=</span><span class="n">save_plot</span><span class="p">()</span>
            <span class="c1">#change back to parent directory</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">graph_dirs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
            
    <span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
<span class="c1">#            print self.data</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="n">i</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Index out of bounds, i.e. Index&gt;number PE runs&#39;</span><span class="p">)</span>
<span class="c1">#                </span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="n">i</span><span class="p">)</span>
<span class="c1">#            except KeyError:</span>
<span class="c1">#                raise Errors.InputError(&#39;Index out of bounds, i.e. Index&gt;number PE runs&#39;)</span>
                
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pydentify2.Plot">Plot</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="pydentify2.Plot.CParser" class="name">var <span class="ident">CParser</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.GMQ" class="name">var <span class="ident">GMQ</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.PL_dir" class="name">var <span class="ident">PL_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.copasiML" class="name">var <span class="ident">copasiML</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.copasi_file" class="name">var <span class="ident">copasi_file</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.data" class="name">var <span class="ident">data</span></p>
            

            
  
    <div class="desc"><p>The below arguments rely on the above code. Do not change
the ordering!</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.indices" class="name">var <span class="ident">indices</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.Plot.result_paths" class="name">var <span class="ident">result_paths</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, copasi_file, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
             <span class="s1">&#39;ParameterPath&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>                 
             <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> 
             <span class="s1">&#39;Alpha&#39;</span><span class="p">:</span><span class="mf">0.95</span><span class="p">,</span>
             <span class="s1">&#39;DOF&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;RSS&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;QuantityType&#39;</span><span class="p">:</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
             
             <span class="c1">#graph features</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;LineWidth&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
             <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;MultiPlot&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;InterpolationKind&#39;</span><span class="p">:</span><span class="s1">&#39;slinear&#39;</span><span class="p">,</span>
             <span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
             <span class="s1">&#39;Ylimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Xlimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;XTickRotation&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;Mode&#39;</span><span class="p">:</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
             <span class="s1">&#39;PlotIndex&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;PlotParameter&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;DotSize&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
             <span class="s1">&#39;Separator&#39;</span><span class="p">:</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             
             <span class="s1">&#39;UsePickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;OverwritePickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="p">}</span>
             
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for Plot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>       

    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Log10 argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UsePickle&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;UsePickle argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OverwritePickle&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;OverwritePickle argument should be </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> not {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)))</span>
        
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;You have selected {} processes but your computer only has {} available&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
    
    <span class="c1">#if Index is -1 i.e. current parameters, user needs to give RSS</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;when calculating PL around current parameter sets must specify the current RSS as keyword argument to Plot&#39;</span><span class="p">)</span>
    
    <span class="c1">#otherwise the RSS is ascertained automatically from the ParameterPath</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">,</span><span class="s1">&#39;If Index!=-1 then you need to suply argument to ParameterPath&#39;</span>
    
    <span class="c1">#line interpolation options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="s1">&#39;zero&#39;</span><span class="p">,</span> <span class="s1">&#39;slinear&#39;</span><span class="p">,</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">,</span> <span class="s1">&#39;cubic&#39;</span><span class="p">],</span><span class="s2">&quot;interpolation kind must be one of [&#39;linear&#39;, &#39;nearest&#39;, &#39;zero&#39;, &#39;slinear&#39;, &#39;quadratic&#39;, &#39;cubic&#39;]&quot;</span>
    <span class="c1">#limit parameters</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Ylimit is a list of coordinates for y axis,i.e. [0,10]&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Ylimit list must be 2&#39;</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Xlimit is a list of coordinates for X axis,i.e. [0,10]&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Xlimit list must be 2&#39;</span>
    
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;XTickRotation parameter should be a Python integer&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;ExtraTitle should be of type str&#39;</span><span class="p">)</span>
            
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;FontSize argument should be of type int&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;AxisSize argument should be of type int&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;LineWidth argument should be of type int&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationKind argument should be of type str&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution argument should be of type int&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize argument should be of type int&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution argument should be of type int&#39;</span><span class="p">)</span>
        
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        
        
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;partical_numbers&#39;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_PL_dir</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_dirs</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_results</span><span class="p">()</span> 
    
    
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The below arguments rely on the above code. Do not change</span>
<span class="sd">    the ordering!</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#default DOF is num estimated parameters minus 1 but can be manually overrider by specifying DOF keyword</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;DOF&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">degrees_of_freedom</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Please specify argument to DOF keyword&#39;</span><span class="p">)</span>
    
    <span class="c1">#defult N is number of data points in your data set. </span>
    <span class="c1">#This can be overridden by manually specifying N</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span> <span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_data_points</span><span class="p">()</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span>        
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;all&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span><span class="s1">&#39;none&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not a valid mode. Mode should be either all or one&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">!=</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not a valid Parameter. Your parameters are: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">()))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not an index in your Indices: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
        
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not an index in your Indices: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;one&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotIndex&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PlotParameter&#39;</span><span class="p">))</span>
        
    
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_chi2_CI</span><span class="p">()</span>
    <span class="n">CI</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">CI</span><span class="p">:</span>
        <span class="k">print</span> <span class="s1">&#39;Confidence level for Index {} is {} or {} on a Log10 scale&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">CI</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.calc_chi2_CI">
    <p>def <span class="ident">calc_chi2_CI</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>get chi2 CI at alpha
alpha=decimal between 0 and 1 with 2 decimal places</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.calc_chi2_CI', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.calc_chi2_CI" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">calc_chi2_CI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    get chi2 CI at alpha</span>
<span class="sd">    alpha=decimal between 0 and 1 with 2 decimal places </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">CI_dct</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">get_RSS</span><span class="p">():</span>
        <span class="n">r</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_RSS</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chi2_alpha</span><span class="p">()</span>
        <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_data_points</span><span class="p">()</span>
        <span class="n">CI_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">a</span><span class="o">/</span><span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">CI_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.chi2_lookup_table">
    <p>def <span class="ident">chi2_lookup_table</span>(</p><p>self, alpha)</p>
    </div>
    

    
  
    <div class="desc"><p>Looks at the cdf of a chi2 distribution at incriments of 
0.1 between 0 and 100. </p>
<p>Returns the x axis value at which the alpha interval has been crossed, 
i.e. gets the cut off point for chi2 dist with DOF and alpha .</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.chi2_lookup_table', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.chi2_lookup_table" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">chi2_lookup_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alpha</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Looks at the cdf of a chi2 distribution at incriments of </span>
<span class="sd">    0.1 between 0 and 100. </span>
<span class="sd">    </span>
<span class="sd">    Returns the x axis value at which the alpha interval has been crossed, </span>
<span class="sd">    i.e. gets the cut off point for chi2 dist with DOF and alpha . </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">nums</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">table</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">nums</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">))</span> <span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">alpha</span><span class="p">:</span>
            <span class="n">chi2_df_alpha</span><span class="o">=</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">chi2_df_alpha</span>  
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.degrees_of_freedom">
    <p>def <span class="ident">degrees_of_freedom</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>The number of parameters being estimated minus 1</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.degrees_of_freedom', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.degrees_of_freedom" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">degrees_of_freedom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The number of parameters being estimated minus 1</span>
<span class="sd">    &#39;&#39;&#39;</span>
     <span class="k">try</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_estimated_params</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_PL_dir">
    <p>def <span class="ident">get_PL_dir</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Find the ProfleLikelihood directory within the same directory as copasi_file</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_PL_dir', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_PL_dir" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_PL_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Find the ProfleLikelihood directory within the same directory as copasi_file</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">d</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="n">path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="p">),</span><span class="s1">&#39;The current directory: {} </span><span class="se">\t</span><span class="s1"> does not contain a directory called ProfileLikelihood, have you used the ProfileLikelihood class with the Run option enabled?&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">path</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_RSS">
    <p>def <span class="ident">get_RSS</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_RSS', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_RSS" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">RSS</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span>
        <span class="n">RSS</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">RSS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">PED</span><span class="o">=</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">),</span>
                                    <span class="n">UsePickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UsePickle&#39;</span><span class="p">],</span>
                                    <span class="n">OverwritePickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;OverwritePickle&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">RSS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]</span><span class="o">=</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="n">RSS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">RSS</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_chi2_alpha">
    <p>def <span class="ident">get_chi2_alpha</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>return the chi2 threshold for cut off point alpha and DOF degrees of freedom</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_chi2_alpha', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_chi2_alpha" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_chi2_alpha</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    return the chi2 threshold for cut off point alpha and DOF degrees of freedom</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dct</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">alphas</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">:</span>
        <span class="n">dct</span><span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">)]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chi2_lookup_table</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Alpha&#39;</span><span class="p">)]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_experiment_files_in_use">
    <p>def <span class="ident">get_experiment_files_in_use</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Need to exclude data files fromlist of parameters to plot</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_experiment_files_in_use', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_experiment_files_in_use" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_experiment_files_in_use</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Need to exclude data files fromlist of parameters to plot</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">query</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;File Name&quot;]&#39;</span>
    <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">l</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_index_dirs">
    <p>def <span class="ident">get_index_dirs</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Under the ProfileLikelihood folder are a list of folders named after
the integer rank of best fit (.e. -1,0,1,2 ...)
returns list of these directories</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_index_dirs', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_index_dirs" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_index_dirs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Under the ProfileLikelihood folder are a list of folders named after</span>
<span class="sd">    the integer rank of best fit (.e. -1,0,1,2 ...)</span>
<span class="sd">    returns list of these directories</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dirs</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">)</span>
    <span class="n">dirs2</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs2</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dirs2</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_index_dirs_as_dict">
    <p>def <span class="ident">get_index_dirs_as_dict</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>returns dict[index]=directory to index</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_index_dirs_as_dict', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_index_dirs_as_dict" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_index_dirs_as_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    returns dict[index]=directory to index</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">dirs</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">)</span>
    <span class="n">dirs2</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PL_dir</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dirs2</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">split</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">split</span><span class="p">)]</span><span class="o">=</span><span class="n">i</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_original_value">
    <p>def <span class="ident">get_original_value</span>(</p><p>self, index, parameter)</p>
    </div>
    

    
  
    <div class="desc"><p>go and find out what the value of the parameter was in the PE data 
at index</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_original_value', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_original_value" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_original_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    go and find out what the value of the parameter was in the PE data </span>
<span class="sd">    at index</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">():</span>
        <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">():</span>
        <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">():</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
            <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
    
         <span class="k">else</span><span class="p">:</span>
             <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
        
     <span class="k">if</span> <span class="n">st</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
             <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
         <span class="k">else</span><span class="p">:</span>
             <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_IC_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
     <span class="k">if</span> <span class="n">st</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">()]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
         <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_local_kinetic_parameters_cns</span><span class="p">()[</span><span class="n">parameter</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
     <span class="k">if</span> <span class="n">st</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">()]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
         <span class="n">best_parameter_value</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_global_quantities</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">best_parameter_value</span>
    <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
        <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">return</span> <span class="n">best_parameter_value</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.get_results">
    <p>def <span class="ident">get_results</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.get_results', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.get_results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">indices</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])]</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*.txt&#39;</span><span class="p">):</span>
             <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">j</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="ow">in</span> <span class="p">[</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()]:</span>
                <span class="n">f</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">d</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">1</span><span class="p">])][</span><span class="n">f</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.num_data_points">
    <p>def <span class="ident">num_data_points</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>returns number of data points in your data files</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.num_data_points', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.num_data_points" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">num_data_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    returns number of data points in your data files</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">experimental_data</span><span class="o">=</span> <span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Separator&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_files_in_use</span><span class="p">()]</span>
    <span class="n">l</span><span class="o">=</span><span class="p">[]</span>        
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">experimental_data</span><span class="p">:</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">s</span><span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">s</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Number of data points cannot be 0. This is wrong&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.num_estimated_params">
    <p>def <span class="ident">num_estimated_params</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.num_estimated_params', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.num_estimated_params" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">num_estimated_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="k">try</span><span class="p">:</span>
    <span class="n">first_key</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">count</span><span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">first_key</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">count</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.parse_results">
    <p>def <span class="ident">parse_results</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.parse_results', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.parse_results" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">df_dict</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">experiment_keys</span><span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_files_in_use</span><span class="p">()]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">:</span>
        <span class="n">df_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">experiment_keys</span><span class="p">:</span>
                <span class="n">data</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result_paths</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">sep</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Separator&#39;</span><span class="p">])</span>
                <span class="n">best_value_str</span><span class="o">=</span><span class="s1">&#39;TaskList[Parameter Estimation].(Problem)Parameter Estimation.Best Value&#39;</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">best_value_str</span><span class="p">:</span><span class="s1">&#39;RSS&#39;</span><span class="p">})</span>
                <span class="n">df_dict</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">data</span>
    <span class="k">return</span> <span class="n">df_dict</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.plot1">
    <p>def <span class="ident">plot1</span>(</p><p>self, index, parameter)</p>
    </div>
    

    
  
    <div class="desc"><p>Plot one parameter. </p>
<p>things to check:
    that we are plotting the correct data
    that the CI line is calculated correctly
    that the red dot is in the correct place</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.plot1', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.plot1" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot one parameter. </span>
<span class="sd">    </span>
<span class="sd">    things to check:</span>
<span class="sd">        that we are plotting the correct data</span>
<span class="sd">        that the CI line is calculated correctly</span>
<span class="sd">        that the red dot is in the correct place</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
     <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
         <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} is not in your model. These are parameters in your model: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">parameter</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
    <span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="c1">#plot parameter vs RSS once as green circles the other as lines</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="o">==</span><span class="s1">&#39;invalid literal for float(): 1.#INF&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        
    <span class="c1">#now get your interpolation on...</span>
    <span class="n">f</span><span class="o">=</span><span class="n">interp1d</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,</span><span class="n">RSS_val</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationKind&#39;</span><span class="p">))</span>
    <span class="n">interp_parameter_value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span>
                                          <span class="nb">max</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span> 
                                          <span class="n">num</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterpolationResolution&#39;</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">interp_RSS_value</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="n">interp_parameter_value</span><span class="p">)</span>        
    <span class="n">handle</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">interp_parameter_value</span><span class="p">,</span><span class="n">interp_RSS_value</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
    
    <span class="c1">#plot the confidence interval </span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">CI</span><span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()[</span><span class="n">index</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">CI</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_chi2_CI</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
    
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">,[</span><span class="n">CI</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">parameter_val</span><span class="p">),</span><span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
     <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()</span>
     <span class="k">print</span> <span class="n">parameter</span>
    <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">parameter</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
     <span class="k">print</span> <span class="n">st</span>
    <span class="n">best_parameter_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_original_value</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span>   
    <span class="k">if</span> <span class="n">best_parameter_value</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>         
        <span class="c1">#best parameter value contains the model value for pparameter</span>
        <span class="c1">#we now need to look this value up on the interpolation and read off the corresponding RSS value</span>
        <span class="c1">#first find the parameter value in the interolation that is closest to the best param val</span>
        <span class="n">pandas</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">interp_df</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">interp_parameter_value</span><span class="p">,</span><span class="n">interp_RSS_value</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">parameter</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
        <span class="n">best_parameter_value</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">best_parameter_value</span><span class="p">),</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">abs_diff_df</span><span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">interp_df</span><span class="o">-</span><span class="n">best_parameter_value</span><span class="p">)</span>
        <span class="n">minimum_index</span><span class="o">=</span> <span class="n">abs_diff_df</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()[</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">best_parameter_value</span><span class="o">=</span> <span class="n">interp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">minimum_index</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">best_RSS_value</span><span class="o">=</span><span class="n">interp_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">minimum_index</span><span class="p">][</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">best_parameter_value</span><span class="p">,</span><span class="n">best_RSS_value</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
    
    <span class="c1">#plot labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>  
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>         
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
   <span class="c1">#pretty stuff</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1">#xtick rotation</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">))</span>
    
    <span class="c1">#options for changing the plot axis</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">save_plot</span><span class="p">():</span>
        <span class="n">filename</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span> <span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">filename</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">parameter</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>     
        <span class="k">return</span> <span class="n">filename</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="c1">#save figure options</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_index_dirs_as_dict</span><span class="p">()[</span><span class="n">index</span><span class="p">])</span>
        <span class="n">graph_dirs</span><span class="o">=</span><span class="n">save_plot</span><span class="p">()</span>
        <span class="c1">#change back to parent directory</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">graph_dirs</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.plot_all">
    <p>def <span class="ident">plot_all</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.plot_all', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.plot_all" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span><span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
         <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="n">i</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Index out of bounds, i.e. Index&gt;number PE runs&#39;</span><span class="p">)</span>
             
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="n">i</span><span class="p">)</span>
         <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
             <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Index out of bounds, i.e. Index&gt;number PE runs&#39;</span><span class="p">)</span>
            
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.Plot.plot_chi2_CI">
    <p>def <span class="ident">plot_chi2_CI</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Visualize where the alpha cut off is on the chi2 distribution</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.Plot.plot_chi2_CI', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.Plot.plot_chi2_CI" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_chi2_CI</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Visualize where the alpha cut off is on the chi2 distribution</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span> <span class="mi">100</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>        
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;chi2 pdf&#39;</span><span class="p">)</span>
    
    <span class="n">y_alpha</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">x_alpha</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">get_chi2_alpha</span><span class="p">()]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">y_alpha</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_alpha</span><span class="p">,</span><span class="n">y_alpha</span><span class="p">,</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chi2 distribution with {} DOF&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DOF&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Fontsize&#39;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="pydentify2.ProfileLikelihood" class="name">class <span class="ident">ProfileLikelihood</span></p>
      
  
    <div class="desc"><p>This class uses the profile likelihood method of identifiability analysis
to assess whether parameters can be uniquely determined with the defined 
optimization problem. </p>
<p>copasi_file:
    The copasi file you wish to conduct a profile likelihood on</p>
<p>**kwargs:
    ParameterPath:
        The absolute path to either a parameter estimation results file 
        ('.txt','.xlsx','.xls' or '.csv') or a folder of parameter 
        estimation results files. Default=None</p>
<div class="codehilite"><pre><span></span><span class="n">Index</span><span class="o">:</span>
    <span class="n">The</span> <span class="n">index</span> <span class="n">of</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">estimation</span> <span class="n">run</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">calculate</span> 
    <span class="n">a</span> <span class="n">profile</span> <span class="n">likelihood</span> <span class="n">around</span><span class="o">.</span> <span class="n">Parameter</span> <span class="n">estimations</span> <span class="n">are</span> <span class="n">ranked</span> <span class="k">in</span>
    <span class="n">order</span> <span class="n">of</span> <span class="n">best</span> <span class="n">fit</span><span class="o">,</span> <span class="k">with</span> <span class="mi">0</span> <span class="n">being</span> <span class="n">the</span> <span class="n">best</span> <span class="n">fit</span> <span class="n">value</span> <span class="n">from</span> <span class="n">your</span> <span class="kd">set</span> <span class="n">of</span>
    <span class="n">estimations</span><span class="o">.</span> <span class="n">Can</span> <span class="n">be</span> <span class="n">either</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">or</span> <span class="n">list</span> <span class="n">of</span> <span class="n">integers</span> <span class="n">to</span> <span class="n">give</span> 
    <span class="n">the</span> <span class="n">option</span> <span class="n">of</span> <span class="n">conducting</span> <span class="n">multiple</span> <span class="n">profile</span> <span class="n">likelihoods</span> <span class="n">using</span> <span class="n">the</span> <span class="n">same</span> 
    <span class="n">line</span> <span class="n">of</span> <span class="n">code</span><span class="o">.</span> <span class="n">Use</span> <span class="n">Index</span><span class="o">=-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">calculate</span> <span class="n">profile</span> <span class="n">likelihood</span> 
    <span class="n">around</span> <span class="n">parameters</span> <span class="n">already</span> <span class="k">in</span> <span class="n">copasi</span><span class="o">.</span> <span class="n">If</span> <span class="n">Index</span> <span class="k">is</span> <span class="n">not</span> <span class="n">equal</span>
    <span class="n">to</span> <span class="o">-</span><span class="mi">1</span> <span class="n">you</span> <span class="n">must</span> <span class="n">specificy</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">argument</span> <span class="n">to</span> <span class="n">the</span> <span class="n">ParameterPath</span> 
    <span class="n">keyword</span> <span class="n">argument</span><span class="o">.</span> <span class="n">Default</span> <span class="k">is</span> <span class="o">-</span><span class="mi">1</span><span class="o">.</span>

<span class="n">OutputML</span><span class="o">:</span>
    <span class="n">When</span> <span class="n">Save</span> <span class="kd">set</span> <span class="n">to</span> <span class="s1">&#39;duplicate&#39;</span> <span class="k">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">file</span> <span class="n">name</span>
    <span class="n">of</span> <span class="n">the</span> <span class="n">output</span> <span class="n">cps</span> <span class="n">file</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span>

<span class="n">Save</span><span class="o">:</span>
    <span class="n">One</span> <span class="n">of</span><span class="o">,</span> <span class="s1">&#39;false&#39;</span><span class="o">,</span><span class="s1">&#39;overwrite&#39;</span> <span class="n">or</span> <span class="s1">&#39;duplicate&#39;</span>

<span class="n">UpperBoundMultiplier</span><span class="o">:</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">above</span> <span class="n">the</span> <span class="n">current</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">of</span> <span class="n">interest</span>
    <span class="n">to</span> <span class="n">extend</span> <span class="n">profile</span> <span class="n">likleihood</span> <span class="n">to</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">LowerBoundMultiplier</span><span class="o">:</span>
    <span class="n">Number</span> <span class="n">of</span> <span class="n">times</span> <span class="n">below</span> <span class="n">the</span> <span class="n">current</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">parameter</span> <span class="n">of</span> <span class="n">interest</span>
    <span class="n">to</span> <span class="n">extend</span> <span class="n">profile</span> <span class="n">likleihood</span> <span class="n">to</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mi">1000</span>

<span class="n">NumberOfSteps</span><span class="o">:</span>
    <span class="n">How</span> <span class="n">many</span> <span class="n">times</span> <span class="n">to</span> <span class="n">sample</span> <span class="n">between</span> <span class="n">lower</span> <span class="n">and</span> <span class="n">upper</span> <span class="n">boundaries</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mi">10</span>

<span class="n">Log</span><span class="o">:</span>
    <span class="n">Sample</span> <span class="k">in</span> <span class="n">Log</span> <span class="n">space</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;false&#39;</span>

<span class="n">IterationLimit</span><span class="o">:</span>
    <span class="n">Hook</span> <span class="n">and</span> <span class="n">Jeeves</span> <span class="n">algorithm</span> <span class="n">iteration</span> <span class="n">limit</span> <span class="n">parameter</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mi">50</span>

<span class="n">Tolerance</span><span class="o">:</span>
    <span class="n">Hook</span> <span class="n">and</span> <span class="n">Jeeves</span> <span class="n">algorithm</span> <span class="n">tolerance</span> <span class="n">parameter</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">5</span>

<span class="n">Rho</span><span class="o">:</span>
    <span class="n">Hook</span> <span class="n">and</span> <span class="n">Jeeves</span> <span class="n">algorithm</span> <span class="n">Rho</span> <span class="n">parameter</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="mf">0.2</span>

<span class="n">Run</span><span class="o">:</span>
    <span class="n">Either</span> <span class="o">[</span><span class="s1">&#39;false&#39;</span><span class="o">,</span><span class="s1">&#39;slow&#39;</span><span class="o">,</span><span class="s1">&#39;multiprocess&#39;</span><span class="o">,</span><span class="s1">&#39;SGE&#39;</span><span class="o">].</span> <span class="s1">&#39;multiprocess&#39;</span> 
    <span class="n">will</span> <span class="n">use</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">processes</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">NumProcesses</span> 
    <span class="n">keyword</span> <span class="n">argument</span> <span class="n">to</span> <span class="n">work</span><span class="o">.</span> <span class="n">This</span> <span class="n">features</span> <span class="n">doesn</span><span class="s1">&#39;t work well yet and</span>
<span class="s1">    user is reccommended to use slow mode which runs each </span>
<span class="s1">    copasi file in serial. &#39;</span><span class="n">SGE</span><span class="s1">&#39; mode can be used specifically</span>
<span class="s1">    on a SunGridEngine managed cluster. Deault=&#39;</span><span class="kc">false</span><span class="err">&#39;</span>

<span class="n">NumProcesses</span><span class="o">:</span>
    <span class="n">Deprecated</span><span class="o">:</span> <span class="k">do</span> <span class="n">not</span> <span class="n">use</span>
    <span class="n">How</span> <span class="n">many</span> <span class="n">processors</span> <span class="n">to</span> <span class="n">use</span> <span class="n">at</span> <span class="n">the</span> <span class="n">same</span> <span class="n">time</span><span class="o">.</span> <span class="n">NumProcesses</span><span class="o">=</span><span class="mi">0</span> <span class="n">will</span>
    <span class="n">prevent</span> <span class="n">running</span> <span class="n">the</span> <span class="n">estimations</span><span class="o">.</span> <span class="n">Default</span> <span class="mi">1</span>

<span class="n">SleepTime</span><span class="o">:</span> 
    <span class="n">Deprecated</span><span class="o">:</span> <span class="n">Do</span> <span class="n">not</span> <span class="n">use</span><span class="o">.</span> 
    <span class="n">How</span> <span class="n">many</span> <span class="n">seconds</span> <span class="n">to</span> <span class="n">wait</span> <span class="n">before</span> <span class="n">running</span> <span class="k">each</span> <span class="n">copasi</span> <span class="n">file</span><span class="o">.</span> <span class="n">If</span> <span class="n">running</span>
    <span class="n">too</span> <span class="n">many</span> <span class="n">parameter</span> <span class="n">estimations</span> <span class="n">at</span> <span class="n">the</span> <span class="n">same</span> <span class="n">time</span> <span class="n">will</span> <span class="n">slow</span> <span class="n">your</span> <span class="n">computer</span>
    <span class="n">considerably</span><span class="o">.</span> <span class="n">In</span> <span class="k">this</span> <span class="n">situation</span> <span class="n">use</span> <span class="n">a</span> <span class="n">longer</span> <span class="n">SleepTime</span><span class="o">.</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ProfileLikelihood</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class uses the profile likelihood method of identifiability analysis</span>
<span class="sd">    to assess whether parameters can be uniquely determined with the defined </span>
<span class="sd">    optimization problem. </span>
<span class="sd">    </span>
<span class="sd">    copasi_file:</span>
<span class="sd">        The copasi file you wish to conduct a profile likelihood on</span>
<span class="sd">        </span>
<span class="sd">    **kwargs:</span>
<span class="sd">        ParameterPath:</span>
<span class="sd">            The absolute path to either a parameter estimation results file </span>
<span class="sd">            (&#39;.txt&#39;,&#39;.xlsx&#39;,&#39;.xls&#39; or &#39;.csv&#39;) or a folder of parameter </span>
<span class="sd">            estimation results files. Default=None</span>
<span class="sd">            </span>
<span class="sd">        Index:</span>
<span class="sd">            The index of the parameter estimation run you want to calculate </span>
<span class="sd">            a profile likelihood around. Parameter estimations are ranked in</span>
<span class="sd">            order of best fit, with 0 being the best fit value from your set of</span>
<span class="sd">            estimations. Can be either an integer or list of integers to give </span>
<span class="sd">            the option of conducting multiple profile likelihoods using the same </span>
<span class="sd">            line of code. Use Index=-1 if you want to calculate profile likelihood </span>
<span class="sd">            around parameters already in copasi. If Index is not equal</span>
<span class="sd">            to -1 you must specificy a valid argument to the ParameterPath </span>
<span class="sd">            keyword argument. Default is -1. </span>
<span class="sd">    </span>
<span class="sd">        OutputML:</span>
<span class="sd">            When Save set to &#39;duplicate&#39; this is the file name</span>
<span class="sd">            of the output cps file. Default=&#39;overwrite&#39;</span>

<span class="sd">        Save:</span>
<span class="sd">            One of, &#39;false&#39;,&#39;overwrite&#39; or &#39;duplicate&#39;</span>
<span class="sd">            </span>
<span class="sd">        UpperBoundMultiplier:</span>
<span class="sd">            Number of times above the current value of the parameter of interest</span>
<span class="sd">            to extend profile likleihood to. Default=1000</span>
<span class="sd">        </span>
<span class="sd">        LowerBoundMultiplier:</span>
<span class="sd">            Number of times below the current value of the parameter of interest</span>
<span class="sd">            to extend profile likleihood to. Default=1000  </span>
<span class="sd">            </span>
<span class="sd">        NumberOfSteps:</span>
<span class="sd">            How many times to sample between lower and upper boundaries. Default=10</span>
<span class="sd">            </span>
<span class="sd">        Log:</span>
<span class="sd">            Sample in Log space. Default=&#39;false&#39;</span>
<span class="sd">            </span>
<span class="sd">        IterationLimit:</span>
<span class="sd">            Hook and Jeeves algorithm iteration limit parameter. Default=50</span>
<span class="sd">            </span>
<span class="sd">        Tolerance:</span>
<span class="sd">            Hook and Jeeves algorithm tolerance parameter. Default=1e-5</span>
<span class="sd">            </span>
<span class="sd">        Rho:</span>
<span class="sd">            Hook and Jeeves algorithm Rho parameter. Default=0.2</span>
<span class="sd">            </span>
<span class="sd">        Run:</span>
<span class="sd">            Either [&#39;false&#39;,&#39;slow&#39;,&#39;multiprocess&#39;,&#39;SGE&#39;]. &#39;multiprocess&#39; </span>
<span class="sd">            will use the number of processes specified in the NumProcesses </span>
<span class="sd">            keyword argument to work. This features doesn&#39;t work well yet and</span>
<span class="sd">            user is reccommended to use slow mode which runs each </span>
<span class="sd">            copasi file in serial. &#39;SGE&#39; mode can be used specifically</span>
<span class="sd">            on a SunGridEngine managed cluster. Deault=&#39;false&#39;</span>
<span class="sd">            </span>
<span class="sd">        NumProcesses:</span>
<span class="sd">            Deprecated: do not use</span>
<span class="sd">            How many processors to use at the same time. NumProcesses=0 will</span>
<span class="sd">            prevent running the estimations. Default 1</span>

<span class="sd">        SleepTime: </span>
<span class="sd">            Deprecated: Do not use. </span>
<span class="sd">            How many seconds to wait before running each copasi file. If running</span>
<span class="sd">            too many parameter estimations at the same time will slow your computer</span>
<span class="sd">            considerably. In this situation use a longer SleepTime.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>

        <span class="n">default_outputML</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Duplicate.cps&#39;</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
                 <span class="s1">&#39;OutputML&#39;</span><span class="p">:</span><span class="n">default_outputML</span><span class="p">,</span>
                 <span class="s1">&#39;Save&#39;</span><span class="p">:</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;ParameterPath&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;QuantityType&#39;</span><span class="p">:</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                 <span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
                 <span class="s1">&#39;Log&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;IterationLimit&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                 <span class="s1">&#39;Tolerance&#39;</span><span class="p">:</span><span class="mf">1e-5</span><span class="p">,</span>
                 <span class="s1">&#39;Rho&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="s1">&#39;Run&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#when runset to &#39;true&#39; determines, how many NumProcesses to use at the same time</span>
                 <span class="s1">&#39;SleepTime&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="c1">#How long to wait between running each copasi file</span>
                 <span class="s1">&#39;Verbose&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;MaxTime&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
                 

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for ProfileLikelihood&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>    
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">,</span><span class="s1">&#39;If you specify an index, you need to specify an argument to ParameterPath&#39;</span>
        
        <span class="c1">#if no index or ParameterPath specified, use current parameteres in cps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;current&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="c1">#if parameter path is file or folder set the self.mode variablee accordingly</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span>
        
        <span class="c1">#if ParameterPath specified without an index, set index to 0 (i.e. best parameter set)</span>
<span class="c1">#        if self.kwargs.get(&#39;ParameterPath&#39;)!=None and self.kwargs.get(&#39;Index&#39;) !=-1 and self.kwargs.get(&#39;Index&#39;)!=None:</span>
<span class="c1">#            self.kwargs[&#39;Index&#39;]=98</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_PE_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">),(</span><span class="nb">float</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;MaxTime argument should be float or int&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span> <span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),(</span><span class="nb">list</span><span class="p">,</span><span class="nb">int</span><span class="p">)),</span><span class="s1">&#39;index must be an integer or a list of integers&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">int</span><span class="p">),</span><span class="s1">&#39;Index is int type&#39;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">i</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;PE data contains {} parameter estimations. You have indicated that you want to use run {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;No data&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;PE data contains {} parameter estimations. You have indicated that you want to use run {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">==</span><span class="p">{}:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your copasi file doesnt have a parameter estimation defined&#39;</span><span class="p">)</span>
        <span class="c1">#convert some numeric input variables to string</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Rho&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Rho&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span><span class="s1">&#39;multiprocess&#39;</span><span class="p">,</span><span class="s1">&#39;SGE&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">Run</span><span class="se">\&#39;</span><span class="s1"> keyword must be one of </span><span class="se">\&#39;</span><span class="s1">slow</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1">multiprocess</span><span class="se">\&#39;</span><span class="s1">, or </span><span class="se">\&#39;</span><span class="s1">SGE</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SleepTime&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        
        
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;particle_number&#39;</span><span class="p">]</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;You have selected {} processes but your computer only has {} available&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
        
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
<span class="c1">#        if self.kwargs.get(&#39;Log&#39;)==&#39;false&#39;:</span>
<span class="c1">#            self.kwargs[&#39;Log&#39;]=str(0)</span>
<span class="c1">#        else:</span>
<span class="c1">#            self.kwargs[&#39;Log&#39;]=str(1)</span>

        
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy_copasi_files_and_insert_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copy_data_files</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_report</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_scan</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_PE_task</span><span class="p">()</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;duplicate&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputML&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;overwrite&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span>

                
    <span class="k">def</span> <span class="nf">read_PE_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        if self.mode=&#39;current&#39; do nothing</span>
<span class="sd">        if self.mode = file read from file</span>
<span class="sd">        if self.mode = folder read from folder</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;current&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="nf">copy_copasi_files_and_insert_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Its easier to do these two functions together</span>
<span class="sd">        1) create relevant folders and copy copasi file into these based on the Index parameter</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">cps_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">estimated_parameters</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
<span class="c1">#            os.chdir(&#39;..&#39;)</span>
<span class="c1">#            os.chdir(&#39;..&#39;)</span>
            <span class="k">return</span> <span class="n">cps_dct</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span>
            <span class="n">IP</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span>
                                          <span class="n">Index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span>
                                          <span class="n">QuantityType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">),</span>
                                          <span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
            <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cps_dct</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="n">IP</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span>
                                          <span class="n">Index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                          <span class="n">QuantityType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">),</span><span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>

                <span class="n">IA_dir2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                    <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>

                    <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                    <span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                    <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">cps_dct</span>

    <span class="k">def</span> <span class="nf">copy_data_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Move parameter estimation data from the directory with the parent cps</span>
<span class="sd">        file in to each relevant ProfileLikelihood sub folder. </span>
<span class="sd">        </span>
<span class="sd">        Note that you must have your data files int the same directory as the </span>
<span class="sd">        cps file you want to perform profile likeliood on. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
        <span class="n">q</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;File Name&quot;]&#39;</span>
        <span class="n">data_file_dct</span><span class="o">=</span><span class="p">{}</span>
<span class="c1">#        print self.copasi_file</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
            <span class="n">data_path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
            <span class="n">data_file_dct</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">data_path</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">IA_dir1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
                <span class="n">new_data_file1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir1</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file1</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
                <span class="n">IA_dir2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
                <span class="n">new_data_file2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file2</span><span class="p">)</span>
                
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                    <span class="n">IA_dir3</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
                    <span class="n">new_data_file3</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir3</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                    <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data_file_dct</span>

    <span class="k">def</span> <span class="nf">setup_PE_task</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        remove parameter of interest from parameter estimation task</span>
<span class="sd">        and change method parameters </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">method_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Hooke &amp;amp; Jeeves&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;HookeJeeves&#39;</span><span class="p">}</span>
        <span class="n">IterationLimit</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;unsignedInteger&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Iteration Limit&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">)}</span>
        <span class="n">Tolerance</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tolerance&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">)}</span>
        <span class="n">Rho</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Rho&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Rho&#39;</span><span class="p">)}</span>

        <span class="n">method_element</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;Method&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">method_params</span><span class="p">)</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">IterationLimit</span><span class="p">)</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">Tolerance</span><span class="p">)</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">Rho</span><span class="p">)</span>
            
            
        <span class="n">query</span><span class="o">=</span><span class="s2">&quot;//*[@name=&#39;FitItem&#39;]&quot;</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">C</span><span class="o">=</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="n">childML</span><span class="o">=</span><span class="n">C</span><span class="o">.</span><span class="n">copasiML</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">childML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ObjectCN&#39;</span><span class="p">:</span>
                            <span class="c1">#metabolites first</span>
                            <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Metabolites\[{}\]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span><span class="p">[]:</span>
                                <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> 
                            
                            <span class="c1">#globals</span>
                            <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Values\[{}\]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span><span class="p">[]:</span>
                                <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> 
                                
                            <span class="c1">#locals</span>
                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                                <span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                                <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                                <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Reactions\[{}\].*Parameter={},&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                                <span class="k">if</span> <span class="n">match</span><span class="o">!=</span><span class="p">[]:</span>
                                    <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                    <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
                <span class="n">tasks</span><span class="o">=</span><span class="n">childML</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;{http://www.copasi.org/static/schema}ListOfTasks&#39;</span><span class="p">)</span>
                <span class="n">method</span><span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">parent</span><span class="o">=</span><span class="n">method</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">method_element</span><span class="p">)</span>
                
                <span class="c1">#turn off the randomize start values button (also turns off the corresponding for optimization task!)</span>
                <span class="n">q</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;Randomize Start Values&quot;]&#39;</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">childML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
                    <span class="n">k</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
                <span class="n">C</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">childML</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
        
    <span class="k">def</span> <span class="nf">setup_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">pycopi</span><span class="o">.</span><span class="n">Reports</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">ReportType</span><span class="o">=</span><span class="s1">&#39;profilelikelihood&#39;</span><span class="p">,</span>
                               <span class="n">ReportName</span><span class="o">=</span><span class="n">st</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span><span class="n">Variable</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
        
    <span class="k">def</span> <span class="nf">setup_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">GMQ_child</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span> 
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> 
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;particle_number&#39;</span><span class="p">:</span>
                    <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>  
                <span class="n">lb</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">variable_value</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">))</span>
                <span class="n">ub</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">variable_value</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">))</span>
                
                <span class="n">pycopi</span><span class="o">.</span><span class="n">Scan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span>
                                     <span class="n">Variable</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
                                     <span class="n">ReportName</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span>
                                     <span class="n">ReportType</span><span class="o">=</span><span class="s1">&#39;profilelikelihood&#39;</span><span class="p">,</span>
                                     <span class="n">SubTask</span><span class="o">=</span><span class="s1">&#39;parameter_estimation&#39;</span><span class="p">,</span>
                                     <span class="n">ScanType</span><span class="o">=</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span>
                                     <span class="n">OutputInSubtask</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                                     <span class="n">AdjustInitialConditions</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                                     <span class="n">NumberOfSteps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">),</span>
                                     <span class="n">Maximum</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span>
                                     <span class="n">Minimum</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span>
                                     <span class="n">Log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">),</span>
                                     <span class="n">Scheduled</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                                     <span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                                     <span class="n">ClearScans</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
        
    <span class="k">def</span> <span class="nf">run_slow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Run using one process, separately, one after another</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<span class="c1">#                args=[&#39;CopasiSE&#39;,self.cps_dct[i][j]]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Verbose&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s1">&#39;running {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">res</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">Task</span><span class="o">=</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span><span class="n">MaxTime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">output</span>
        <span class="k">return</span> <span class="n">res</span>

<span class="c1">#    def run_fast(self):</span>
<span class="c1">#        &#39;&#39;&#39;</span>
<span class="c1">#        self.cps_dct is a nested dictionary dct[index1][index2]=filename</span>
<span class="c1">#        CopasiSE is a program for simulating mathematical models using the terminal/cmd</span>
<span class="c1">#        </span>
<span class="c1">#        &#39;&#39;&#39;</span>
<span class="c1">#        for i in self.cps_dct.keys():</span>
<span class="c1">#            for j in self.cps_dct[i]:</span>
<span class="c1">#                subprocess.Popen(&#39;CopasiSE {}&#39;.format(self.cps_dct[i][j]))</span>
<span class="c1">#        return self.cps_dct</span>
        
    <span class="k">def</span> <span class="nf">multi_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s1">&#39;CopasiSE &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pool</span><span class="o">=</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">process_iter</span><span class="p">()]</span>
                    <span class="n">count</span><span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="s1">&#39;CopasiSE.exe&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">count</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">):</span>
                        <span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SleepTime&#39;</span><span class="p">))</span>
                    <span class="n">pool</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
            <span class="k">return</span> <span class="bp">True</span>
                
    <span class="k">def</span> <span class="nf">run_SGE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">#$ -V -cwd</span><span class="se">\n</span><span class="s1">module addapps/COPASI/4.16.104-Linux-64bit</span><span class="se">\n</span><span class="s1">CopasiSE &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;qsub {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">))</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">)</span>         
        <span class="k">return</span> <span class="bp">True</span>
                
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;multiprocess&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">multi_run</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;slow&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_slow</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;SGE&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">run_SGE</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pydentify2.ProfileLikelihood">ProfileLikelihood</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.CParser" class="name">var <span class="ident">CParser</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.GMQ" class="name">var <span class="ident">GMQ</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.PE_data" class="name">var <span class="ident">PE_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.copasiML" class="name">var <span class="ident">copasiML</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.copasi_file" class="name">var <span class="ident">copasi_file</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.cps_dct" class="name">var <span class="ident">cps_dct</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pydentify2.ProfileLikelihood.mode" class="name">var <span class="ident">mode</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, copasi_file, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
    <span class="n">default_outputML</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Duplicate.cps&#39;</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
             <span class="s1">&#39;OutputML&#39;</span><span class="p">:</span><span class="n">default_outputML</span><span class="p">,</span>
             <span class="s1">&#39;Save&#39;</span><span class="p">:</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="s1">&#39;ParameterPath&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;QuantityType&#39;</span><span class="p">:</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span>
             <span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
             <span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
             <span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
             <span class="s1">&#39;Log&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;IterationLimit&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
             <span class="s1">&#39;Tolerance&#39;</span><span class="p">:</span><span class="mf">1e-5</span><span class="p">,</span>
             <span class="s1">&#39;Rho&#39;</span><span class="p">:</span><span class="mf">0.2</span><span class="p">,</span>
             <span class="s1">&#39;Run&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;NumProcesses&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="c1">#when runset to &#39;true&#39; determines, how many NumProcesses to use at the same time</span>
             <span class="s1">&#39;SleepTime&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="c1">#How long to wait between running each copasi file</span>
             <span class="s1">&#39;Verbose&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="s1">&#39;MaxTime&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>
             
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for ProfileLikelihood&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>    
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">,</span><span class="s1">&#39;If you specify an index, you need to specify an argument to ParameterPath&#39;</span>
    
    <span class="c1">#if no index or ParameterPath specified, use current parameteres in cps</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;current&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="c1">#if parameter path is file or folder set the self.mode variablee accordingly</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span>
    
    <span class="c1">#if ParameterPath specified without an index, set index to 0 (i.e. best parameter set)</span>
     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span> <span class="o">!=-</span><span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Index&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">98</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_PE_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">),(</span><span class="nb">float</span><span class="p">,</span><span class="nb">int</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;MaxTime argument should be float or int&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span> <span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),(</span><span class="nb">list</span><span class="p">,</span><span class="nb">int</span><span class="p">)),</span><span class="s1">&#39;index must be an integer or a list of integers&#39;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nb">int</span><span class="p">),</span><span class="s1">&#39;Index is int type&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">i</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;PE data contains {} parameter estimations. You have indicated that you want to use run {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;No data&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;PE data contains {} parameter estimations. You have indicated that you want to use run {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">==</span><span class="p">{}:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your copasi file doesnt have a parameter estimation defined&#39;</span><span class="p">)</span>
    <span class="c1">#convert some numeric input variables to string</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Rho&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Rho&#39;</span><span class="p">])</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;slow&#39;</span><span class="p">,</span><span class="s1">&#39;multiprocess&#39;</span><span class="p">,</span><span class="s1">&#39;SGE&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\&#39;</span><span class="s1">Run</span><span class="se">\&#39;</span><span class="s1"> keyword must be one of </span><span class="se">\&#39;</span><span class="s1">slow</span><span class="se">\&#39;</span><span class="s1">, </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\&#39;</span><span class="s1">multiprocess</span><span class="se">\&#39;</span><span class="s1">, or </span><span class="se">\&#39;</span><span class="s1">SGE</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SleepTime&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    
    
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">,</span><span class="s1">&#39;particle_number&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">&gt;</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;You have selected {} processes but your computer only has {} available&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">),</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()))</span>
    
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
     <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
     <span class="k">else</span><span class="p">:</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">copy_copasi_files_and_insert_parameters</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copy_data_files</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setup_report</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_scan</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setup_PE_task</span><span class="p">()</span>        
    <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.copy_copasi_files_and_insert_parameters">
    <p>def <span class="ident">copy_copasi_files_and_insert_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Its easier to do these two functions together
1) create relevant folders and copy copasi file into these based on the Index parameter</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.copy_copasi_files_and_insert_parameters', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.copy_copasi_files_and_insert_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">copy_copasi_files_and_insert_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Its easier to do these two functions together</span>
<span class="sd">    1) create relevant folders and copy copasi file into these based on the Index parameter</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">cps_dct</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">estimated_parameters</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_fit_items</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
        <span class="n">cps_dct</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
            <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cps_dct</span>
        
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">!=-</span><span class="mi">1</span>
        <span class="n">IP</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span>
                                      <span class="n">Index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span>
                                      <span class="n">QuantityType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">),</span>
                                      <span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
        <span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
        <span class="n">cps_dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)]</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
            <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cps_dct</span>
        
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
            <span class="n">IP</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span>
                                      <span class="n">Index</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
                                      <span class="n">QuantityType</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">),</span><span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_data</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
            <span class="n">IA_dir2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">estimated_parameters</span><span class="p">:</span>
                <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">,</span><span class="s1">&#39;{}.cps&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">st</span><span class="p">))</span>
                <span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">filename</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cps_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.copy_data_files">
    <p>def <span class="ident">copy_data_files</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Move parameter estimation data from the directory with the parent cps
file in to each relevant ProfileLikelihood sub folder. </p>
<p>Note that you must have your data files int the same directory as the 
cps file you want to perform profile likeliood on.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.copy_data_files', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.copy_data_files" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">copy_data_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Move parameter estimation data from the directory with the parent cps</span>
<span class="sd">    file in to each relevant ProfileLikelihood sub folder. </span>
<span class="sd">    </span>
<span class="sd">    Note that you must have your data files int the same directory as the </span>
<span class="sd">    cps file you want to perform profile likeliood on. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ProfileLikelihood&#39;</span><span class="p">)</span>
    <span class="n">q</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;File Name&quot;]&#39;</span>
    <span class="n">data_file_dct</span><span class="o">=</span><span class="p">{}</span>
     <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
        <span class="n">data_path</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
        <span class="n">data_file_dct</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">data_path</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">IA_dir1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="s1">&#39;-1&#39;</span><span class="p">)</span>
            <span class="n">new_data_file1</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir1</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
            <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file1</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">):</span>
            <span class="n">IA_dir2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)))</span>
            <span class="n">new_data_file2</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir2</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
            <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file2</span><span class="p">)</span>
            
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">):</span>
                <span class="n">IA_dir3</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IA_dir</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
                <span class="n">new_data_file3</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IA_dir3</span><span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                <span class="n">copyfile</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span><span class="n">new_data_file3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data_file_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.multi_run">
    <p>def <span class="ident">multi_run</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.multi_run', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.multi_run" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">multi_run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="s1">&#39;CopasiSE &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pool</span><span class="o">=</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">p</span><span class="o">=</span><span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">process_iter</span><span class="p">()]</span>
                <span class="n">count</span><span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="s1">&#39;CopasiSE.exe&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">count</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumProcesses&#39;</span><span class="p">):</span>
                    <span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SleepTime&#39;</span><span class="p">))</span>
                <span class="n">pool</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.read_PE_data">
    <p>def <span class="ident">read_PE_data</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>if self.mode='current' do nothing
if self.mode = file read from file
if self.mode = folder read from folder</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.read_PE_data', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.read_PE_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_PE_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    if self.mode=&#39;current&#39; do nothing</span>
<span class="sd">    if self.mode = file read from file</span>
<span class="sd">    if self.mode = folder read from folder</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;current&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PEAnalysis</span><span class="o">.</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ParameterPath&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.run">
    <p>def <span class="ident">run</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.run', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.run" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;multiprocess&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multi_run</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;slow&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_slow</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Run&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;SGE&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_SGE</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.run_SGE">
    <p>def <span class="ident">run_SGE</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.run_SGE', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.run_SGE" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">run_SGE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#!/bin/bash</span><span class="se">\n</span><span class="s1">#$ -V -cwd</span><span class="se">\n</span><span class="s1">module addapps/COPASI/4.16.104-Linux-64bit</span><span class="se">\n</span><span class="s1">CopasiSE &quot;{}&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;qsub {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">))</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;run_script.sh&#39;</span><span class="p">)</span>         
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.run_slow">
    <p>def <span class="ident">run_slow</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Run using one process, separately, one after another</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.run_slow', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.run_slow" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">run_slow</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Run using one process, separately, one after another</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">res</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
             <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CopasiSE&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Verbose&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="k">print</span> <span class="s1">&#39;running {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="n">res</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">Run</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">Task</span><span class="o">=</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span><span class="n">MaxTime</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MaxTime&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">output</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.save">
    <p>def <span class="ident">save</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.save', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.save" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;duplicate&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputML&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Save&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;overwrite&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.setup_PE_task">
    <p>def <span class="ident">setup_PE_task</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>remove parameter of interest from parameter estimation task
and change method parameters</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.setup_PE_task', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.setup_PE_task" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">setup_PE_task</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    remove parameter of interest from parameter estimation task</span>
<span class="sd">    and change method parameters </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">method_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;Hooke &amp;amp; Jeeves&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span><span class="s1">&#39;HookeJeeves&#39;</span><span class="p">}</span>
    <span class="n">IterationLimit</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;unsignedInteger&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Iteration Limit&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IterationLimit&#39;</span><span class="p">)}</span>
    <span class="n">Tolerance</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tolerance&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Tolerance&#39;</span><span class="p">)}</span>
    <span class="n">Rho</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;float&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Rho&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Rho&#39;</span><span class="p">)}</span>
    <span class="n">method_element</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="s1">&#39;Method&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">method_params</span><span class="p">)</span>
    <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">IterationLimit</span><span class="p">)</span>
    <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">Tolerance</span><span class="p">)</span>
    <span class="n">pycopi</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">SubElement</span><span class="p">(</span><span class="n">method_element</span><span class="p">,</span><span class="s1">&#39;Parameter&#39;</span><span class="p">,</span><span class="n">attrib</span><span class="o">=</span><span class="n">Rho</span><span class="p">)</span>
        
        
    <span class="n">query</span><span class="o">=</span><span class="s2">&quot;//*[@name=&#39;FitItem&#39;]&quot;</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">C</span><span class="o">=</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
            <span class="n">childML</span><span class="o">=</span><span class="n">C</span><span class="o">.</span><span class="n">copasiML</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">childML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ObjectCN&#39;</span><span class="p">:</span>
                        <span class="c1">#metabolites first</span>
                        <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Metabolites\[{}\]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span><span class="p">[]:</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                            <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> 
                        
                        <span class="c1">#globals</span>
                        <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Values\[{}\]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">match</span> <span class="o">!=</span><span class="p">[]:</span>
                            <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                            <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span> 
                            
                        <span class="c1">#locals</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span> <span class="n">j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                            <span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                            <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">match</span><span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;Reactions\[{}\].*Parameter={},&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">v</span><span class="p">),</span><span class="n">l</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
                            <span class="k">if</span> <span class="n">match</span><span class="o">!=</span><span class="p">[]:</span>
                                <span class="n">parent</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
                                <span class="n">parent</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
            <span class="n">tasks</span><span class="o">=</span><span class="n">childML</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;{http://www.copasi.org/static/schema}ListOfTasks&#39;</span><span class="p">)</span>
            <span class="n">method</span><span class="o">=</span> <span class="n">tasks</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">parent</span><span class="o">=</span><span class="n">method</span><span class="o">.</span><span class="n">getparent</span><span class="p">()</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
            <span class="n">parent</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">method_element</span><span class="p">)</span>
            
            <span class="c1">#turn off the randomize start values button (also turns off the corresponding for optimization task!)</span>
            <span class="n">q</span><span class="o">=</span><span class="s1">&#39;//*[@name=&quot;Randomize Start Values&quot;]&#39;</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">childML</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
                <span class="n">k</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
            <span class="n">C</span><span class="o">.</span><span class="n">write_copasi_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">childML</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.setup_report">
    <p>def <span class="ident">setup_report</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.setup_report', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.setup_report" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">setup_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">st</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span>
            <span class="n">pycopi</span><span class="o">.</span><span class="n">Reports</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">ReportType</span><span class="o">=</span><span class="s1">&#39;profilelikelihood&#39;</span><span class="p">,</span>
                           <span class="n">ReportName</span><span class="o">=</span><span class="n">st</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span><span class="n">Variable</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pydentify2.ProfileLikelihood.setup_scan">
    <p>def <span class="ident">setup_scan</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pydentify2.ProfileLikelihood.setup_scan', this);">Show source &equiv;</a></p>
  <div id="source-pydentify2.ProfileLikelihood.setup_scan" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">setup_scan</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">GMQ_child</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;concentration&#39;</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span> 
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> 
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;QuantityType&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;particle_number&#39;</span><span class="p">:</span>
                <span class="n">variable_value</span><span class="o">=</span> <span class="n">GMQ_child</span><span class="o">.</span><span class="n">get_all_model_variables</span><span class="p">()[</span><span class="n">j</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>  
            <span class="n">lb</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">variable_value</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LowerBoundMultiplier&#39;</span><span class="p">))</span>
            <span class="n">ub</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">variable_value</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UpperBoundMultiplier&#39;</span><span class="p">))</span>
            
            <span class="n">pycopi</span><span class="o">.</span><span class="n">Scan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span>
                                 <span class="n">Variable</span><span class="o">=</span><span class="n">j</span><span class="p">,</span>
                                 <span class="n">ReportName</span><span class="o">=</span><span class="n">Misc</span><span class="o">.</span><span class="n">RemoveNonAscii</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="o">+</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span>
                                 <span class="n">ReportType</span><span class="o">=</span><span class="s1">&#39;profilelikelihood&#39;</span><span class="p">,</span>
                                 <span class="n">SubTask</span><span class="o">=</span><span class="s1">&#39;parameter_estimation&#39;</span><span class="p">,</span>
                                 <span class="n">ScanType</span><span class="o">=</span><span class="s1">&#39;scan&#39;</span><span class="p">,</span>
                                 <span class="n">OutputInSubtask</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                                 <span class="n">AdjustInitialConditions</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                                 <span class="n">NumberOfSteps</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumberOfSteps&#39;</span><span class="p">),</span>
                                 <span class="n">Maximum</span><span class="o">=</span><span class="n">ub</span><span class="p">,</span>
                                 <span class="n">Minimum</span><span class="o">=</span><span class="n">lb</span><span class="p">,</span>
                                 <span class="n">Log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log&#39;</span><span class="p">),</span>
                                 <span class="n">Scheduled</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                                 <span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                                 <span class="n">ClearScans</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cps_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>