<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>PEAnalysis API documentation</title>
    <meta name="description" content="This file is part of PyCoTools.

PyCoTools is free software: you can redistribute it and/or modify
i..." />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">


    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.EvaluateOptimizationPerformance">EvaluateOptimizationPerformance</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.EvaluateOptimizationPerformance.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.EvaluateOptimizationPerformance.plot_rss">plot_rss</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.GetCovarianceMatrix">GetCovarianceMatrix</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.GetCovarianceMatrix.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.GetCovarianceMatrix.get_covariance">get_covariance</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.ParsePEData">ParsePEData</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.filter_constants">filter_constants</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.log10_conversion">log10_conversion</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.read_data">read_data</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.read_file">read_file</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.read_folder">read_folder</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.read_pickle">read_pickle</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.remove_infinite_RSS">remove_infinite_RSS</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.rename_RSS">rename_RSS</a></li>
    <li class="mono"><a href="#PEAnalysis.ParsePEData.sort_data">sort_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotBoxplot">PlotBoxplot</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotBoxplot.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotBoxplot.boxplot">boxplot</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotBoxplot.divide_data">divide_data</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotBoxplot.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotBoxplot.truncate_data">truncate_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotHeatMap">PlotHeatMap</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotHeatMap.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHeatMap.divide_data">divide_data</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHeatMap.get_variance">get_variance</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHeatMap.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHeatMap.truncate_data">truncate_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotHexMap">PlotHexMap</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.binomial_coefficient">binomial_coefficient</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.get_combinations">get_combinations</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.plot1_hex">plot1_hex</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.plot_hex_maps">plot_hex_maps</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHexMap.truncate_data">truncate_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotHistogram">PlotHistogram</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram.plot1">plot1</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram.plot_all">plot_all</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram.truncate_data">truncate_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotHistogram3D">PlotHistogram3D</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram3D.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram3D.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram3D.plot1">plot1</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotHistogram3D.truncate_data">truncate_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotPEData">PlotPEData</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.change_directory">change_directory</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.get_experiment_times">get_experiment_times</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.insert_parameters">insert_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.parse_experimental_files">parse_experimental_files</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.parse_parameters">parse_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.plot">plot</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.plot1">plot1</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.plot1file">plot1file</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotPEData.simulate_time_course">simulate_time_course</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.PlotScatters">PlotScatters</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.binomial_coefficient">binomial_coefficient</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.get_combinations">get_combinations</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.list_parameters">list_parameters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.plot1_scatter">plot1_scatter</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.plot_scatters">plot_scatters</a></li>
    <li class="mono"><a href="#PEAnalysis.PlotScatters.truncate_data">truncate_data</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.TruncateData">TruncateData</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.TruncateData.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.TruncateData.below_x">below_x</a></li>
    <li class="mono"><a href="#PEAnalysis.TruncateData.top_x_percent">top_x_percent</a></li>
    <li class="mono"><a href="#PEAnalysis.TruncateData.truncate">truncate</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#PEAnalysis.WritePEData">WritePEData</a></span>
        
          
  <ul>
    <li class="mono"><a href="#PEAnalysis.WritePEData.__init__">__init__</a></li>
    <li class="mono"><a href="#PEAnalysis.WritePEData.prune_headers">prune_headers</a></li>
    <li class="mono"><a href="#PEAnalysis.WritePEData.write_to_xlsx">write_to_xlsx</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">PEAnalysis</span> module</h1>
  <p>This file is part of PyCoTools.</p>
<p>PyCoTools is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>PyCoTools is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.</p>
<p>You should have received a copy of the GNU Lesser General Public License
along with PyCoTools.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<p>Object:</p>
<p>PEAnalysis provies a number of convenient classes for visualizing 
and analysing parameter estimation data. The module can be used with 
any PE data regardless of origin but has been developed with copasi in 
mind. </p>
<p>$Author: Ciaran Welsh
$Date: 12-09-2016 
Time:  20:33</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd"> This file is part of PyCoTools.</span>

<span class="sd"> PyCoTools is free software: you can redistribute it and/or modify</span>
<span class="sd"> it under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd"> the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd"> (at your option) any later version.</span>

<span class="sd"> PyCoTools is distributed in the hope that it will be useful,</span>
<span class="sd"> but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd"> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd"> GNU Lesser General Public License for more details.</span>

<span class="sd"> You should have received a copy of the GNU Lesser General Public License</span>
<span class="sd"> along with PyCoTools.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>




<span class="sd"> Object:</span>
<span class="sd"> </span>
<span class="sd"> PEAnalysis provies a number of convenient classes for visualizing </span>
<span class="sd"> and analysing parameter estimation data. The module can be used with </span>
<span class="sd"> any PE data regardless of origin but has been developed with copasi in </span>
<span class="sd"> mind. </span>
<span class="sd">  </span>


<span class="sd"> $Author: Ciaran Welsh</span>
<span class="sd"> $Date: 12-09-2016 </span>
<span class="sd"> Time:  20:33</span>


<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">pandas</span> 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span> 
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">wrap</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">unittest</span>
<span class="kn">import</span> <span class="nn">pycopi</span><span class="o">,</span><span class="nn">Errors</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="c1">#import math</span>


<span class="k">class</span> <span class="nc">ParsePEData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    parse parameter estimation data from file</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        results_path: </span>
<span class="sd">            Absolute path to file or folder of files containing parameter</span>
<span class="sd">            estimation data. </span>
<span class="sd">            </span>
<span class="sd">    kwargs:</span>
<span class="sd">        UsePickle:</span>
<span class="sd">            Allow one to overwrite the pickle file automatically</span>
<span class="sd">            produced for speed. Default=&#39;false&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="n">UsePickle</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="n">OverwritePickle</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="n">PicklePath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1">#input argument variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span> <span class="c1">#either file or folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="n">RemoveInfiniteRSS</span>
        <span class="c1">#assertions</span>
<span class="c1">#        assert os.path.isfile(self.copasi_file),&#39;{} is not a real file&#39;.format(self.copasi_file)</span>
        <span class="c1">#change directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">=</span><span class="n">PicklePath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;PEData.pickle&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path_log</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;PEData_log.pickle&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path_log</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">),</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_log.pickle&#39;</span><span class="p">)</span>
<span class="c1">#        self.FromPickle=True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">=</span><span class="n">UsePickle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">=</span><span class="n">OverwritePickle</span>
        
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;{} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;folder&#39;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument UsePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument OverwritePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument OverwritePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;DataFrame is empty. Your PE data has not been read.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rename_RSS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1">#        self.data=self.prune_headers()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_constants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_infinite_RSS</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">prune</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log10_conversion</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Could not convert to log10 scale. Chances are this is because you have infinite RSS values in your parameter estimation data. Try changing the optimization settings&#39;</span><span class="p">)</span>
            



    <span class="k">def</span> <span class="nf">remove_infinite_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="s1">&#39;1.#INF&#39;</span> <span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span><span class="s1">&#39;Your PE data contains infinite RSS values. These data will be removed&#39;&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="s1">&#39;true&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1.#INF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        
        
    <span class="k">def</span> <span class="nf">filter_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">df</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span> 
        
    <span class="k">def</span> <span class="nf">read_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        read folder of tab separated csv files i.e. the output from copasi</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;{} is not a real directory&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="n">df_list</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
            <span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">=</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">rename_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        change the RSS from copasi output to RSS</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">b</span><span class="o">=</span><span class="s1">&#39;TaskList[Parameter Estimation].(Problem)Parameter Estimation.Best Value&#39;</span>
        <span class="k">if</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">b</span><span class="p">:</span><span class="s1">&#39;RSS&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">data</span>

        
    <span class="k">def</span> <span class="nf">sort_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        sort data in order of increasing RSS</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

        
    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="s1">&#39;mode not file&#39;</span>
        <span class="n">_</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.xls&#39;</span><span class="p">,</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span><span class="s1">&#39;.pickle&#39;</span><span class="p">],</span><span class="s1">&#39;parameter file is not .pickle, .txt, .xlsx, .xls, .csv&#39;</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;xlsx&#39;</span> <span class="ow">or</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;xls&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.csv&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.pickle&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Pickle path does not exist&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
 

    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Read data. The self.for_testing variable only exists for</span>
<span class="sd">        sign posting the tests for this class</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_file</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;folder&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_folder</span><span class="p">()</span>
                
                
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_false&#39;</span>
            <span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="p">()</span>
            <span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_true_overwrite_false&#39;</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">()</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_true_overwrite_true&#39;</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span>
                <span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="p">()</span>
                <span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">data</span> 

    <span class="k">def</span> <span class="nf">log10_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="c1">#==============================================================================</span>

<span class="k">class</span> <span class="nc">WritePEData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Write the sorted parameter estimation data as a flat xlsx file</span>
<span class="sd">    Args</span>
<span class="sd">        results_path:</span>
<span class="sd">            The path to the results file or folder of files with parameter</span>
<span class="sd">            estimation data in</span>
<span class="sd">    **kwargs </span>
<span class="sd">        Log10:</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">Log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;PE_Data_log.xlsx&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;PE_Data.xlsx&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prune_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_to_xlsx</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">prune_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">df</span>
    
    <span class="k">def</span> <span class="nf">write_to_xlsx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
    
<span class="c1">#==============================================================================    </span>
<span class="k">class</span> <span class="nc">TruncateData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parameter estimation data in systems biology usually have runs which fall</span>
<span class="sd">    into a local minima. Usually a user wants to remove these runs from further </span>
<span class="sd">    analysis. TruncateData does this and provides two modes to do so. A useful </span>
<span class="sd">    indication of where to truncate the data is to look at the plot produced</span>
<span class="sd">    by the EvaluateOptimizationPerformance class and the histograms/boxplots/</span>
<span class="sd">    profile likelihoods for your specific optimization problem. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        data:</span>
<span class="sd">            The parameter estiamtion data for truncation. This is a pandas dataframe. </span>
<span class="sd">            </span>
<span class="sd">    kwargs:</span>
<span class="sd">        TruncateMode:</span>
<span class="sd">            Two modes accepted. When set to &#39;percent&#39; take Xth percentile of </span>
<span class="sd">            data. when set to &#39;below_x&#39;, truncate data below the value X. Pay</span>
<span class="sd">            attention to whether you are in Log10 mode or not. </span>
<span class="sd">            </span>
<span class="sd">        X:</span>
<span class="sd">            Either Xth percentive or value to truncate data below. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">=</span><span class="n">TruncateMode</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">=</span><span class="n">X</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">below_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;There are no data with RSS below {}. Choose a higher number&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">]</span>
        
            
    <span class="k">def</span> <span class="nf">top_x_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        get top X percent data. </span>
<span class="sd">        Defulat= 100 = all data</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">&gt;</span><span class="mi">100</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} should be between 0 and 100&#39;</span><span class="p">)</span>
        <span class="n">x_quantile</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">x_quantile</span><span class="p">]</span>
            
    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">==</span><span class="s1">&#39;below_x&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">below_x</span><span class="p">()</span><span class="c1">#self.data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">==</span><span class="s1">&#39;percent&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_x_percent</span><span class="p">()</span>
        

<span class="c1">#==============================================================================</span>
<span class="k">class</span> <span class="nc">PlotHistogram</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot parameter estimation results as histogram</span>
<span class="sd">    Args:</span>
<span class="sd">        results_path:</span>
<span class="sd">            Path to file or folder of files containing parameter estimation data</span>
<span class="sd">            to plot</span>
<span class="sd">    **kwargs:</span>
<span class="sd">         TruncateMode:</span>
<span class="sd">             &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
<span class="sd">         Log10:</span>
<span class="sd">             &#39;false&#39;,</span>
<span class="sd">         X:</span>
<span class="sd">             100,           #if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
<span class="sd">    **kwargs which correspond to matplotlib.pyplot.hist keyword arguments. </span>
<span class="sd">    More information about these can be found in the matplotlib documentation </span>
<span class="sd">         Bins:</span>
<span class="sd">             Number of bins to use. Default=100,</span>
<span class="sd">         AxisSize:</span>
<span class="sd">             Font size for the axis. Default=15</span>
<span class="sd">         FontSize:</span>
<span class="sd">             Font size for the graph labels. Default=22</span>
<span class="sd">         Normed:</span>
<span class="sd">             &#39;true&#39; or &#39;false. Whether to make the plot integrate to 1. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         Color:</span>
<span class="sd">             Plot colour. Default=&#39;red&#39;,     </span>
<span class="sd">         XRotation:</span>
<span class="sd">             25,   #rotation for X tick axis</span>
<span class="sd">         TitleWrapSize:</span>
<span class="sd">             Number of characters to use before word wrapping the title. Default=35  </span>
<span class="sd">         Orientation:</span>
<span class="sd">             &#39;horizontal&#39; or &#39;vertical&#39;, default=&#39;vertical&#39;</span>
<span class="sd">         SaveFig:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. Save to a folder called histograms in results directory. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         DPI:</span>
<span class="sd">             Resolution to use when SaveFig=&#39;true&#39;. The larger this value the </span>
<span class="sd">             higher the resolution. Default=125. </span>
<span class="sd">         ExtraTitle:</span>
<span class="sd">             When SaveFig=&#39;true&#39;, save with ExtraTitle appended to the filepath. </span>
<span class="sd">             Default=None</span>
<span class="sd">         Show:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. When not using iPython and graphs are not automatically </span>
<span class="sd">             displayed in shell, this determines whether the plots are opened in a</span>
<span class="sd">             window or not. Default=&#39;false&#39;</span>
<span class="sd">        </span>
<span class="sd">         ResultsDirectory:</span>
<span class="sd">             Name of the directory to store parameter estimation results. </span>
<span class="sd">             Default= &#39;Histograms&#39;</span>
<span class="sd">                     </span>
<span class="sd">                 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#arguments</span>
<span class="c1">#        self.copasi_file=copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Normed&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Variable&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;ColourMap&#39;</span><span class="p">:</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span>
                 <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>

        <span class="c1">#create a directory and change to it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Histograms&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="c1">#main method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span> <span class="c1">#only assigned to variable for testing purposes</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;1&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;2&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;RSS&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        variable: variable to plot. Default= &#39;RSS&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
        <span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not in your PE results: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                 <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">),</span>
                 <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">),</span>
                 <span class="n">normed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Normed&#39;</span><span class="p">),</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Orientation&#39;</span><span class="p">))</span>
        
        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
<span class="c1">#        plt.title(&#39;\n&#39;.join(wrap(&#39;{},n={}&#39;.format(variable,self.data.shape[1])) ),35  )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{},n={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span>
                                 <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency in bin&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value(Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        <span class="c1">#SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">variable</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">variable</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>


        
<span class="c1">#==============================================================================            </span>
<span class="k">class</span> <span class="nc">PlotScatters</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot all possible combinations of scatter graph</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Scatters&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_scatters</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">plot1_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">x_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;x_specie is not in your PE data set&#39;</span>
        <span class="k">assert</span> <span class="n">y_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;y_specie is not in your PE data set&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>   
        <span class="n">x_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">x_specie</span><span class="p">]</span>
        <span class="n">y_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">y_specie</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
<span class="c1">#        plt.title(&#39;\n&#39;.join(wrap(&#39;{},n={}&#39;.format(variable,self.data.shape[1])) ),35  )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;n={},Log10={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">y_specie</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">#            </span>
            
    <span class="k">def</span> <span class="nf">binomial_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
        <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">get_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">comb</span><span class="o">=</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#        comb=[i for i in comb]</span>
        <span class="k">return</span> <span class="n">comb</span>
        
    <span class="k">def</span> <span class="nf">plot_scatters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">comb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_combinations</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>

<span class="k">class</span> <span class="nc">PlotHexMap</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot all possible combinations of scatter graph</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GridSize&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                 <span class="s1">&#39;ColorMap&#39;</span><span class="p">:</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Mode&#39;</span><span class="p">:</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Marginals&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">],[</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">]))</span>        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not argument for Marginals&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]))</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        <span class="c1">#create a directory and change to it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;RSS&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;HexPlotsByRSS&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;HexPlotsByCounts&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            

        
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_hex_maps</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">plot1_hex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">x_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;x_specie is not in your PE data set&#39;</span>
        <span class="k">assert</span> <span class="n">y_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;y_specie is not in your PE data set&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>   
        
        
        <span class="n">x_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">x_specie</span><span class="p">]</span>
        <span class="n">y_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">y_specie</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;RSS&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">],</span><span class="n">gridsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">])</span>
            <span class="n">cb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="n">gridsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">])</span>
            <span class="n">cb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>        

        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#        </span>
        <span class="c1">#labels</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;n={},Log10={},Bins={},GridSize={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">]),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">y_specie</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">#            </span>
            
    <span class="k">def</span> <span class="nf">binomial_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
        <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">get_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">comb</span><span class="o">=</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#        comb=[i for i in comb]</span>
        <span class="k">return</span> <span class="n">comb</span>
        
    <span class="k">def</span> <span class="nf">plot_hex_maps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">comb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_combinations</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1_hex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
<span class="c1">#==============================================================================</span>
<span class="k">class</span> <span class="nc">PlotBoxplot</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Visualize your PE data as boxplots. </span>
<span class="sd">    </span>
<span class="sd">    args:</span>
<span class="sd">        results_path:</span>
<span class="sd">            A parameter esitmation results file or a folder of parameter </span>
<span class="sd">            estimation results files. </span>
<span class="sd">            </span>
<span class="sd">    **kwargs:</span>
<span class="sd">         NumPerPlot:</span>
<span class="sd">            How many parameters to include in a box plot before producing </span>
<span class="sd">            multiple figure. Default=None -  means all will be in one figure. </span>
<span class="sd">    </span>
<span class="sd">         TruncateMode:</span>
<span class="sd">             &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
<span class="sd">         Log10:</span>
<span class="sd">             &#39;false&#39;,</span>
<span class="sd">         X:</span>
<span class="sd">             Corresponding parameter for TruncateMode. See entry for</span>
<span class="sd">             the TruncateData class. Default=100           </span>
<span class="sd">    kwargs which correspond to matplotlib.pyplot.hist keyword arguments. </span>
<span class="sd">    More information about these can be found in the matplotlib documentation </span>
<span class="sd">         AxisSize:</span>
<span class="sd">             Font size for the axis. Default=15</span>
<span class="sd">         FontSize:</span>
<span class="sd">             Font size for the graph labels. Default=22</span>
<span class="sd">         Normed:</span>
<span class="sd">             &#39;true&#39; or &#39;false. Whether to make the plot integrate to 1. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         Color:</span>
<span class="sd">             Plot colour. Default=&#39;red&#39;,     </span>
<span class="sd">         XRotation:</span>
<span class="sd">             25,   #rotation for X tick axis</span>
<span class="sd">         TitleWrapSize:</span>
<span class="sd">             Number of characters to use before word wrapping the title. Default=35  </span>
<span class="sd">         Orientation:</span>
<span class="sd">             &#39;horizontal&#39; or &#39;vertical&#39;, default=&#39;vertical&#39;</span>
<span class="sd">         SaveFig:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. Save to a folder called histograms in results directory. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         DPI:</span>
<span class="sd">             Resolution to use when SaveFig=&#39;true&#39;. The larger this value the </span>
<span class="sd">             higher the resolution. Default=125. </span>
<span class="sd">         ExtraTitle:</span>
<span class="sd">             When SaveFig=&#39;true&#39;, save with ExtraTitle appended to the filepath. </span>
<span class="sd">             Default=None</span>
<span class="sd">         Show:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. When not using iPython and graphs are not automatically </span>
<span class="sd">             displayed in shell, this determines whether the plots are opened in a</span>
<span class="sd">             window or not. Default=&#39;false&#39;</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="c1">#graph options</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;CustomTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="c1">#boxplot specific options</span>
                 <span class="s1">&#39;NumPerPlot&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Boxplots&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">divide_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_vars</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">n_per_plot</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span>
<span class="c1">#        assert n_per_plot&lt;n_vars,&#39;number of variables per plot must be smaller than the number of variables&#39;</span>
        <span class="n">int_division</span><span class="o">=</span> <span class="n">n_vars</span><span class="o">//</span><span class="n">n_per_plot</span>
        <span class="n">remainder</span><span class="o">=</span><span class="n">n_vars</span><span class="o">-</span><span class="p">(</span><span class="n">n_per_plot</span><span class="o">*</span><span class="n">int_division</span><span class="p">)</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">int_division</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">i</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">])</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="n">remainder</span><span class="p">:])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
        

    <span class="k">def</span> <span class="nf">boxplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span> 
        <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">divide_data</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1">#            data= self.truncated_data[labels[i]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">),</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
            <span class="c1">#pretty stuff</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            
            <span class="c1">#labels</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;Distribution of parameter values from {} PE runs&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Parameter Values (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Parameter Values&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
            
    <span class="c1">#        SaveFig options</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boxplot_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boxplot_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
                


                
<span class="c1">#==============================================================================    </span>
<span class="k">class</span> <span class="nc">PlotHeatMap</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot Pearsons correlation as heat map. Still under development. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="c1">#graph options</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="c1">#boxplot specific options</span>
                 <span class="s1">&#39;sym&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;grid&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span>
                             <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">),</span>
                             <span class="n">FromPickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">),</span>
                             <span class="n">Log10</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">))</span>
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">cwd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;HeatMaps&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        



        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">divide_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_vars</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">n_per_plot</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span>
<span class="c1">#        assert n_per_plot&lt;n_vars,&#39;number of variables per plot must be smaller than the number of variables&#39;</span>
        <span class="n">int_division</span><span class="o">=</span> <span class="n">n_vars</span><span class="o">//</span><span class="n">n_per_plot</span>
        <span class="n">remainder</span><span class="o">=</span><span class="n">n_vars</span><span class="o">-</span><span class="p">(</span><span class="n">n_per_plot</span><span class="o">*</span><span class="n">int_division</span><span class="p">)</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">int_division</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">i</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">])</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="n">remainder</span><span class="p">:])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>



    <span class="k">def</span> <span class="nf">get_variance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> 







            
<span class="k">class</span> <span class="nc">GetCovarianceMatrix</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Might be useful somewhere but still under development. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
        
<span class="c1">#        Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span>
                             <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">),</span>
                             <span class="n">FromPickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">),</span>
                             <span class="n">Log10</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">))</span>
<span class="c1">#                             </span>
    <span class="k">def</span> <span class="nf">get_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">PED</span>

<span class="k">class</span> <span class="nc">EvaluateOptimizationPerformance</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot your data RSS Vs Rank of best fit as evaluated by RSS value. This should</span>
<span class="sd">    highlight whether your optimization is finding a minimum and also help map </span>
<span class="sd">    your local and (apparant) global minimum.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        results_path. File or folder of files containing parameter estimation </span>
<span class="sd">        data</span>
<span class="sd">        </span>
<span class="sd">    **kwargs: </span>
<span class="sd">        Same as for the other classes in PEAnalaysis</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="c1">#graph options</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;CustomTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;OptimizationPerformanceGraph&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">## Set size of axes font</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_rss</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">))</span>
                             
    <span class="k">def</span> <span class="nf">plot_rss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">],</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
            <span class="n">rss</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="n">iterations</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">],</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
            <span class="n">rss</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="n">iterations</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">))</span>

            
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="p">,</span><span class="n">rss</span><span class="p">)</span>
        
        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;RSS values for {} iterations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">)),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS Values (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank of Best Fit (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Optimization Iteration&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank of Best Fit&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;(Log10)&#39;</span>
        
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;extra title should be a string&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;RSSVsITerations&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;RSSVsITerations&#39;</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#==============================================================================</span>


<span class="k">class</span> <span class="nc">PlotPEData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot a parameter estimation run against experimental data. </span>
<span class="sd">    Suport currently only exists for time course experiments. In future versions</span>
<span class="sd">    a SteadyState Task will be introduced and then we can build a plotting feature</span>
<span class="sd">    for fitting steady state experiments</span>
<span class="sd">    </span>
<span class="sd">    Positional Arguments:</span>
<span class="sd">    </span>
<span class="sd">        copasi_file:</span>
<span class="sd">            The copasi file you want to enter parameters into</span>
<span class="sd">            </span>
<span class="sd">        experiment_files</span>
<span class="sd">        </span>
<span class="sd">        PE_result_files</span>
<span class="sd">    </span>
<span class="sd">    **Kwargs</span>
<span class="sd">        Index:</span>
<span class="sd">            Index of parameter estimation run to input into the copasi file. </span>
<span class="sd">            The index is ordered by rank of best fit, with 0 being the best.</span>
<span class="sd">            Default=0            </span>
<span class="sd">            </span>
<span class="sd">        PruneHeaders:</span>
<span class="sd">            Prune copasi variable names of Copasi references. &#39;true&#39; or &#39;false&#39;</span>
<span class="sd">            </span>
<span class="sd">        QuantityType:</span>
<span class="sd">            Either &#39;particle_number&#39; or &#39;concentration&#39;. Default=&#39;concentration&#39;</span>
<span class="sd">            </span>
<span class="sd">        OutputML:</span>
<span class="sd">            If Save set to &#39;duplicate&#39;, this is the duplicate filename. </span>
<span class="sd">            </span>
<span class="sd">        Save:</span>
<span class="sd">            either &#39;false&#39;,&#39;overwrite&#39; or &#39;duplicate&#39;</span>
<span class="sd">            </span>
<span class="sd">        ParameterDict:</span>
<span class="sd">            A python dictionary with keys correponding to parameters in the model</span>
<span class="sd">            and values the parameters (dict[parameter_name]=parameter value). </span>
<span class="sd">            Default=None</span>
<span class="sd">            </span>
<span class="sd">        DF:</span>
<span class="sd">            A pandas dataframe with parameters being column names matching </span>
<span class="sd">            parameters in your model and RSS values and rows being individual </span>
<span class="sd">            parameter estimationruns. In this case, ensure you have set the </span>
<span class="sd">            Index parameter to the index you want to use. Dataframes are </span>
<span class="sd">            automatically sorted by the RSS column. </span>
<span class="sd">            </span>
<span class="sd">        ParameterPath:</span>
<span class="sd">            Full path to a parameter estimation file (&#39;.txt&#39;,&#39;.xls&#39;,&#39;.xlsx&#39; or </span>
<span class="sd">            &#39;.csv&#39;) or a folder containing parameter estimation files. </span>
<span class="sd">            </span>
<span class="sd">        OutputDirectory:</span>
<span class="sd">            Name of an output directory. </span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">experiment_files</span><span class="p">,</span><span class="n">PE_result_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="o">=</span><span class="n">experiment_files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="o">=</span><span class="n">PE_result_file</span>
        
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>

        <span class="n">default_report_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span>
                                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_PE_results.txt&#39;</span><span class="p">)</span>
        <span class="n">default_outputML</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Duplicate.cps&#39;</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
                 <span class="s1">&#39;ReportName&#39;</span><span class="p">:</span><span class="n">default_report_name</span><span class="p">,</span>
                 <span class="s1">&#39;OutputML&#39;</span><span class="p">:</span><span class="n">default_outputML</span><span class="p">,</span>
                 <span class="s1">&#39;Save&#39;</span><span class="p">:</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                 <span class="s1">&#39;LineWidth&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;PruneHeaders&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 
                 <span class="c1">#graph features</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;MultiPlot&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
                 <span class="s1">&#39;Ylimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Xlimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;XTickRotation&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;DotSize&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;LegendLoc&#39;</span><span class="p">:</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;OutputDirectory&#39;</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ParameterEstimationPlots&#39;</span><span class="p">),</span>
                 <span class="s1">&#39;Plot&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>                 
                 
                 <span class="p">}</span>
                 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for Plot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>       
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The Plot kwarg takes only </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#limit parameters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Ylimit is a list of coordinates for y axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Ylimit list must be 2&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Xlimit is a list of coordinates for X axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Xlimit list must be 2&#39;</span>
        
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">),</span><span class="s1">&#39;XTickRotation parameter should be a Python integer&#39;</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
            
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>                
                     
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PruneHeaders&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>                
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for PlotPEData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your copasi file {}doesn</span><span class="se">\&#39;</span><span class="s1"> exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your experiment file {} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">))</span>
            <span class="c1">#make a 1 element list to iterate over later</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">]</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your PE data file {} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">))</span>
        
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_experimental_files</span><span class="p">()</span>
<span class="c1">#        print self.experiment_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_times</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">simulate_time_course</span><span class="p">()</span>
<span class="c1">##        &#39;&#39;&#39;</span>
<span class="c1">##        Only change directory before doing the actual plotting. </span>
<span class="c1">##        You want to be in the model directory for all the while your collecting</span>
<span class="c1">##        data then move on over to the results directory when plotting. </span>
<span class="c1">##        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">change_directory</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">change_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dire</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ParameterEstimationPlots&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dire</span>
        
        
    <span class="k">def</span> <span class="nf">parse_experimental_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">df_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="n">df</span><span class="o">=</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">df_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">df</span>
        <span class="k">return</span> <span class="n">df_dct</span>
        
    
    <span class="k">def</span> <span class="nf">get_experiment_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">times</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;StepSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            subtract 1 from intervals to account for header</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Intervals&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">times</span>
        
    <span class="k">def</span> <span class="nf">parse_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PruneHeaders&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">data</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">insert_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span>
        
        
    <span class="k">def</span> <span class="nf">simulate_time_course</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">:</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            need to subtract 1 from the intervals</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">TimeCourse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">Start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">],</span>
                          <span class="n">End</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">],</span>
                          <span class="n">Intervals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Intervals&#39;</span><span class="p">],</span>
                          <span class="n">StepSize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;StepSize&#39;</span><span class="p">],</span><span class="n">Plot</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">)</span>
            <span class="n">P</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="n">TC</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
            <span class="n">data_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="o">.</span><span class="n">df</span>
        <span class="k">return</span> <span class="n">data_dct</span>


<span class="c1">#    def simulate_time_course(self):</span>
<span class="c1">#        data_dct={}</span>
<span class="c1">#        for i in self.exp_times:</span>
<span class="c1">#            &#39;&#39;&#39;</span>
<span class="c1">#            need to subtract 1 from the intervals</span>
<span class="c1">#            &#39;&#39;&#39;</span>
<span class="c1">#            TC=pycopi.TimeCourse(self.copasi_file,Start=self.exp_times[i][&#39;Start&#39;],</span>
<span class="c1">#                          End=self.exp_times[i][&#39;End&#39;],</span>
<span class="c1">#                          Intervals=self.exp_times[i][&#39;End&#39;],</span>
<span class="c1">#                          StepSize=1,Plot=&#39;false&#39;)</span>
<span class="c1">#            P=pycopi.PruneCopasiHeaders(TC.data,replace=&#39;true&#39;)</span>
<span class="c1">#            data_dct[i]=P.df</span>
<span class="c1">#        return data_dct</span>
        
        
                            
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fle</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot one parameter of one experiment. for iterating over in </span>
<span class="sd">        other functions</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {} or {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">sim</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">exp</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">sim</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;simulated&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;experimental&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LegendLoc&#39;</span><span class="p">))</span>


   
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#xtick rotation</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">))</span>
        
        <span class="c1">#options for changing the plot axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">))</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantity Unit ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_quantity_units</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantity Unit (micromol)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
                        
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_time_unit</span><span class="p">()),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>  


        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="o">+</span><span class="s1">&#39;_-[]&#39;</span><span class="p">:</span>
                <span class="n">parameter</span><span class="o">=</span><span class="n">parameter</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
                
<span class="c1">#        parameter=re.sub(p,&#39;_&#39;,parameter) </span>
                                
                                
                                
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputDirectory&#39;</span><span class="p">),</span><span class="s1">&#39;{}_{}.jpeg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)))</span>                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputDirectory&#39;</span><span class="p">),</span><span class="s1">&#39;{}.jpeg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>             
        
        
    <span class="k">def</span> <span class="nf">plot1file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fle</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        plot only parameters from a single experiment file</span>
<span class="sd">        (for the event that the user has multiple time course</span>
<span class="sd">        experiments)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="o">!=</span><span class="s1">&#39;Time&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot all parameters</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="n">dire</span><span class="p">,</span><span class="n">p</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1file</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            
            
            
<span class="k">class</span> <span class="nc">PlotHistogram3D</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Not functional </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Plot parameter estimation results as histogram</span>
<span class="sd">    Args:</span>
<span class="sd">        results_path:</span>
<span class="sd">            Path to file or folder of files containing parameter estimation data</span>
<span class="sd">            to plot</span>
<span class="sd">    **kwargs:</span>
<span class="sd">         TruncateMode:</span>
<span class="sd">             &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
<span class="sd">         Log10:</span>
<span class="sd">             &#39;false&#39;,</span>
<span class="sd">         X:</span>
<span class="sd">             100,           #if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
<span class="sd">    **kwargs which correspond to matplotlib.pyplot.hist keyword arguments. </span>
<span class="sd">    More information about these can be found in the matplotlib documentation </span>
<span class="sd">         Bins:</span>
<span class="sd">             Number of bins to use. Default=100,</span>
<span class="sd">         AxisSize:</span>
<span class="sd">             Font size for the axis. Default=15</span>
<span class="sd">         FontSize:</span>
<span class="sd">             Font size for the graph labels. Default=22</span>
<span class="sd">         Normed:</span>
<span class="sd">             &#39;true&#39; or &#39;false. Whether to make the plot integrate to 1. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         Color:</span>
<span class="sd">             Plot colour. Default=&#39;red&#39;,     </span>
<span class="sd">         XRotation:</span>
<span class="sd">             25,   #rotation for X tick axis</span>
<span class="sd">         TitleWrapSize:</span>
<span class="sd">             Number of characters to use before word wrapping the title. Default=35  </span>
<span class="sd">         Orientation:</span>
<span class="sd">             &#39;horizontal&#39; or &#39;vertical&#39;, default=&#39;vertical&#39;</span>
<span class="sd">         SaveFig:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. Save to a folder called histograms in results directory. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         DPI:</span>
<span class="sd">             Resolution to use when SaveFig=&#39;true&#39;. The larger this value the </span>
<span class="sd">             higher the resolution. Default=125. </span>
<span class="sd">         ExtraTitle:</span>
<span class="sd">             When SaveFig=&#39;true&#39;, save with ExtraTitle appended to the filepath. </span>
<span class="sd">             Default=None</span>
<span class="sd">         Show:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. When not using iPython and graphs are not automatically </span>
<span class="sd">             displayed in shell, this determines whether the plots are opened in a</span>
<span class="sd">             window or not. Default=&#39;false&#39;</span>
<span class="sd">                     </span>
<span class="sd">                 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#arguments</span>
<span class="c1">#        self.copasi_file=copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Normed&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Variable&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>

        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Histograms&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="c1">#main method</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">()</span>
<span class="c1">#        self.testing_variable=self.plot_all() #only assigned to variable for testing purposes</span>
<span class="c1">#        os.chdir(os.path.dirname(self.results_dir))</span>
            
    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;1&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;2&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;RSS&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        variable: variable to plot. Default= &#39;RSS&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
        <span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not in your PE results: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">Axes3D</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">()</span>
        
<span class="c1">#        plt.hist(data,</span>
<span class="c1">#                 bins=self.kwargs.get(&#39;Bins&#39;),</span>
<span class="c1">#                 color=self.kwargs.get(&#39;Color&#39;),</span>
<span class="c1">#                 normed=self.kwargs.get(&#39;Normed&#39;),</span>
<span class="c1">#                 orientation=self.kwargs.get(&#39;Orientation&#39;))</span>
<span class="c1">#        </span>
<span class="c1">#        #pretty stuff</span>
<span class="c1">#        ax=plt.subplot(1,1,1)</span>
<span class="c1">#        ax.spines[&#39;right&#39;].set_color(&#39;none&#39;)</span>
<span class="c1">#        ax.spines[&#39;top&#39;].set_color(&#39;none&#39;)</span>
<span class="c1">#        ax.xaxis.set_ticks_position(&#39;bottom&#39;)</span>
<span class="c1">#        ax.yaxis.set_ticks_position(&#39;left&#39;)</span>
<span class="c1">#        ax.spines[&#39;left&#39;].set_smart_bounds(True)</span>
<span class="c1">#        ax.spines[&#39;bottom&#39;].set_smart_bounds(True)</span>
<span class="c1">#        </span>
<span class="c1">#        #labels</span>
<span class="c1">##        plt.title(&#39;\n&#39;.join(wrap(&#39;{},n={}&#39;.format(variable,self.data.shape[1])) ),35  )</span>
<span class="c1">#        plt.title(&#39;\n&#39;.join(wrap(&#39;{},n={}&#39;.format(variable,data.shape[0]),</span>
<span class="c1">#                                 self.kwargs.get(&#39;TitleWrapSize&#39;))),</span>
<span class="c1">#                                 fontsize=self.kwargs.get(&#39;FontSize&#39;))</span>
<span class="c1">#        plt.ylabel(&#39;Frequency in bin&#39;)</span>
<span class="c1">#        plt.xticks(rotation=self.kwargs.get(&#39;XRotation&#39;))</span>
<span class="c1">#        if self.kwargs.get(&#39;Log10&#39;)==&#39;true&#39;:</span>
<span class="c1">#            plt.xlabel(&#39;Parameter Value(Log10)&#39;,fontsize=self.kwargs.get(&#39;FontSize&#39;))</span>
<span class="c1">#        else:</span>
<span class="c1">#            plt.xlabel(&#39;Parameter Value&#39;,fontsize=self.kwargs.get(&#39;FontSize&#39;))</span>
<span class="c1">#        </span>
<span class="c1">#        #SaveFig options</span>
<span class="c1">#        if self.kwargs.get(&#39;SaveFig&#39;)==&#39;true&#39;:</span>
<span class="c1">#            if self.kwargs.get(&#39;ExtraTitle&#39;)!=None:</span>
<span class="c1">#                assert isinstance(self.kwargs.get(&#39;ExtraTitle&#39;),str),&#39;extra title should be a string&#39;</span>
<span class="c1">#                plt.savefig(variable+&#39;_&#39;+self.kwargs.get(&#39;ExtraTitle&#39;)+&#39;.jpeg&#39;,bbox_inches=&#39;tight&#39;,format=&#39;jpeg&#39;,dpi=self.kwargs.get(&#39;DPI&#39;))</span>
<span class="c1">#            else:</span>
<span class="c1">#                plt.savefig(variable+&#39;.jpeg&#39;,format=&#39;jpeg&#39;,bbox_inches=&#39;tight&#39;,dpi=self.kwargs.get(&#39;DPI&#39;))</span>
<span class="c1">#        if self.kwargs.get(&#39;Show&#39;)==&#39;true&#39;:</span>
<span class="c1">#            plt.show()</span>
<span class="c1">#    </span>
<span class="c1">#    def plot_all(self):</span>
<span class="c1">#        for i in self.truncated_data:</span>
<span class="c1">#            self.plot1(i)</span>
<span class="c1">#        return True</span>


<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1">#    current_directory=&#39;D:\MPhil\Python\My_Python_Modules\Modelling_Tools\PyCoTools\PyCoTools\Examples\GoldbetterExample&#39;</span>
<span class="c1">#    copasi_file=r&#39;Goldbeter1995_CircClock.cps&#39;</span>
<span class="c1">#    goldbetter_model=os.path.join(current_directory,copasi_file)</span>
<span class="c1">#    report=os.path.join(current_directory,&#39;TimeCourseOutput.txt&#39;)</span>
<span class="c1">#    noisy_report=os.path.join(current_directory,&#39;NoisyTimeCourseOutput.txt&#39;)</span>
<span class="c1">#    </span>
<span class="c1">#    EvaluateOptimizationPerformance(noisy_report)</span>
<span class="c1">#    PEData_report=os.path.join(current_directory,&#39;PEData.txt&#39;)</span>
    
    
<span class="c1">#    print ParsePEData(PEData_report).data</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">


    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="PEAnalysis.EvaluateOptimizationPerformance" class="name">class <span class="ident">EvaluateOptimizationPerformance</span></p>
      
  
    <div class="desc"><p>Plot your data RSS Vs Rank of best fit as evaluated by RSS value. This should
highlight whether your optimization is finding a minimum and also help map 
your local and (apparant) global minimum.</p>
<p>Args:
    results_path. File or folder of files containing parameter estimation 
    data</p>
<p>**kwargs: 
    Same as for the other classes in PEAnalaysis</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.EvaluateOptimizationPerformance', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.EvaluateOptimizationPerformance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">EvaluateOptimizationPerformance</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot your data RSS Vs Rank of best fit as evaluated by RSS value. This should</span>
<span class="sd">    highlight whether your optimization is finding a minimum and also help map </span>
<span class="sd">    your local and (apparant) global minimum.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        results_path. File or folder of files containing parameter estimation </span>
<span class="sd">        data</span>
<span class="sd">        </span>
<span class="sd">    **kwargs: </span>
<span class="sd">        Same as for the other classes in PEAnalaysis</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="c1">#graph options</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;CustomTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;OptimizationPerformanceGraph&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">## Set size of axes font</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_rss</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">))</span>
                             
    <span class="k">def</span> <span class="nf">plot_rss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">],</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
            <span class="n">rss</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="n">iterations</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">],</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
            <span class="n">rss</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
            <span class="n">iterations</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">))</span>

            
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="p">,</span><span class="n">rss</span><span class="p">)</span>
        
        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;RSS values for {} iterations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">)),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS Values (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank of Best Fit (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Optimization Iteration&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank of Best Fit&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;(Log10)&#39;</span>
        
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;extra title should be a string&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;RSSVsITerations&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;RSSVsITerations&#39;</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.EvaluateOptimizationPerformance">EvaluateOptimizationPerformance</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.EvaluateOptimizationPerformance.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.EvaluateOptimizationPerformance.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.EvaluateOptimizationPerformance.results_dir" class="name">var <span class="ident">results_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.EvaluateOptimizationPerformance.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.EvaluateOptimizationPerformance.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.EvaluateOptimizationPerformance.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.EvaluateOptimizationPerformance.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="c1">#truncate data options</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="c1">#graph options</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;CustomTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    
    <span class="c1">#Other classes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    
    <span class="c1">#create a directory and change to it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;OptimizationPerformanceGraph&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    
    <span class="c1">## Set size of axes font</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
    
    
    <span class="bp">self</span><span class="o">.</span><span class="n">plot_rss</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.EvaluateOptimizationPerformance.plot_rss">
    <p>def <span class="ident">plot_rss</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.EvaluateOptimizationPerformance.plot_rss', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.EvaluateOptimizationPerformance.plot_rss" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_rss</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">],</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
        <span class="n">rss</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
        <span class="n">iterations</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">],</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">data</span>
        <span class="n">rss</span><span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span>
        <span class="n">iterations</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">))</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">iterations</span><span class="p">,</span><span class="n">rss</span><span class="p">)</span>
    
    <span class="c1">#pretty stuff</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1">#labels</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;RSS values for {} iterations&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss</span><span class="p">)),</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RSS Values (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank of Best Fit (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Optimization Iteration&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Rank of Best Fit&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Log10&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;(Log10)&#39;</span>
    
     <span class="n">SaveFig</span> <span class="n">options</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;extra title should be a string&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;RSSVsITerations&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;RSSVsITerations&#39;</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.GetCovarianceMatrix" class="name">class <span class="ident">GetCovarianceMatrix</span></p>
      
  
    <div class="desc"><p>Might be useful somewhere but still under development.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.GetCovarianceMatrix', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.GetCovarianceMatrix" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">GetCovarianceMatrix</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Might be useful somewhere but still under development. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
        
<span class="c1">#        Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span>
                             <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">),</span>
                             <span class="n">FromPickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">),</span>
                             <span class="n">Log10</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">))</span>
<span class="c1">#                             </span>
    <span class="k">def</span> <span class="nf">get_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">PED</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.GetCovarianceMatrix">GetCovarianceMatrix</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.GetCovarianceMatrix.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.GetCovarianceMatrix.copasi_file" class="name">var <span class="ident">copasi_file</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.GetCovarianceMatrix.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.GetCovarianceMatrix.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.GetCovarianceMatrix.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, copasi_file, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.GetCovarianceMatrix.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.GetCovarianceMatrix.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
             <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
             <span class="c1">#truncate data options</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span><span class="s1">&#39;file&#39;</span><span class="p">]</span>
    
     <span class="n">Other</span> <span class="n">classes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span>
                         <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">),</span>
                         <span class="n">FromPickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">),</span>
                         <span class="n">Log10</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.GetCovarianceMatrix.get_covariance">
    <p>def <span class="ident">get_covariance</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.GetCovarianceMatrix.get_covariance', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.GetCovarianceMatrix.get_covariance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_covariance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">PED</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.ParsePEData" class="name">class <span class="ident">ParsePEData</span></p>
      
  
    <div class="desc"><p>parse parameter estimation data from file</p>
<p>Args:
    results_path: 
        Absolute path to file or folder of files containing parameter
        estimation data. </p>
<p>kwargs:
    UsePickle:
        Allow one to overwrite the pickle file automatically
        produced for speed. Default='false'</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ParsePEData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    parse parameter estimation data from file</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        results_path: </span>
<span class="sd">            Absolute path to file or folder of files containing parameter</span>
<span class="sd">            estimation data. </span>
<span class="sd">            </span>
<span class="sd">    kwargs:</span>
<span class="sd">        UsePickle:</span>
<span class="sd">            Allow one to overwrite the pickle file automatically</span>
<span class="sd">            produced for speed. Default=&#39;false&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="n">UsePickle</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="n">OverwritePickle</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="n">PicklePath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c1">#input argument variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span> <span class="c1">#either file or folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="n">RemoveInfiniteRSS</span>
        <span class="c1">#assertions</span>
<span class="c1">#        assert os.path.isfile(self.copasi_file),&#39;{} is not a real file&#39;.format(self.copasi_file)</span>
        <span class="c1">#change directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">=</span><span class="n">PicklePath</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;PEData.pickle&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path_log</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;PEData_log.pickle&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path_log</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">),</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_log.pickle&#39;</span><span class="p">)</span>
<span class="c1">#        self.FromPickle=True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">=</span><span class="n">UsePickle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">=</span><span class="n">OverwritePickle</span>
        
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;{} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;folder&#39;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument UsePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument OverwritePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument OverwritePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>            
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;DataFrame is empty. Your PE data has not been read.&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rename_RSS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="c1">#        self.data=self.prune_headers()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_constants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_infinite_RSS</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">prune</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log10_conversion</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Could not convert to log10 scale. Chances are this is because you have infinite RSS values in your parameter estimation data. Try changing the optimization settings&#39;</span><span class="p">)</span>
            



    <span class="k">def</span> <span class="nf">remove_infinite_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="s1">&#39;1.#INF&#39;</span> <span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span><span class="s1">&#39;Your PE data contains infinite RSS values. These data will be removed&#39;&#39;&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="s1">&#39;true&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1.#INF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        
        
    <span class="k">def</span> <span class="nf">filter_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">df</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span> 
        
    <span class="k">def</span> <span class="nf">read_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        read folder of tab separated csv files i.e. the output from copasi</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;{} is not a real directory&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="n">df_list</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
            <span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
                <span class="n">df</span><span class="o">=</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">rename_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        change the RSS from copasi output to RSS</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">b</span><span class="o">=</span><span class="s1">&#39;TaskList[Parameter Estimation].(Problem)Parameter Estimation.Best Value&#39;</span>
        <span class="k">if</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">b</span><span class="p">:</span><span class="s1">&#39;RSS&#39;</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">data</span>

        
    <span class="k">def</span> <span class="nf">sort_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        sort data in order of increasing RSS</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

        
    <span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="s1">&#39;mode not file&#39;</span>
        <span class="n">_</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.xls&#39;</span><span class="p">,</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span><span class="s1">&#39;.pickle&#39;</span><span class="p">],</span><span class="s1">&#39;parameter file is not .pickle, .txt, .xlsx, .xls, .csv&#39;</span>
        <span class="k">if</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;xlsx&#39;</span> <span class="ow">or</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;xls&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.csv&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.pickle&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Pickle path does not exist&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
 

    <span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Read data. The self.for_testing variable only exists for</span>
<span class="sd">        sign posting the tests for this class</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_file</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;folder&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_folder</span><span class="p">()</span>
                
                
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_false&#39;</span>
            <span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="p">()</span>
            <span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_true_overwrite_false&#39;</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">()</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_true_overwrite_true&#39;</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span>
                <span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="p">()</span>
                <span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">data</span> 

    <span class="k">def</span> <span class="nf">log10_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.ParsePEData">ParsePEData</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.OverwritePickle" class="name">var <span class="ident">OverwritePickle</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.RemoveInfiniteRSS" class="name">var <span class="ident">RemoveInfiniteRSS</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.UsePickle" class="name">var <span class="ident">UsePickle</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.cwd" class="name">var <span class="ident">cwd</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.pickle_path" class="name">var <span class="ident">pickle_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.ParsePEData.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, UsePickle=&#39;false&#39;, OverwritePickle=&#39;true&#39;, RemoveInfiniteRSS=&#39;false&#39;, PicklePath=None)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="n">UsePickle</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="n">OverwritePickle</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="n">PicklePath</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="c1">#input argument variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span> <span class="c1">#either file or folder</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="n">RemoveInfiniteRSS</span>
    <span class="c1">#assertions</span>
     <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;{} is not a real file&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="c1">#change directory</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">=</span><span class="n">PicklePath</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;PEData.pickle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path_log</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;PEData_log.pickle&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pickle_path_log</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">),</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">6</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_log.pickle&#39;</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">FromPickle</span><span class="o">=</span><span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">=</span><span class="n">UsePickle</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">=</span><span class="n">OverwritePickle</span>
    
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;{} does not exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;folder&#39;</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;file&#39;</span>
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument UsePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument OverwritePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The argument OverwritePickle only accepts </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>            
    
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">empty</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;DataFrame is empty. Your PE data has not been read.&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rename_RSS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sort_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prune_headers</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filter_constants</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_infinite_RSS</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">prune</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log10_conversion</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Could not convert to log10 scale. Chances are this is because you have infinite RSS values in your parameter estimation data. Try changing the optimization settings&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.filter_constants">
    <p>def <span class="ident">filter_constants</span>(</p><p>self, df)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.filter_constants', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.filter_constants" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">filter_constants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">df</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="n">df</span> <span class="o">!=</span> <span class="n">df</span><span class="o">.</span><span class="n">ix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span> 
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.log10_conversion">
    <p>def <span class="ident">log10_conversion</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.log10_conversion', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.log10_conversion" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">log10_conversion</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.read_data">
    <p>def <span class="ident">read_data</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Read data. The self.for_testing variable only exists for
sign posting the tests for this class</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.read_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.read_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Read data. The self.for_testing variable only exists for</span>
<span class="sd">    sign posting the tests for this class</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="bp">None</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">():</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_file</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;folder&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_folder</span><span class="p">()</span>
            
            
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_false&#39;</span>
        <span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_true_overwrite_false&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">OverwritePickle</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">for_testing</span><span class="o">=</span><span class="s1">&#39;pickle_true_overwrite_true&#39;</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">UsePickle</span><span class="o">==</span><span class="s1">&#39;false&#39;</span>
            <span class="n">data</span><span class="o">=</span><span class="n">read</span><span class="p">()</span>
            <span class="n">data</span><span class="o">.</span><span class="n">to_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">data</span> 
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.read_file">
    <p>def <span class="ident">read_file</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.read_file', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.read_file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="o">==</span><span class="s1">&#39;file&#39;</span><span class="p">,</span><span class="s1">&#39;mode not file&#39;</span>
    <span class="n">_</span><span class="p">,</span><span class="n">ext</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.xlsx&#39;</span><span class="p">,</span><span class="s1">&#39;.xls&#39;</span><span class="p">,</span><span class="s1">&#39;.csv&#39;</span><span class="p">,</span><span class="s1">&#39;.pickle&#39;</span><span class="p">],</span><span class="s1">&#39;parameter file is not .pickle, .txt, .xlsx, .xls, .csv&#39;</span>
    <span class="k">if</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;xlsx&#39;</span> <span class="ow">or</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;xls&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.csv&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">ext</span><span class="o">==</span><span class="s1">&#39;.pickle&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.read_folder">
    <p>def <span class="ident">read_folder</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>read folder of tab separated csv files i.e. the output from copasi</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.read_folder', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.read_folder" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_folder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    read folder of tab separated csv files i.e. the output from copasi</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;{} is not a real directory&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="n">df_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">):</span>
        <span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;.txt&#39;</span><span class="p">:</span>
            <span class="n">df</span><span class="o">=</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">df_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.read_pickle">
    <p>def <span class="ident">read_pickle</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.read_pickle', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.read_pickle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Pickle path does not exist&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_pickle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pickle_path</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.remove_infinite_RSS">
    <p>def <span class="ident">remove_infinite_RSS</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.remove_infinite_RSS', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.remove_infinite_RSS" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">remove_infinite_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="s1">&#39;1.#INF&#39;</span> <span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span><span class="s1">&#39;Your PE data contains infinite RSS values. These data will be removed&#39;&#39;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">=</span><span class="s1">&#39;true&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RemoveInfiniteRSS</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;1.#INF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.rename_RSS">
    <p>def <span class="ident">rename_RSS</span>(</p><p>self, data)</p>
    </div>
    

    
  
    <div class="desc"><p>change the RSS from copasi output to RSS</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.rename_RSS', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.rename_RSS" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">rename_RSS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    change the RSS from copasi output to RSS</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">b</span><span class="o">=</span><span class="s1">&#39;TaskList[Parameter Estimation].(Problem)Parameter Estimation.Best Value&#39;</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">b</span><span class="p">:</span><span class="s1">&#39;RSS&#39;</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.ParsePEData.sort_data">
    <p>def <span class="ident">sort_data</span>(</p><p>self, data)</p>
    </div>
    

    
  
    <div class="desc"><p>sort data in order of increasing RSS</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.ParsePEData.sort_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.ParsePEData.sort_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">sort_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    sort data in order of increasing RSS</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">data</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotBoxplot" class="name">class <span class="ident">PlotBoxplot</span></p>
      
  
    <div class="desc"><p>Visualize your PE data as boxplots. </p>
<p>args:
    results_path:
        A parameter esitmation results file or a folder of parameter 
        estimation results files. </p>
<p>**kwargs:
     NumPerPlot:
        How many parameters to include in a box plot before producing 
        multiple figure. Default=None -  means all will be in one figure. </p>
<div class="codehilite"><pre><span></span> TruncateMode:
     &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. 
 Log10:
     &#39;false&#39;,
 X:
     Corresponding parameter for TruncateMode. See entry for
     the TruncateData class. Default=100
</pre></div>


<p>kwargs which correspond to matplotlib.pyplot.hist keyword arguments. 
More information about these can be found in the matplotlib documentation 
     AxisSize:
         Font size for the axis. Default=15
     FontSize:
         Font size for the graph labels. Default=22
     Normed:
         'true' or 'false. Whether to make the plot integrate to 1. 
         Default='false'
     Color:
         Plot colour. Default='red',   <br />
     XRotation:
         25,   #rotation for X tick axis
     TitleWrapSize:
         Number of characters to use before word wrapping the title. Default=35<br />
     Orientation:
         'horizontal' or 'vertical', default='vertical'
     SaveFig:
         'true' or 'false'. Save to a folder called histograms in results directory. 
         Default='false'
     DPI:
         Resolution to use when SaveFig='true'. The larger this value the 
         higher the resolution. Default=125. 
     ExtraTitle:
         When SaveFig='true', save with ExtraTitle appended to the filepath. 
         Default=None
     Show:
         'true' or 'false'. When not using iPython and graphs are not automatically 
         displayed in shell, this determines whether the plots are opened in a
         window or not. Default='false'</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotBoxplot', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotBoxplot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotBoxplot</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Visualize your PE data as boxplots. </span>
<span class="sd">    </span>
<span class="sd">    args:</span>
<span class="sd">        results_path:</span>
<span class="sd">            A parameter esitmation results file or a folder of parameter </span>
<span class="sd">            estimation results files. </span>
<span class="sd">            </span>
<span class="sd">    **kwargs:</span>
<span class="sd">         NumPerPlot:</span>
<span class="sd">            How many parameters to include in a box plot before producing </span>
<span class="sd">            multiple figure. Default=None -  means all will be in one figure. </span>
<span class="sd">    </span>
<span class="sd">         TruncateMode:</span>
<span class="sd">             &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
<span class="sd">         Log10:</span>
<span class="sd">             &#39;false&#39;,</span>
<span class="sd">         X:</span>
<span class="sd">             Corresponding parameter for TruncateMode. See entry for</span>
<span class="sd">             the TruncateData class. Default=100           </span>
<span class="sd">    kwargs which correspond to matplotlib.pyplot.hist keyword arguments. </span>
<span class="sd">    More information about these can be found in the matplotlib documentation </span>
<span class="sd">         AxisSize:</span>
<span class="sd">             Font size for the axis. Default=15</span>
<span class="sd">         FontSize:</span>
<span class="sd">             Font size for the graph labels. Default=22</span>
<span class="sd">         Normed:</span>
<span class="sd">             &#39;true&#39; or &#39;false. Whether to make the plot integrate to 1. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         Color:</span>
<span class="sd">             Plot colour. Default=&#39;red&#39;,     </span>
<span class="sd">         XRotation:</span>
<span class="sd">             25,   #rotation for X tick axis</span>
<span class="sd">         TitleWrapSize:</span>
<span class="sd">             Number of characters to use before word wrapping the title. Default=35  </span>
<span class="sd">         Orientation:</span>
<span class="sd">             &#39;horizontal&#39; or &#39;vertical&#39;, default=&#39;vertical&#39;</span>
<span class="sd">         SaveFig:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. Save to a folder called histograms in results directory. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         DPI:</span>
<span class="sd">             Resolution to use when SaveFig=&#39;true&#39;. The larger this value the </span>
<span class="sd">             higher the resolution. Default=125. </span>
<span class="sd">         ExtraTitle:</span>
<span class="sd">             When SaveFig=&#39;true&#39;, save with ExtraTitle appended to the filepath. </span>
<span class="sd">             Default=None</span>
<span class="sd">         Show:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. When not using iPython and graphs are not automatically </span>
<span class="sd">             displayed in shell, this determines whether the plots are opened in a</span>
<span class="sd">             window or not. Default=&#39;false&#39;</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="c1">#graph options</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;CustomTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="c1">#boxplot specific options</span>
                 <span class="s1">&#39;NumPerPlot&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Boxplots&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">divide_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_vars</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">n_per_plot</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span>
<span class="c1">#        assert n_per_plot&lt;n_vars,&#39;number of variables per plot must be smaller than the number of variables&#39;</span>
        <span class="n">int_division</span><span class="o">=</span> <span class="n">n_vars</span><span class="o">//</span><span class="n">n_per_plot</span>
        <span class="n">remainder</span><span class="o">=</span><span class="n">n_vars</span><span class="o">-</span><span class="p">(</span><span class="n">n_per_plot</span><span class="o">*</span><span class="n">int_division</span><span class="p">)</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">int_division</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">i</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">])</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="n">remainder</span><span class="p">:])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
        

    <span class="k">def</span> <span class="nf">boxplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span> 
        <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">divide_data</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1">#            data= self.truncated_data[labels[i]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">),</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
            <span class="c1">#pretty stuff</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            
            <span class="c1">#labels</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;Distribution of parameter values from {} PE runs&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Parameter Values (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Parameter Values&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
            
    <span class="c1">#        SaveFig options</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boxplot_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boxplot_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotBoxplot">PlotBoxplot</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.log_data" class="name">var <span class="ident">log_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.results_dir" class="name">var <span class="ident">results_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotBoxplot.truncated_data" class="name">var <span class="ident">truncated_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotBoxplot.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotBoxplot.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotBoxplot.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
             <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="c1">#truncate data options</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="c1">#graph options</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;CustomTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="c1">#boxplot specific options</span>
             <span class="s1">&#39;NumPerPlot&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
    <span class="c1">#Other classes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="c1">#create a directory and change to it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Boxplots&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    
    <span class="c1">#attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotBoxplot.boxplot">
    <p>def <span class="ident">boxplot</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotBoxplot.boxplot', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotBoxplot.boxplot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">boxplot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span> 
    <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">divide_data</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
         <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">),</span><span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;axes&#39;</span><span class="p">)</span>
        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;Distribution of parameter values from {} PE runs&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;CustomTitle&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Parameter Values (Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Parameter Values&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boxplot_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;boxplot_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotBoxplot.divide_data">
    <p>def <span class="ident">divide_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotBoxplot.divide_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotBoxplot.divide_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">divide_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">n_vars</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">n_per_plot</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span>
     <span class="k">assert</span> <span class="n">n_per_plot</span><span class="o">&lt;</span><span class="n">n_vars</span><span class="p">,</span><span class="s1">&#39;number of variables per plot must be smaller than the number of variables&#39;</span>
    <span class="n">int_division</span><span class="o">=</span> <span class="n">n_vars</span><span class="o">//</span><span class="n">n_per_plot</span>
    <span class="n">remainder</span><span class="o">=</span><span class="n">n_vars</span><span class="o">-</span><span class="p">(</span><span class="n">n_per_plot</span><span class="o">*</span><span class="n">int_division</span><span class="p">)</span>
    <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">int_division</span><span class="p">):</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">i</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">])</span>
    <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="n">remainder</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotBoxplot.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotBoxplot.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotBoxplot.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotBoxplot.truncate_data">
    <p>def <span class="ident">truncate_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotBoxplot.truncate_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotBoxplot.truncate_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotHeatMap" class="name">class <span class="ident">PlotHeatMap</span></p>
      
  
    <div class="desc"><p>Plot Pearsons correlation as heat map. Still under development.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHeatMap', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHeatMap" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotHeatMap</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot Pearsons correlation as heat map. Still under development. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
                 <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
                 <span class="c1">#truncate data options</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="c1">#graph options</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="c1">#boxplot specific options</span>
                 <span class="s1">&#39;sym&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;grid&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span>
                             <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">),</span>
                             <span class="n">FromPickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">),</span>
                             <span class="n">Log10</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">))</span>
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">cwd</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;HeatMaps&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        



        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">divide_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_vars</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">n_per_plot</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span>
<span class="c1">#        assert n_per_plot&lt;n_vars,&#39;number of variables per plot must be smaller than the number of variables&#39;</span>
        <span class="n">int_division</span><span class="o">=</span> <span class="n">n_vars</span><span class="o">//</span><span class="n">n_per_plot</span>
        <span class="n">remainder</span><span class="o">=</span><span class="n">n_vars</span><span class="o">-</span><span class="p">(</span><span class="n">n_per_plot</span><span class="o">*</span><span class="n">int_division</span><span class="p">)</span>
        <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">int_division</span><span class="p">):</span>
            <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">i</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">])</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="n">remainder</span><span class="p">:])</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>



    <span class="k">def</span> <span class="nf">get_variance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> 
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotHeatMap">PlotHeatMap</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.copasi_file" class="name">var <span class="ident">copasi_file</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.cwd" class="name">var <span class="ident">cwd</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.log_data" class="name">var <span class="ident">log_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.results_dir" class="name">var <span class="ident">results_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHeatMap.truncated_data" class="name">var <span class="ident">truncated_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHeatMap.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, copasi_file, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHeatMap.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHeatMap.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#parse data options</span>
             <span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="s1">&#39;parse_mode&#39;</span><span class="p">:</span><span class="s1">&#39;folder&#39;</span><span class="p">,</span>
             <span class="c1">#truncate data options</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="c1">#graph options</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">90</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="c1">#boxplot specific options</span>
             <span class="s1">&#39;sym&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             <span class="s1">&#39;grid&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    <span class="c1">#Other classes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">,</span>
                         <span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parse_mode&#39;</span><span class="p">),</span>
                         <span class="n">FromPickle</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">),</span>
                         <span class="n">Log10</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">))</span>
    <span class="c1">#create a directory and change to it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">cwd</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span><span class="s1">&#39;HeatMaps&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    
    <span class="c1">#attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">boxplot</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHeatMap.divide_data">
    <p>def <span class="ident">divide_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHeatMap.divide_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHeatMap.divide_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">divide_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">n_vars</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">n_per_plot</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;NumPerPlot&#39;</span><span class="p">)</span>
     <span class="k">assert</span> <span class="n">n_per_plot</span><span class="o">&lt;</span><span class="n">n_vars</span><span class="p">,</span><span class="s1">&#39;number of variables per plot must be smaller than the number of variables&#39;</span>
    <span class="n">int_division</span><span class="o">=</span> <span class="n">n_vars</span><span class="o">//</span><span class="n">n_per_plot</span>
    <span class="n">remainder</span><span class="o">=</span><span class="n">n_vars</span><span class="o">-</span><span class="p">(</span><span class="n">n_per_plot</span><span class="o">*</span><span class="n">int_division</span><span class="p">)</span>
    <span class="n">l</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">int_division</span><span class="p">):</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">i</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">n_per_plot</span><span class="p">])</span>
    <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="o">-</span><span class="n">remainder</span><span class="p">:])</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHeatMap.get_variance">
    <p>def <span class="ident">get_variance</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHeatMap.get_variance', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHeatMap.get_variance" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_variance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> 
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHeatMap.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHeatMap.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHeatMap.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHeatMap.truncate_data">
    <p>def <span class="ident">truncate_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHeatMap.truncate_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHeatMap.truncate_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotHexMap" class="name">class <span class="ident">PlotHexMap</span></p>
      
  
    <div class="desc"><p>Plot all possible combinations of scatter graph</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotHexMap</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot all possible combinations of scatter graph</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;GridSize&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                 <span class="s1">&#39;ColorMap&#39;</span><span class="p">:</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Mode&#39;</span><span class="p">:</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Marginals&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">],[</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">]))</span>        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not argument for Marginals&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]))</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        <span class="c1">#create a directory and change to it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;RSS&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;HexPlotsByRSS&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;HexPlotsByCounts&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            

        
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_hex_maps</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">plot1_hex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">x_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;x_specie is not in your PE data set&#39;</span>
        <span class="k">assert</span> <span class="n">y_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;y_specie is not in your PE data set&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>   
        
        
        <span class="n">x_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">x_specie</span><span class="p">]</span>
        <span class="n">y_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">y_specie</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;RSS&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">],</span><span class="n">gridsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">])</span>
            <span class="n">cb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="n">gridsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">])</span>
            <span class="n">cb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>        

        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="c1">#        </span>
        <span class="c1">#labels</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;n={},Log10={},Bins={},GridSize={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">]),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">y_specie</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">#            </span>
            
    <span class="k">def</span> <span class="nf">binomial_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
        <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">get_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">comb</span><span class="o">=</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#        comb=[i for i in comb]</span>
        <span class="k">return</span> <span class="n">comb</span>
        
    <span class="k">def</span> <span class="nf">plot_hex_maps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">comb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_combinations</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1_hex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotHexMap">PlotHexMap</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.log_data" class="name">var <span class="ident">log_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.testing_variable" class="name">var <span class="ident">testing_variable</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHexMap.truncated_data" class="name">var <span class="ident">truncated_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;GridSize&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
             <span class="s1">&#39;ColorMap&#39;</span><span class="p">:</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Mode&#39;</span><span class="p">:</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Marginals&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">],[</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span><span class="s1">&#39;RSS&#39;</span><span class="p">]))</span>        
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="s1">&#39;false&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not argument for Marginals&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]))</span>
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Marginals&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    
    <span class="c1">#create a directory and change to it</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;RSS&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;HexPlotsByRSS&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;HexPlotsByCounts&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
    
    
    <span class="c1">#attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_hex_maps</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.binomial_coefficient">
    <p>def <span class="ident">binomial_coefficient</span>(</p><p>self, n, k)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.binomial_coefficient', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.binomial_coefficient" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">binomial_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
    <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.get_combinations">
    <p>def <span class="ident">get_combinations</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.get_combinations', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.get_combinations" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">comb</span><span class="o">=</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
     <span class="n">comb</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">comb</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.plot1_hex">
    <p>def <span class="ident">plot1_hex</span>(</p><p>self, x_specie, y_specie, data)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.plot1_hex', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.plot1_hex" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1_hex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;x_specie is not in your PE data set&#39;</span>
    <span class="k">assert</span> <span class="n">y_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;y_specie is not in your PE data set&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>   
    
    
    <span class="n">x_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">x_specie</span><span class="p">]</span>
    <span class="n">y_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">y_specie</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Mode&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;RSS&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">],</span><span class="n">gridsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">])</span>
        <span class="n">cb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;RSS&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;inferno&#39;</span><span class="p">,</span><span class="n">gridsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">])</span>
        <span class="n">cb</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Counts&#39;</span><span class="p">)</span>        
    <span class="c1">#pretty stuff</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
     
    <span class="c1">#labels</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;n={},Log10={},Bins={},GridSize={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;Bins&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;GridSize&#39;</span><span class="p">]),</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">y_specie</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    
    
    <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
     <span class="n">SaveFig</span> <span class="n">options</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.plot_hex_maps">
    <p>def <span class="ident">plot_hex_maps</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.plot_hex_maps', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.plot_hex_maps" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_hex_maps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">comb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_combinations</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1_hex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHexMap.truncate_data">
    <p>def <span class="ident">truncate_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHexMap.truncate_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHexMap.truncate_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotHistogram" class="name">class <span class="ident">PlotHistogram</span></p>
      
  
    <div class="desc"><p>Plot parameter estimation results as histogram
Args:
    results_path:
        Path to file or folder of files containing parameter estimation data
        to plot
<strong>kwargs:
     TruncateMode:
         'below_x', #either 'below_x' or 'percent' for method of truncation. 
     Log10:
         'false',
     X:
         100,           #if below_x: this is the X boundary. If percent: this is the percent of data to keep
</strong>kwargs which correspond to matplotlib.pyplot.hist keyword arguments. 
More information about these can be found in the matplotlib documentation 
     Bins:
         Number of bins to use. Default=100,
     AxisSize:
         Font size for the axis. Default=15
     FontSize:
         Font size for the graph labels. Default=22
     Normed:
         'true' or 'false. Whether to make the plot integrate to 1. 
         Default='false'
     Color:
         Plot colour. Default='red',   <br />
     XRotation:
         25,   #rotation for X tick axis
     TitleWrapSize:
         Number of characters to use before word wrapping the title. Default=35<br />
     Orientation:
         'horizontal' or 'vertical', default='vertical'
     SaveFig:
         'true' or 'false'. Save to a folder called histograms in results directory. 
         Default='false'
     DPI:
         Resolution to use when SaveFig='true'. The larger this value the 
         higher the resolution. Default=125. 
     ExtraTitle:
         When SaveFig='true', save with ExtraTitle appended to the filepath. 
         Default=None
     Show:
         'true' or 'false'. When not using iPython and graphs are not automatically 
         displayed in shell, this determines whether the plots are opened in a
         window or not. Default='false'</p>
<div class="codehilite"><pre><span></span> ResultsDirectory:
     Name of the directory to store parameter estimation results. 
     Default= &#39;Histograms&#39;
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotHistogram</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot parameter estimation results as histogram</span>
<span class="sd">    Args:</span>
<span class="sd">        results_path:</span>
<span class="sd">            Path to file or folder of files containing parameter estimation data</span>
<span class="sd">            to plot</span>
<span class="sd">    **kwargs:</span>
<span class="sd">         TruncateMode:</span>
<span class="sd">             &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
<span class="sd">         Log10:</span>
<span class="sd">             &#39;false&#39;,</span>
<span class="sd">         X:</span>
<span class="sd">             100,           #if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
<span class="sd">    **kwargs which correspond to matplotlib.pyplot.hist keyword arguments. </span>
<span class="sd">    More information about these can be found in the matplotlib documentation </span>
<span class="sd">         Bins:</span>
<span class="sd">             Number of bins to use. Default=100,</span>
<span class="sd">         AxisSize:</span>
<span class="sd">             Font size for the axis. Default=15</span>
<span class="sd">         FontSize:</span>
<span class="sd">             Font size for the graph labels. Default=22</span>
<span class="sd">         Normed:</span>
<span class="sd">             &#39;true&#39; or &#39;false. Whether to make the plot integrate to 1. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         Color:</span>
<span class="sd">             Plot colour. Default=&#39;red&#39;,     </span>
<span class="sd">         XRotation:</span>
<span class="sd">             25,   #rotation for X tick axis</span>
<span class="sd">         TitleWrapSize:</span>
<span class="sd">             Number of characters to use before word wrapping the title. Default=35  </span>
<span class="sd">         Orientation:</span>
<span class="sd">             &#39;horizontal&#39; or &#39;vertical&#39;, default=&#39;vertical&#39;</span>
<span class="sd">         SaveFig:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. Save to a folder called histograms in results directory. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         DPI:</span>
<span class="sd">             Resolution to use when SaveFig=&#39;true&#39;. The larger this value the </span>
<span class="sd">             higher the resolution. Default=125. </span>
<span class="sd">         ExtraTitle:</span>
<span class="sd">             When SaveFig=&#39;true&#39;, save with ExtraTitle appended to the filepath. </span>
<span class="sd">             Default=None</span>
<span class="sd">         Show:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. When not using iPython and graphs are not automatically </span>
<span class="sd">             displayed in shell, this determines whether the plots are opened in a</span>
<span class="sd">             window or not. Default=&#39;false&#39;</span>
<span class="sd">        </span>
<span class="sd">         ResultsDirectory:</span>
<span class="sd">             Name of the directory to store parameter estimation results. </span>
<span class="sd">             Default= &#39;Histograms&#39;</span>
<span class="sd">                     </span>
<span class="sd">                 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#arguments</span>
<span class="c1">#        self.copasi_file=copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Normed&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Variable&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;ColourMap&#39;</span><span class="p">:</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span>
                 <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>

        <span class="c1">#create a directory and change to it</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Histograms&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="c1">#main method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span> <span class="c1">#only assigned to variable for testing purposes</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;1&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;2&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;RSS&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        variable: variable to plot. Default= &#39;RSS&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
        <span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not in your PE results: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
                 <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">),</span>
                 <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">),</span>
                 <span class="n">normed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Normed&#39;</span><span class="p">),</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Orientation&#39;</span><span class="p">))</span>
        
        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
<span class="c1">#        plt.title(&#39;\n&#39;.join(wrap(&#39;{},n={}&#39;.format(variable,self.data.shape[1])) ),35  )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{},n={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span>
                                 <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency in bin&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value(Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        <span class="c1">#SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">variable</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">variable</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotHistogram">PlotHistogram</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.log_data" class="name">var <span class="ident">log_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.testing_variable" class="name">var <span class="ident">testing_variable</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram.truncated_data" class="name">var <span class="ident">truncated_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1">#arguments</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Normed&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Variable&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;ColourMap&#39;</span><span class="p">:</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span>
             <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    <span class="c1">#Other </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="c1">#create a directory and change to it</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">)</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Histograms&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ResultsDirectory&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    
    <span class="c1">#attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
    <span class="c1">#main method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_all</span><span class="p">()</span> <span class="c1">#only assigned to variable for testing purposes</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram.plot1">
    <p>def <span class="ident">plot1</span>(</p><p>self, variable=&#39;RSS&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>variable: variable to plot. Default= 'RSS'</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram.plot1', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram.plot1" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;RSS&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    variable: variable to plot. Default= &#39;RSS&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
    <span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not in your PE results: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
             <span class="n">bins</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Bins&#39;</span><span class="p">),</span>
             <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">),</span>
             <span class="n">normed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Normed&#39;</span><span class="p">),</span>
             <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Orientation&#39;</span><span class="p">))</span>
    
    <span class="c1">#pretty stuff</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1">#labels</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{},n={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">),</span><span class="mi">35</span>  <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{},n={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span>
                             <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency in bin&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value(Log10)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Parameter Value&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    
    <span class="c1">#SaveFig options</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">variable</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">variable</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram.plot_all">
    <p>def <span class="ident">plot_all</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram.plot_all', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram.plot_all" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram.truncate_data">
    <p>def <span class="ident">truncate_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram.truncate_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram.truncate_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
         <span class="k">print</span> <span class="s1">&#39;1&#39;</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
         <span class="k">print</span> <span class="s1">&#39;2&#39;</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotHistogram3D" class="name">class <span class="ident">PlotHistogram3D</span></p>
      
  
    <div class="desc"><p>Not functional </p>
<p>Plot parameter estimation results as histogram
Args:
    results_path:
        Path to file or folder of files containing parameter estimation data
        to plot
<strong>kwargs:
     TruncateMode:
         'below_x', #either 'below_x' or 'percent' for method of truncation. 
     Log10:
         'false',
     X:
         100,           #if below_x: this is the X boundary. If percent: this is the percent of data to keep
</strong>kwargs which correspond to matplotlib.pyplot.hist keyword arguments. 
More information about these can be found in the matplotlib documentation 
     Bins:
         Number of bins to use. Default=100,
     AxisSize:
         Font size for the axis. Default=15
     FontSize:
         Font size for the graph labels. Default=22
     Normed:
         'true' or 'false. Whether to make the plot integrate to 1. 
         Default='false'
     Color:
         Plot colour. Default='red',   <br />
     XRotation:
         25,   #rotation for X tick axis
     TitleWrapSize:
         Number of characters to use before word wrapping the title. Default=35<br />
     Orientation:
         'horizontal' or 'vertical', default='vertical'
     SaveFig:
         'true' or 'false'. Save to a folder called histograms in results directory. 
         Default='false'
     DPI:
         Resolution to use when SaveFig='true'. The larger this value the 
         higher the resolution. Default=125. 
     ExtraTitle:
         When SaveFig='true', save with ExtraTitle appended to the filepath. 
         Default=None
     Show:
         'true' or 'false'. When not using iPython and graphs are not automatically 
         displayed in shell, this determines whether the plots are opened in a
         window or not. Default='false'</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram3D', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram3D" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotHistogram3D</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Not functional </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    </span>
<span class="sd">    Plot parameter estimation results as histogram</span>
<span class="sd">    Args:</span>
<span class="sd">        results_path:</span>
<span class="sd">            Path to file or folder of files containing parameter estimation data</span>
<span class="sd">            to plot</span>
<span class="sd">    **kwargs:</span>
<span class="sd">         TruncateMode:</span>
<span class="sd">             &#39;below_x&#39;, #either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
<span class="sd">         Log10:</span>
<span class="sd">             &#39;false&#39;,</span>
<span class="sd">         X:</span>
<span class="sd">             100,           #if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
<span class="sd">    **kwargs which correspond to matplotlib.pyplot.hist keyword arguments. </span>
<span class="sd">    More information about these can be found in the matplotlib documentation </span>
<span class="sd">         Bins:</span>
<span class="sd">             Number of bins to use. Default=100,</span>
<span class="sd">         AxisSize:</span>
<span class="sd">             Font size for the axis. Default=15</span>
<span class="sd">         FontSize:</span>
<span class="sd">             Font size for the graph labels. Default=22</span>
<span class="sd">         Normed:</span>
<span class="sd">             &#39;true&#39; or &#39;false. Whether to make the plot integrate to 1. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         Color:</span>
<span class="sd">             Plot colour. Default=&#39;red&#39;,     </span>
<span class="sd">         XRotation:</span>
<span class="sd">             25,   #rotation for X tick axis</span>
<span class="sd">         TitleWrapSize:</span>
<span class="sd">             Number of characters to use before word wrapping the title. Default=35  </span>
<span class="sd">         Orientation:</span>
<span class="sd">             &#39;horizontal&#39; or &#39;vertical&#39;, default=&#39;vertical&#39;</span>
<span class="sd">         SaveFig:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. Save to a folder called histograms in results directory. </span>
<span class="sd">             Default=&#39;false&#39;</span>
<span class="sd">         DPI:</span>
<span class="sd">             Resolution to use when SaveFig=&#39;true&#39;. The larger this value the </span>
<span class="sd">             higher the resolution. Default=125. </span>
<span class="sd">         ExtraTitle:</span>
<span class="sd">             When SaveFig=&#39;true&#39;, save with ExtraTitle appended to the filepath. </span>
<span class="sd">             Default=None</span>
<span class="sd">         Show:</span>
<span class="sd">             &#39;true&#39; or &#39;false&#39;. When not using iPython and graphs are not automatically </span>
<span class="sd">             displayed in shell, this determines whether the plots are opened in a</span>
<span class="sd">             window or not. Default=&#39;false&#39;</span>
<span class="sd">                     </span>
<span class="sd">                 </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#arguments</span>
<span class="c1">#        self.copasi_file=copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Normed&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Variable&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>

        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Histograms&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="c1">#main method</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">()</span>
<span class="c1">#        self.testing_variable=self.plot_all() #only assigned to variable for testing purposes</span>
<span class="c1">#        os.chdir(os.path.dirname(self.results_dir))</span>
            
    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;1&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
<span class="c1">#            print &#39;2&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;RSS&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        variable: variable to plot. Default= &#39;RSS&#39;</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
        <span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not in your PE results: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
        <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">Axes3D</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotHistogram3D">PlotHistogram3D</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.log_data" class="name">var <span class="ident">log_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.results_dir" class="name">var <span class="ident">results_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotHistogram3D.truncated_data" class="name">var <span class="ident">truncated_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram3D.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram3D.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram3D.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1">#arguments</span>
     <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="s1">&#39;Bins&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Normed&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;Orientation&#39;</span><span class="p">:</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Variable&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    <span class="c1">#Other classes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    <span class="c1">#create a directory and change to it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Histograms&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    
    <span class="c1">#attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
    <span class="c1">#main method</span>
    <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_parameters</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram3D.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram3D.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram3D.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram3D.plot1">
    <p>def <span class="ident">plot1</span>(</p><p>self, variable=&#39;RSS&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>variable: variable to plot. Default= 'RSS'</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram3D.plot1', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram3D.plot1" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="s1">&#39;RSS&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    variable: variable to plot. Default= &#39;RSS&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">})</span>
    <span class="k">assert</span> <span class="n">variable</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not in your PE results: {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">variable</span><span class="p">]</span>
    <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">Axes3D</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotHistogram3D.truncate_data">
    <p>def <span class="ident">truncate_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotHistogram3D.truncate_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotHistogram3D.truncate_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
         <span class="k">print</span> <span class="s1">&#39;1&#39;</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
         <span class="k">print</span> <span class="s1">&#39;2&#39;</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotPEData" class="name">class <span class="ident">PlotPEData</span></p>
      
  
    <div class="desc"><p>Plot a parameter estimation run against experimental data. 
Suport currently only exists for time course experiments. In future versions
a SteadyState Task will be introduced and then we can build a plotting feature
for fitting steady state experiments</p>
<p>Positional Arguments:</p>
<div class="codehilite"><pre><span></span><span class="n">copasi_file</span><span class="o">:</span>
    <span class="n">The</span> <span class="n">copasi</span> <span class="n">file</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">enter</span> <span class="n">parameters</span> <span class="n">into</span>

<span class="n">experiment_files</span>

<span class="n">PE_result_files</span>
</pre></div>


<p>**Kwargs
    Index:
        Index of parameter estimation run to input into the copasi file. 
        The index is ordered by rank of best fit, with 0 being the best.
        Default=0            </p>
<div class="codehilite"><pre><span></span><span class="n">PruneHeaders</span><span class="o">:</span>
    <span class="n">Prune</span> <span class="n">copasi</span> <span class="n">variable</span> <span class="n">names</span> <span class="n">of</span> <span class="n">Copasi</span> <span class="n">references</span><span class="o">.</span> <span class="s1">&#39;true&#39;</span> <span class="n">or</span> <span class="s1">&#39;false&#39;</span>

<span class="n">QuantityType</span><span class="o">:</span>
    <span class="n">Either</span> <span class="s1">&#39;particle_number&#39;</span> <span class="n">or</span> <span class="s1">&#39;concentration&#39;</span><span class="o">.</span> <span class="n">Default</span><span class="o">=</span><span class="s1">&#39;concentration&#39;</span>

<span class="n">OutputML</span><span class="o">:</span>
    <span class="n">If</span> <span class="n">Save</span> <span class="kd">set</span> <span class="n">to</span> <span class="s1">&#39;duplicate&#39;</span><span class="o">,</span> <span class="k">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">duplicate</span> <span class="n">filename</span><span class="o">.</span>

<span class="n">Save</span><span class="o">:</span>
    <span class="n">either</span> <span class="s1">&#39;false&#39;</span><span class="o">,</span><span class="s1">&#39;overwrite&#39;</span> <span class="n">or</span> <span class="s1">&#39;duplicate&#39;</span>

<span class="n">ParameterDict</span><span class="o">:</span>
    <span class="n">A</span> <span class="n">python</span> <span class="n">dictionary</span> <span class="k">with</span> <span class="n">keys</span> <span class="n">correponding</span> <span class="n">to</span> <span class="n">parameters</span> <span class="k">in</span> <span class="n">the</span> <span class="n">model</span>
    <span class="n">and</span> <span class="n">values</span> <span class="n">the</span> <span class="n">parameters</span> <span class="o">(</span><span class="n">dict</span><span class="o">[</span><span class="n">parameter_name</span><span class="o">]=</span><span class="n">parameter</span> <span class="n">value</span><span class="o">).</span> 
    <span class="n">Default</span><span class="o">=</span><span class="n">None</span>

<span class="n">DF</span><span class="o">:</span>
    <span class="n">A</span> <span class="n">pandas</span> <span class="n">dataframe</span> <span class="k">with</span> <span class="n">parameters</span> <span class="n">being</span> <span class="n">column</span> <span class="n">names</span> <span class="n">matching</span> 
    <span class="n">parameters</span> <span class="k">in</span> <span class="n">your</span> <span class="n">model</span> <span class="n">and</span> <span class="n">RSS</span> <span class="n">values</span> <span class="n">and</span> <span class="n">rows</span> <span class="n">being</span> <span class="n">individual</span> 
    <span class="n">parameter</span> <span class="n">estimationruns</span><span class="o">.</span> <span class="n">In</span> <span class="k">this</span> <span class="k">case</span><span class="o">,</span> <span class="n">ensure</span> <span class="n">you</span> <span class="n">have</span> <span class="kd">set</span> <span class="n">the</span> 
    <span class="n">Index</span> <span class="n">parameter</span> <span class="n">to</span> <span class="n">the</span> <span class="n">index</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span><span class="o">.</span> <span class="n">Dataframes</span> <span class="n">are</span> 
    <span class="n">automatically</span> <span class="n">sorted</span> <span class="n">by</span> <span class="n">the</span> <span class="n">RSS</span> <span class="n">column</span><span class="o">.</span>

<span class="n">ParameterPath</span><span class="o">:</span>
    <span class="n">Full</span> <span class="n">path</span> <span class="n">to</span> <span class="n">a</span> <span class="n">parameter</span> <span class="n">estimation</span> <span class="n">file</span> <span class="o">(</span><span class="s1">&#39;.txt&#39;</span><span class="o">,</span><span class="s1">&#39;.xls&#39;</span><span class="o">,</span><span class="s1">&#39;.xlsx&#39;</span> <span class="n">or</span> 
    <span class="s1">&#39;.csv&#39;</span><span class="o">)</span> <span class="n">or</span> <span class="n">a</span> <span class="n">folder</span> <span class="n">containing</span> <span class="n">parameter</span> <span class="n">estimation</span> <span class="n">files</span><span class="o">.</span>

<span class="n">OutputDirectory</span><span class="o">:</span>
    <span class="n">Name</span> <span class="n">of</span> <span class="n">an</span> <span class="n">output</span> <span class="n">directory</span><span class="o">.</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotPEData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot a parameter estimation run against experimental data. </span>
<span class="sd">    Suport currently only exists for time course experiments. In future versions</span>
<span class="sd">    a SteadyState Task will be introduced and then we can build a plotting feature</span>
<span class="sd">    for fitting steady state experiments</span>
<span class="sd">    </span>
<span class="sd">    Positional Arguments:</span>
<span class="sd">    </span>
<span class="sd">        copasi_file:</span>
<span class="sd">            The copasi file you want to enter parameters into</span>
<span class="sd">            </span>
<span class="sd">        experiment_files</span>
<span class="sd">        </span>
<span class="sd">        PE_result_files</span>
<span class="sd">    </span>
<span class="sd">    **Kwargs</span>
<span class="sd">        Index:</span>
<span class="sd">            Index of parameter estimation run to input into the copasi file. </span>
<span class="sd">            The index is ordered by rank of best fit, with 0 being the best.</span>
<span class="sd">            Default=0            </span>
<span class="sd">            </span>
<span class="sd">        PruneHeaders:</span>
<span class="sd">            Prune copasi variable names of Copasi references. &#39;true&#39; or &#39;false&#39;</span>
<span class="sd">            </span>
<span class="sd">        QuantityType:</span>
<span class="sd">            Either &#39;particle_number&#39; or &#39;concentration&#39;. Default=&#39;concentration&#39;</span>
<span class="sd">            </span>
<span class="sd">        OutputML:</span>
<span class="sd">            If Save set to &#39;duplicate&#39;, this is the duplicate filename. </span>
<span class="sd">            </span>
<span class="sd">        Save:</span>
<span class="sd">            either &#39;false&#39;,&#39;overwrite&#39; or &#39;duplicate&#39;</span>
<span class="sd">            </span>
<span class="sd">        ParameterDict:</span>
<span class="sd">            A python dictionary with keys correponding to parameters in the model</span>
<span class="sd">            and values the parameters (dict[parameter_name]=parameter value). </span>
<span class="sd">            Default=None</span>
<span class="sd">            </span>
<span class="sd">        DF:</span>
<span class="sd">            A pandas dataframe with parameters being column names matching </span>
<span class="sd">            parameters in your model and RSS values and rows being individual </span>
<span class="sd">            parameter estimationruns. In this case, ensure you have set the </span>
<span class="sd">            Index parameter to the index you want to use. Dataframes are </span>
<span class="sd">            automatically sorted by the RSS column. </span>
<span class="sd">            </span>
<span class="sd">        ParameterPath:</span>
<span class="sd">            Full path to a parameter estimation file (&#39;.txt&#39;,&#39;.xls&#39;,&#39;.xlsx&#39; or </span>
<span class="sd">            &#39;.csv&#39;) or a folder containing parameter estimation files. </span>
<span class="sd">            </span>
<span class="sd">        OutputDirectory:</span>
<span class="sd">            Name of an output directory. </span>
<span class="sd">        </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">experiment_files</span><span class="p">,</span><span class="n">PE_result_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="o">=</span><span class="n">experiment_files</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="o">=</span><span class="n">PE_result_file</span>
        
        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>

        <span class="n">default_report_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span>
                                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_PE_results.txt&#39;</span><span class="p">)</span>
        <span class="n">default_outputML</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Duplicate.cps&#39;</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
                 <span class="s1">&#39;ReportName&#39;</span><span class="p">:</span><span class="n">default_report_name</span><span class="p">,</span>
                 <span class="s1">&#39;OutputML&#39;</span><span class="p">:</span><span class="n">default_outputML</span><span class="p">,</span>
                 <span class="s1">&#39;Save&#39;</span><span class="p">:</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                 <span class="s1">&#39;LineWidth&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;PruneHeaders&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
                 
                 <span class="c1">#graph features</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;MultiPlot&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
                 <span class="s1">&#39;Ylimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Xlimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;XTickRotation&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;DotSize&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
                 <span class="s1">&#39;LegendLoc&#39;</span><span class="p">:</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;OutputDirectory&#39;</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ParameterEstimationPlots&#39;</span><span class="p">),</span>
                 <span class="s1">&#39;Plot&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>                 
                 
                 <span class="p">}</span>
                 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for Plot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>       
        
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The Plot kwarg takes only </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1">#limit parameters</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Ylimit is a list of coordinates for y axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Ylimit list must be 2&#39;</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Xlimit is a list of coordinates for X axis,i.e. [0,10]&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Xlimit list must be 2&#39;</span>
        
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">),</span><span class="s1">&#39;XTickRotation parameter should be a Python integer&#39;</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
            
            
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>                
                     
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PruneHeaders&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>                
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for PlotPEData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your copasi file {}doesn</span><span class="se">\&#39;</span><span class="s1"> exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your experiment file {} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">))</span>
            <span class="c1">#make a 1 element list to iterate over later</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">]</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your PE data file {} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">))</span>
        
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_experimental_files</span><span class="p">()</span>
<span class="c1">#        print self.experiment_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_times</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">insert_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">simulate_time_course</span><span class="p">()</span>
<span class="c1">##        &#39;&#39;&#39;</span>
<span class="c1">##        Only change directory before doing the actual plotting. </span>
<span class="c1">##        You want to be in the model directory for all the while your collecting</span>
<span class="c1">##        data then move on over to the results directory when plotting. </span>
<span class="c1">##        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">change_directory</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">change_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dire</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ParameterEstimationPlots&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dire</span>
        
        
    <span class="k">def</span> <span class="nf">parse_experimental_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">df_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="n">df</span><span class="o">=</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">df_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">df</span>
        <span class="k">return</span> <span class="n">df_dct</span>
        
    
    <span class="k">def</span> <span class="nf">get_experiment_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
                    <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">times</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;StepSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            subtract 1 from intervals to account for header</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Intervals&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">times</span>
        
    <span class="k">def</span> <span class="nf">parse_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PruneHeaders&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">)</span>
        <span class="n">df</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">data</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span>
        <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">insert_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span>
        
        
    <span class="k">def</span> <span class="nf">simulate_time_course</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data_dct</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">:</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            need to subtract 1 from the intervals</span>
<span class="sd">            &#39;&#39;&#39;</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">TimeCourse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">Start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">],</span>
                          <span class="n">End</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">],</span>
                          <span class="n">Intervals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Intervals&#39;</span><span class="p">],</span>
                          <span class="n">StepSize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;StepSize&#39;</span><span class="p">],</span><span class="n">Plot</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">)</span>
            <span class="n">P</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="n">TC</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
            <span class="n">data_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="o">.</span><span class="n">df</span>
        <span class="k">return</span> <span class="n">data_dct</span>


<span class="c1">#    def simulate_time_course(self):</span>
<span class="c1">#        data_dct={}</span>
<span class="c1">#        for i in self.exp_times:</span>
<span class="c1">#            &#39;&#39;&#39;</span>
<span class="c1">#            need to subtract 1 from the intervals</span>
<span class="c1">#            &#39;&#39;&#39;</span>
<span class="c1">#            TC=pycopi.TimeCourse(self.copasi_file,Start=self.exp_times[i][&#39;Start&#39;],</span>
<span class="c1">#                          End=self.exp_times[i][&#39;End&#39;],</span>
<span class="c1">#                          Intervals=self.exp_times[i][&#39;End&#39;],</span>
<span class="c1">#                          StepSize=1,Plot=&#39;false&#39;)</span>
<span class="c1">#            P=pycopi.PruneCopasiHeaders(TC.data,replace=&#39;true&#39;)</span>
<span class="c1">#            data_dct[i]=P.df</span>
<span class="c1">#        return data_dct</span>
        
        
                            
    <span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fle</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot one parameter of one experiment. for iterating over in </span>
<span class="sd">        other functions</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {} or {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="n">sim</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">exp</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
        <span class="n">time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">sim</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;simulated&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;experimental&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LegendLoc&#39;</span><span class="p">))</span>


   
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#xtick rotation</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">))</span>
        
        <span class="c1">#options for changing the plot axis</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">))</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantity Unit ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_quantity_units</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantity Unit (micromol)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
                        
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_time_unit</span><span class="p">()),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>  


        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="o">+</span><span class="s1">&#39;_-[]&#39;</span><span class="p">:</span>
                <span class="n">parameter</span><span class="o">=</span><span class="n">parameter</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
                
<span class="c1">#        parameter=re.sub(p,&#39;_&#39;,parameter) </span>
                                
                                
                                
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputDirectory&#39;</span><span class="p">),</span><span class="s1">&#39;{}_{}.jpeg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)))</span>                
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputDirectory&#39;</span><span class="p">),</span><span class="s1">&#39;{}.jpeg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">))</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>             
        
        
    <span class="k">def</span> <span class="nf">plot1file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fle</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        plot only parameters from a single experiment file</span>
<span class="sd">        (for the event that the user has multiple time course</span>
<span class="sd">        experiments)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">parameter</span> <span class="o">!=</span><span class="s1">&#39;Time&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Plot all parameters</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="n">dire</span><span class="p">,</span><span class="n">p</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1file</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotPEData">PlotPEData</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.CParser" class="name">var <span class="ident">CParser</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.GMQ" class="name">var <span class="ident">GMQ</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.PE_result_file" class="name">var <span class="ident">PE_result_file</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.copasiML" class="name">var <span class="ident">copasiML</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.copasi_file" class="name">var <span class="ident">copasi_file</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.exp_times" class="name">var <span class="ident">exp_times</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.experiment_data" class="name">var <span class="ident">experiment_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.experiment_files" class="name">var <span class="ident">experiment_files</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.parameters" class="name">var <span class="ident">parameters</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotPEData.sim_data" class="name">var <span class="ident">sim_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, copasi_file, experiment_files, PE_result_file, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">experiment_files</span><span class="p">,</span><span class="n">PE_result_file</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="o">=</span><span class="n">copasi_file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="o">=</span><span class="n">experiment_files</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="o">=</span><span class="n">PE_result_file</span>
    
    
    
    <span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">CopasiMLParser</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">copasiML</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CParser</span><span class="o">.</span><span class="n">copasiML</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">GetModelQuantities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span>
    <span class="n">default_report_name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span>
                                     <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_PE_results.txt&#39;</span><span class="p">)</span>
    <span class="n">default_outputML</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_Duplicate.cps&#39;</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="c1">#report variables</span>
             <span class="s1">&#39;ReportName&#39;</span><span class="p">:</span><span class="n">default_report_name</span><span class="p">,</span>
             <span class="s1">&#39;OutputML&#39;</span><span class="p">:</span><span class="n">default_outputML</span><span class="p">,</span>
             <span class="s1">&#39;Save&#39;</span><span class="p">:</span><span class="s1">&#39;overwrite&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Index&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
             <span class="s1">&#39;LineWidth&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
             <span class="s1">&#39;PruneHeaders&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>
             
             <span class="c1">#graph features</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;MultiPlot&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">30</span><span class="p">,</span>
             <span class="s1">&#39;Ylimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Xlimit&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;XTickRotation&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;DotSize&#39;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span>
             <span class="s1">&#39;LegendLoc&#39;</span><span class="p">:</span><span class="s1">&#39;best&#39;</span><span class="p">,</span>
             <span class="s1">&#39;OutputDirectory&#39;</span><span class="p">:</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ParameterEstimationPlots&#39;</span><span class="p">),</span>
             <span class="s1">&#39;Plot&#39;</span><span class="p">:</span><span class="s1">&#39;true&#39;</span><span class="p">,</span>                 
             
             <span class="p">}</span>
             
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for Plot&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>       
    
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;The Plot kwarg takes only </span><span class="se">\&#39;</span><span class="s1">false</span><span class="se">\&#39;</span><span class="s1"> or </span><span class="se">\&#39;</span><span class="s1">true</span><span class="se">\&#39;</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#limit parameters</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Ylimit is a list of coordinates for y axis,i.e. [0,10]&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Ylimit list must be 2&#39;</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">list</span><span class="p">),</span><span class="s1">&#39;Xlimit is a list of coordinates for X axis,i.e. [0,10]&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">))</span><span class="o">==</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;length of the Xlimit list must be 2&#39;</span>
    
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">),</span><span class="s1">&#39;XTickRotation parameter should be a Python integer&#39;</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Xlimit&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">)</span>
        
        
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">),</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MultiPlot&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>                
                 
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PruneHeaders&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="s1">&#39;true&#39;</span><span class="p">]</span>                
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for PlotPEData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span> 
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your copasi file {}doesn</span><span class="se">\&#39;</span><span class="s1"> exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your experiment file {} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">))</span>
        <span class="c1">#make a 1 element list to iterate over later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;Your PE data file {} doesn</span><span class="se">\&#39;</span><span class="s1">t exist&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">))</span>
    
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_experimental_files</span><span class="p">()</span>
     <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_experiment_times</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parse_parameters</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">insert_parameters</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">simulate_time_course</span><span class="p">()</span>
      <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Only change directory before doing the actual plotting. </span>
<span class="sd">      You want to be in the model directory for all the while your collecting</span>
<span class="sd">      data then move on over to the results directory when plotting. </span>
<span class="sd">      &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Plot&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_directory</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.change_directory">
    <p>def <span class="ident">change_directory</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.change_directory', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.change_directory" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">change_directory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">dire</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">),</span><span class="s1">&#39;ParameterEstimationPlots&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">dire</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dire</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.get_experiment_times">
    <p>def <span class="ident">get_experiment_times</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.get_experiment_times', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.get_experiment_times" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_experiment_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">d</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;time&#39;</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
    <span class="n">times</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>
        <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;StepSize&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        subtract 1 from intervals to account for header</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Intervals&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">times</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.insert_parameters">
    <p>def <span class="ident">insert_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.insert_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.insert_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">insert_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">pycopi</span><span class="o">.</span><span class="n">InsertParameters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">DF</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span><span class="n">Save</span><span class="o">=</span><span class="s1">&#39;overwrite&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.parse_experimental_files">
    <p>def <span class="ident">parse_experimental_files</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.parse_experimental_files', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.parse_experimental_files" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_experimental_files</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">df_dct</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
        <span class="n">df</span><span class="o">=</span><span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">df_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">df</span>
    <span class="k">return</span> <span class="n">df_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.parse_parameters">
    <p>def <span class="ident">parse_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.parse_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.parse_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PruneHeaders&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span><span class="p">)</span>
    <span class="n">df</span><span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">data</span>
    <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_result_file</span>
    <span class="k">return</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.plot">
    <p>def <span class="ident">plot</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Plot all parameters</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.plot', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.plot" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot all parameters</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
        <span class="n">dire</span><span class="p">,</span><span class="n">p</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">p</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1file</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.plot1">
    <p>def <span class="ident">plot1</span>(</p><p>self, fle, parameter)</p>
    </div>
    

    
  
    <div class="desc"><p>Plot one parameter of one experiment. for iterating over in 
other functions</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.plot1', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.plot1" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fle</span><span class="p">,</span><span class="n">parameter</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot one parameter of one experiment. for iterating over in </span>
<span class="sd">    other functions</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">fle</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_files</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} not in {} or {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="o">.</span><span class="n">keys</span><span class="p">()],</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">sim</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
    <span class="n">exp</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="n">parameter</span><span class="p">]</span>
    <span class="n">time</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sim_data</span><span class="p">[</span><span class="n">fle</span><span class="p">][</span><span class="s1">&#39;Time&#39;</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">sim</span><span class="p">,</span><span class="s1">&#39;k-&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;simulated&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LineWidth&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">exp</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;experimental&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DotSize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LegendLoc&#39;</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1">#xtick rotation</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XTickRotation&#39;</span><span class="p">))</span>
    
    <span class="c1">#options for changing the plot axis</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Ylimit&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;xlimit&#39;</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantity Unit ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_quantity_units</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Quantity Unit (micromol)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
                    
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GMQ</span><span class="o">.</span><span class="n">get_time_unit</span><span class="p">()),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>  
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">parameter</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span><span class="o">+</span><span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="o">+</span><span class="s1">&#39;_-[]&#39;</span><span class="p">:</span>
            <span class="n">parameter</span><span class="o">=</span><span class="n">parameter</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            
     <span class="n">parameter</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span> 
                            
                            
                            
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
            <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputDirectory&#39;</span><span class="p">),</span><span class="s1">&#39;{}_{}.jpeg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)))</span>                
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fle</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;OutputDirectory&#39;</span><span class="p">),</span><span class="s1">&#39;{}.jpeg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">parameter</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">),</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>             
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.plot1file">
    <p>def <span class="ident">plot1file</span>(</p><p>self, fle)</p>
    </div>
    

    
  
    <div class="desc"><p>plot only parameters from a single experiment file
(for the event that the user has multiple time course
experiments)</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.plot1file', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.plot1file" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fle</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    plot only parameters from a single experiment file</span>
<span class="sd">    (for the event that the user has multiple time course</span>
<span class="sd">    experiments)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">experiment_data</span><span class="p">[</span><span class="n">fle</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="o">!=</span><span class="s1">&#39;Time&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1</span><span class="p">(</span><span class="n">fle</span><span class="p">,</span><span class="n">parameter</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotPEData.simulate_time_course">
    <p>def <span class="ident">simulate_time_course</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotPEData.simulate_time_course', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotPEData.simulate_time_course" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">simulate_time_course</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">data_dct</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        need to subtract 1 from the intervals</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">TimeCourse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">copasi_file</span><span class="p">,</span><span class="n">Start</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">],</span>
                      <span class="n">End</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">],</span>
                      <span class="n">Intervals</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Intervals&#39;</span><span class="p">],</span>
                      <span class="n">StepSize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exp_times</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;StepSize&#39;</span><span class="p">],</span><span class="n">Plot</span><span class="o">=</span><span class="s1">&#39;false&#39;</span><span class="p">)</span>
        <span class="n">P</span><span class="o">=</span><span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="n">TC</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="s1">&#39;true&#39;</span><span class="p">)</span>
        <span class="n">data_dct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="o">.</span><span class="n">df</span>
    <span class="k">return</span> <span class="n">data_dct</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.PlotScatters" class="name">class <span class="ident">PlotScatters</span></p>
      
  
    <div class="desc"><p>Plot all possible combinations of scatter graph</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">PlotScatters</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Plot all possible combinations of scatter graph</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="c1">#keywrod arguments</span>
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
                 <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                 <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
                 <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
                 <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
                 <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
                 <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="c1">#Other classes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        <span class="c1">#create a directory and change to it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Scatters&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        
        
        <span class="c1">#attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_scatters</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">plot1_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">x_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;x_specie is not in your PE data set&#39;</span>
        <span class="k">assert</span> <span class="n">y_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;y_specie is not in your PE data set&#39;</span>
        <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>   
        <span class="n">x_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">x_specie</span><span class="p">]</span>
        <span class="n">y_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">y_specie</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

        <span class="c1">#pretty stuff</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c1">#labels</span>
<span class="c1">#        plt.title(&#39;\n&#39;.join(wrap(&#39;{},n={}&#39;.format(variable,self.data.shape[1])) ),35  )</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;n={},Log10={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)),</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">y_specie</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
        
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">#        SaveFig options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1">#            </span>
            
    <span class="k">def</span> <span class="nf">binomial_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
        <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
        
        
    <span class="k">def</span> <span class="nf">get_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">comb</span><span class="o">=</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">#        comb=[i for i in comb]</span>
        <span class="k">return</span> <span class="n">comb</span>
        
    <span class="k">def</span> <span class="nf">plot_scatters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">comb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_combinations</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot1_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.PlotScatters">PlotScatters</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.log_data" class="name">var <span class="ident">log_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.results_dir" class="name">var <span class="ident">results_dir</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.testing_variable" class="name">var <span class="ident">testing_variable</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.PlotScatters.truncated_data" class="name">var <span class="ident">truncated_data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="c1">#keywrod arguments</span>
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FromPickle&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;TruncateMode&#39;</span><span class="p">:</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span> <span class="c1">#either &#39;below_x&#39; or &#39;percent&#39; for method of truncation. </span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;X&#39;</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span>           <span class="c1">#if below_x: this is the X boundary. If percent: this is the percent of data to keep</span>
             <span class="s1">&#39;AxisSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
             <span class="s1">&#39;FontSize&#39;</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span>
             <span class="s1">&#39;Color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;XRotation&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
             <span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">:</span><span class="mi">35</span><span class="p">,</span>
             <span class="s1">&#39;SaveFig&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;DPI&#39;</span><span class="p">:</span><span class="mi">125</span><span class="p">,</span>
             <span class="s1">&#39;ExtraTitle&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
             <span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Show&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    <span class="c1">#Other classes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    
    <span class="c1">#create a directory and change to it</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;Scatters&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span><span class="o">!=</span><span class="bp">True</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_dir</span><span class="p">)</span>
    
    
    <span class="c1">#attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">log_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate_data</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">testing_variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_scatters</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.binomial_coefficient">
    <p>def <span class="ident">binomial_coefficient</span>(</p><p>self, n, k)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.binomial_coefficient', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.binomial_coefficient" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">binomial_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
    <span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
    <span class="k">return</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.get_combinations">
    <p>def <span class="ident">get_combinations</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.get_combinations', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.get_combinations" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get_combinations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">comb</span><span class="o">=</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
     <span class="n">comb</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">comb</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.list_parameters">
    <p>def <span class="ident">list_parameters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.list_parameters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.list_parameters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">list_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.plot1_scatter">
    <p>def <span class="ident">plot1_scatter</span>(</p><p>self, x_specie, y_specie, data)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.plot1_scatter', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.plot1_scatter" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot1_scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">x_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;x_specie is not in your PE data set&#39;</span>
    <span class="k">assert</span> <span class="n">y_specie</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;y_specie is not in your PE data set&#39;</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;AxisSize&#39;</span><span class="p">)})</span>   
    <span class="n">x_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">x_specie</span><span class="p">]</span>
    <span class="n">y_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="n">y_specie</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span><span class="n">y_data</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="c1">#pretty stuff</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    
    <span class="c1">#labels</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;{},n={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">),</span><span class="mi">35</span>  <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="s1">&#39;n={},Log10={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)),</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wrap</span><span class="p">(</span><span class="n">y_specie</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TitleWrapSize&#39;</span><span class="p">))),</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;XRotation&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FontSize&#39;</span><span class="p">))</span>
    
    <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">x_specie</span><span class="o">=</span><span class="n">x_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">y_specie</span><span class="o">=</span><span class="n">y_specie</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
     <span class="n">SaveFig</span> <span class="n">options</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SaveFig&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">),</span><span class="nb">str</span><span class="p">),</span><span class="s1">&#39;extra title should be a string&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ExtraTitle&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;{}_vs_{}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x_specie</span><span class="p">,</span><span class="n">y_specie</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.jpeg&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;jpeg&#39;</span><span class="p">,</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DPI&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Show&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.plot_scatters">
    <p>def <span class="ident">plot_scatters</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.plot_scatters', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.plot_scatters" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">plot_scatters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">comb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_combinations</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">comb</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot1_scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">truncated_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">True</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.PlotScatters.truncate_data">
    <p>def <span class="ident">truncate_data</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.PlotScatters.truncate_data', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.PlotScatters.truncate_data" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;false&#39;</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">TC</span><span class="o">=</span><span class="n">TruncateData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">log_data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TruncateMode&#39;</span><span class="p">),</span><span class="n">X</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">TC</span><span class="o">.</span><span class="n">data</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.TruncateData" class="name">class <span class="ident">TruncateData</span></p>
      
  
    <div class="desc"><p>Parameter estimation data in systems biology usually have runs which fall
into a local minima. Usually a user wants to remove these runs from further 
analysis. TruncateData does this and provides two modes to do so. A useful 
indication of where to truncate the data is to look at the plot produced
by the EvaluateOptimizationPerformance class and the histograms/boxplots/
profile likelihoods for your specific optimization problem. </p>
<p>Args:
    data:
        The parameter estiamtion data for truncation. This is a pandas dataframe. </p>
<p>kwargs:
    TruncateMode:
        Two modes accepted. When set to 'percent' take Xth percentile of 
        data. when set to 'below_x', truncate data below the value X. Pay
        attention to whether you are in Log10 mode or not. </p>
<div class="codehilite"><pre><span></span><span class="n">X</span><span class="o">:</span>
    <span class="n">Either</span> <span class="n">Xth</span> <span class="n">percentive</span> <span class="n">or</span> <span class="n">value</span> <span class="n">to</span> <span class="n">truncate</span> <span class="n">data</span> <span class="n">below</span><span class="o">.</span>
</pre></div></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.TruncateData', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.TruncateData" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">TruncateData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Parameter estimation data in systems biology usually have runs which fall</span>
<span class="sd">    into a local minima. Usually a user wants to remove these runs from further </span>
<span class="sd">    analysis. TruncateData does this and provides two modes to do so. A useful </span>
<span class="sd">    indication of where to truncate the data is to look at the plot produced</span>
<span class="sd">    by the EvaluateOptimizationPerformance class and the histograms/boxplots/</span>
<span class="sd">    profile likelihoods for your specific optimization problem. </span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        data:</span>
<span class="sd">            The parameter estiamtion data for truncation. This is a pandas dataframe. </span>
<span class="sd">            </span>
<span class="sd">    kwargs:</span>
<span class="sd">        TruncateMode:</span>
<span class="sd">            Two modes accepted. When set to &#39;percent&#39; take Xth percentile of </span>
<span class="sd">            data. when set to &#39;below_x&#39;, truncate data below the value X. Pay</span>
<span class="sd">            attention to whether you are in Log10 mode or not. </span>
<span class="sd">            </span>
<span class="sd">        X:</span>
<span class="sd">            Either Xth percentive or value to truncate data below. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">=</span><span class="n">TruncateMode</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">=</span><span class="n">X</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">below_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;There are no data with RSS below {}. Choose a higher number&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">]</span>
        
            
    <span class="k">def</span> <span class="nf">top_x_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        get top X percent data. </span>
<span class="sd">        Defulat= 100 = all data</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">&gt;</span><span class="mi">100</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} should be between 0 and 100&#39;</span><span class="p">)</span>
        <span class="n">x_quantile</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">x_quantile</span><span class="p">]</span>
            
    <span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">==</span><span class="s1">&#39;below_x&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">below_x</span><span class="p">()</span><span class="c1">#self.data</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">==</span><span class="s1">&#39;percent&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_x_percent</span><span class="p">()</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.TruncateData">TruncateData</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.TruncateData.TruncateMode" class="name">var <span class="ident">TruncateMode</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.TruncateData.X" class="name">var <span class="ident">X</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.TruncateData.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.TruncateData.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, data, TruncateMode=&#39;percent&#39;, X=100)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.TruncateData.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.TruncateData.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">TruncateMode</span><span class="o">=</span><span class="s1">&#39;percent&#39;</span><span class="p">,</span><span class="n">X</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">=</span><span class="n">TruncateMode</span>        
    <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">=</span><span class="n">X</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;below_x&#39;</span><span class="p">,</span><span class="s1">&#39;percent&#39;</span><span class="p">]</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">truncate</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.TruncateData.below_x">
    <p>def <span class="ident">below_x</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.TruncateData.below_x', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.TruncateData.below_x" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">below_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;There are no data with RSS below {}. Choose a higher number&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;RSS&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.TruncateData.top_x_percent">
    <p>def <span class="ident">top_x_percent</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>get top X percent data. 
Defulat= 100 = all data</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.TruncateData.top_x_percent', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.TruncateData.top_x_percent" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">top_x_percent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    get top X percent data. </span>
<span class="sd">    Defulat= 100 = all data</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">&gt;</span><span class="mi">100</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">Errors</span><span class="o">.</span><span class="n">InputError</span><span class="p">(</span><span class="s1">&#39;{} should be between 0 and 100&#39;</span><span class="p">)</span>
    <span class="n">x_quantile</span><span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)))</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">x_quantile</span><span class="p">]</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.TruncateData.truncate">
    <p>def <span class="ident">truncate</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.TruncateData.truncate', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.TruncateData.truncate" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">==</span><span class="s1">&#39;below_x&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">below_x</span><span class="p">()</span><span class="c1">#self.data</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">TruncateMode</span><span class="o">==</span><span class="s1">&#39;percent&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_x_percent</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="PEAnalysis.WritePEData" class="name">class <span class="ident">WritePEData</span></p>
      
  
    <div class="desc"><p>Write the sorted parameter estimation data as a flat xlsx file
Args
    results_path:
        The path to the results file or folder of files with parameter
        estimation data in
**kwargs 
    Log10:</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.WritePEData', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.WritePEData" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">WritePEData</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Write the sorted parameter estimation data as a flat xlsx file</span>
<span class="sd">    Args</span>
<span class="sd">        results_path:</span>
<span class="sd">            The path to the results file or folder of files with parameter</span>
<span class="sd">            estimation data in</span>
<span class="sd">    **kwargs </span>
<span class="sd">        Log10:</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
        
        
        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
                 
                     <span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">Log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;PE_Data_log.xlsx&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;PE_Data.xlsx&#39;</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prune_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_to_xlsx</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">prune_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">df</span>
    
    <span class="k">def</span> <span class="nf">write_to_xlsx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#PEAnalysis.WritePEData">WritePEData</a></li>
          </ul>
          <h3>Instance variables</h3>
            <div class="item">
            <p id="PEAnalysis.WritePEData.PED" class="name">var <span class="ident">PED</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.WritePEData.data" class="name">var <span class="ident">data</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.WritePEData.kwargs" class="name">var <span class="ident">kwargs</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="PEAnalysis.WritePEData.results_path" class="name">var <span class="ident">results_path</span></p>
            

            
  
  <div class="source_cont">
</div>

            </div>
          <h3>Methods</h3>
            
  <div class="item">
    <div class="name def" id="PEAnalysis.WritePEData.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, results_path, **kwargs)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.WritePEData.__init__', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.WritePEData.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">results_path</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="o">=</span><span class="n">results_path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">=</span><span class="n">ParsePEData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">)</span>
    
    
    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Log10&#39;</span><span class="p">:</span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
             
                 <span class="p">}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">assert</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">options</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span><span class="s1">&#39;{} is not a keyword argument for TruncateData&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span> <span class="n">kwargs</span><span class="p">)</span>  
    <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">=</span><span class="n">options</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">Log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;PE_Data_log.xlsx&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PED</span><span class="o">.</span><span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results_path</span><span class="p">),</span><span class="s1">&#39;PE_Data.xlsx&#39;</span><span class="p">)</span>
        
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prune_headers</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">write_to_xlsx</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.WritePEData.prune_headers">
    <p>def <span class="ident">prune_headers</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.WritePEData.prune_headers', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.WritePEData.prune_headers" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">prune_headers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">pycopi</span><span class="o">.</span><span class="n">PruneCopasiHeaders</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">df</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="PEAnalysis.WritePEData.write_to_xlsx">
    <p>def <span class="ident">write_to_xlsx</span>(</p><p>self)</p>
    </div>
    

    
  
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-PEAnalysis.WritePEData.write_to_xlsx', this);">Show source &equiv;</a></p>
  <div id="source-PEAnalysis.WritePEData.write_to_xlsx" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">write_to_xlsx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Log10&#39;</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;true&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_file</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>